"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[78549],{31821:(e,n,l)=>{l.d(n,{A:()=>y});l(65043);var a=l(80899),i=l(24858),o=l(18403),t=l(83462),s=l(81e3),r=l(49633),d=l(4219),c=l(29347),u=l(35316),m=l(31673),p=l(75139),h=l(60778),g=l(94857),v=l(59699),x=l(70579);function y(e){var n,l,y,j,b,A;let{open:f,onClose:_,refetch:w,analysisData:k}=e;const{user:C}=(0,p.Z)(),{t:D}=(0,h.WD)(),{currentLang:P}=(0,h.jc)(),S="ar"===P.value,{enqueueSnackbar:M}=(0,g.dh)(),$=a.Ik().shape({file:a.gl(),name:a.Yj().required("File name is required"),note:a.Yj().nullable(),analysis:a.YO(),appointment:a.Yj().nullable()}),F={file:null,name:"",note:"",patient:null===k||void 0===k?void 0:k.patient,appointment:null===k||void 0===k?void 0:k.appointment,unit_service:null===C||void 0===C||null===(n=C.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(y=l[C.employee.selected_engagement])||void 0===y?void 0:y.unit_service._id,employee:null===C||void 0===C||null===(j=C.employee)||void 0===j||null===(b=j.employee_engagements)||void 0===b||null===(A=b[C.employee.selected_engagement])||void 0===A?void 0:A._id,analysis:[]},R=(0,i.mN)({mode:"all",resolver:(0,o.t)($),defaultValues:F}),{setValue:T,reset:W,handleSubmit:q,formState:{isSubmitting:Z}}=R;return(0,x.jsx)(t.A,{open:f,onClose:_,children:(0,x.jsxs)(v.Ay,{methods:R,onSubmit:q((async e=>{const n={...e,type:"analysis",description:e.note},l=new FormData;Object.keys(n).forEach((e=>{Array.isArray(n[e])?n[e].forEach((n=>{l.append(e,n)})):l.append(e,n[e])}));try{await m.Ay.post(m.vZ.medicalreports.all,l),M("uploaded sucessfully"),_(),W(),w()}catch(a){M(S&&`${a.arabic_message}`||`${a.message}`,{variant:"error"})}})),children:[(0,x.jsx)(d.A,{sx:{mb:2},children:D("upload medical analysis")}),(0,x.jsx)(u.A,{children:(0,x.jsxs)(s.A,{sx:{p:2},children:[(0,x.jsx)(v.o3,{name:"name",label:D("File name"),sx:{mb:2}}),(0,x.jsx)(v.Y4,{multiple:!0,fullWidth:!0,name:"file",sx:{mb:2},variant:"outlined",onDrop:e=>{T("file",e)}}),(0,x.jsx)(v.o3,{name:"note",label:D("More information")})]})}),(0,x.jsxs)(c.A,{children:[(0,x.jsx)(r.A,{onClick:_,variant:"outlined",color:"inherit",children:D("Cancel")}),(0,x.jsx)(r.A,{type:"submit",loading:Z,variant:"contained",children:D("Upload")})]})]})})}},78549:(e,n,l)=>{l.r(n),l.d(n,{default:()=>we});var a=l(29490),i=l(68719),o=l(75139),t=l(19853),s=l.n(t),r=l(65043),d=l(40360),c=l(81e3),u=l(29013),m=l(12110),p=l(71806),h=l(67784),g=l(49633),v=l(77739),x=l(77224),y=l(73460),j=l(17392),b=l(26240),A=l(90310),f=l(79650),_=l(51787),w=l(48407),k=l(67132),C=l(65381),D=l(59229),P=l(31673),S=l(91562),M=l(60778),$=l(59331),F=l(7625),R=l(16236),T=l(35151),W=l(51440),q=l(94857),Z=l(70074),B=l(67555),z=l(91720),Y=l(75950),I=l(45837),U=l(94814),L=l(68738),E=l(1273),O=l(39652),V=l(94496),X=l(26353),H=l(57442),G=l(34624),N=l(80899),J=l(24858),K=l(18403),Q=l(74600),ee=l(71861),ne=l(83462),le=l(84284),ae=l(4219),ie=l(29347),oe=l(35316),te=l(59699),se=l(70579);function re(e){let{refetch:n,appointment:l,onClose:a,...i}=e;const{enqueueSnackbar:t}=(0,q.dh)(),{user:s}=(0,o.Z)(),{t:d}=(0,M.WD)(),{currentLang:u}=(0,M.jc)(),m="ar"===u.value,{countriesData:p}=(0,F.oOq)({select:"name_english name_arabic"}),h=N.Ik().shape({first_name:N.Yj().required(d("required field")),family_name:N.Yj().required(d("required field")),identification_num:N.Yj().required(d("required field")),birth_date:N.gl().nullable(),marital_status:N.Yj().nullable(),nationality:N.Yj().nullable(),country:N.Yj().required(d("required field")),city:N.Yj().required(d("required field")),email:N.Yj().required(d("required field")),mobile_num1:N.Yj().required(d("required field")),mobile_num2:N.Yj(),gender:N.Yj().nullable()}),v=(0,r.useMemo)((()=>({first_name:"",family_name:"",identification_num:"",birth_date:null,marital_status:null,nationality:null,country:null,city:null,email:"",mobile_num1:"",mobile_num2:"",gender:null})),[]),x=(0,J.mN)({mode:"all",resolver:(0,K.t)(h),defaultValues:v}),{reset:y,setValue:j,watch:b,handleSubmit:A,formState:{errors:f}}=x;(0,r.useEffect)((()=>{Object.keys(f).length&&Object.keys(f).forEach(((e,n)=>{var l;return t(`${e}: ${(null===f||void 0===f||null===(l=f[e])||void 0===l?void 0:l.message)||"error"}`,{variant:"error"})}))}),[f,t]);const _=b(),{tableData:k}=(0,F.RmE)(_.country,{select:"name_english name_arabic"}),C=A((async e=>{try{e._id?await P.Ay.patch(P.vZ.appointments.book(l._id),{patient:e._id,lang:m}):await P.Ay.patch(P.vZ.appointments.patient.createPatientAndBookAppoint(l._id),{...e,lang:m}),S.A.emit("updated",{user:s,link:w.f.unitservice.appointments.root,msg:`booked an appointment <strong>[ ${l.code} ]</strong>`}),t(d("booked successfully!")),n(),a()}catch(i){t(m&&`${i.arabic_message}`||`${i.message}`,{variant:"error"}),console.error(i)}})),{existPatients:D}=(0,F.C_f)({email:_.email,identification_num:_.identification_num,mobile_num1:_.mobile_num1});const $=()=>{y(),a()};return(0,se.jsx)(se.Fragment,{children:(0,se.jsx)(ne.A,{maxWidth:"lg",onClose:$,sx:{width:"auto"},...i,children:(0,se.jsxs)(te.Ay,{methods:x,onSubmit:C,children:[(0,se.jsxs)(ae.A,{sx:{mb:1},children:[" ",d("book manually")," "]}),null===D||void 0===D?void 0:D.map(((e,n,l)=>(0,se.jsxs)(ee.A,{severity:"info",sx:{width:1,marginBottom:2},children:[d("We found a record with similar information for ")," ",(0,se.jsxs)("strong",{children:[e.first_name," ",e.family_name]}),". ",d("Is this you?"),(0,se.jsx)("br",{}),(0,se.jsx)("button",{type:"button",style:{textDecoration:"underline",cursor:"pointer",color:"blue",background:"none",border:"none",padding:0},onClick:()=>{var n;y({_id:(n=e)._id||null,first_name:n.first_name||"",family_name:n.family_name||"",identification_num:n.identification_num||"",birth_date:n.birth_date||"",marital_status:n.marital_status||"",country:n.country||null,city:n.city||null,nationality:n.nationality||null,email:n.email||"",mobile_num1:n.mobile_num1||"",mobile_num2:n.mobile_num2||"",gender:n.gender||""})},children:d("Click here to fill your data")})]},l))),(0,se.jsx)(oe.A,{sx:{overflow:"unset",width:"auto"},children:(0,se.jsx)(Q.A,{spacing:2.5,children:(0,se.jsxs)(c.A,{rowGap:3,columnGap:2,display:"grid",width:"auto",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,se.jsx)(te.o3,{name:"first_name",label:d("first name")}),(0,se.jsx)(te.o3,{name:"family_name",label:d("family name")}),(0,se.jsx)(te.o3,{name:"email",label:d("email")}),(0,se.jsx)(te.o3,{name:"identification_num",label:d("ID number")}),(0,se.jsx)(te.o3,{type:"number",name:"mobile_num1",label:d("mobile number")}),(0,se.jsx)(te.o3,{type:"number",name:"mobile_num2",label:d("alternative mobile number")}),(0,se.jsx)(J.xI,{name:"birth_date",render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,se.jsx)(le.l,{label:d("birth date"),onChange:e=>{j("birth_date",e)},slotProps:{textField:{fullWidth:!0}}})}}),(0,se.jsx)(te.tX,{name:"nationality",label:d("nationality"),children:p.map(((e,n,l)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:m?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},l)))}),(0,se.jsx)(te.tX,{name:"country",label:d("country"),children:p.map(((e,n,l)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:m?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},l)))}),(0,se.jsx)(te.tX,{name:"city",label:"City",PaperPropsSx:{textTransform:"capitalize"},children:k.map(((e,n,l)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:m?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},l)))}),(0,se.jsxs)(te.tX,{name:"marital_status",label:d("marital status"),children:[(0,se.jsx)(U.A,{lang:"ar",value:"single",children:d("single")}),(0,se.jsx)(U.A,{lang:"ar",value:"married",children:d("married")}),(0,se.jsx)(U.A,{lang:"ar",value:"widowed",children:d("widowed")}),(0,se.jsx)(U.A,{lang:"ar",value:"separated",children:d("separated")}),(0,se.jsxs)(U.A,{lang:"ar",value:"divorced",children:[d("divorced")," "]})]}),(0,se.jsxs)(te.tX,{name:"gender",label:d("gender"),children:[(0,se.jsx)(U.A,{lang:"ar",value:"male",children:d("male")}),(0,se.jsx)(U.A,{lang:"ar",value:"female",children:d("female")})]})]})})}),(0,se.jsxs)(ie.A,{children:[(0,se.jsx)(g.A,{color:"inherit",variant:"outlined",onClick:$,children:d("cancel")}),(0,se.jsx)(g.A,{type:"submit",variant:"contained",children:d("add")})]})]})})})}var de=l(31821);function ce(e){var n,l,a,o;let{row:t,selected:s,onSelectRow:d,refetch:u,onViewRow:m,onDelayRow:p,onCancelRow:v,onUnCancelRow:x,onBookAppoint:y}=e;const{_id:b,appoint_number:A,unit_service:f,work_group:C,medicalAnalysis:P,note:S,appointment_type:F,patient:W,unit_service_patient:q,start_time:B,status:z,invoiced:Y,created_at:N,user_creation:J,ip_address_user_creation:K,updated_at:Q,user_modification:ee,ip_address_user_modification:ne,modifications_nums:le}=t,ae=(0,k.rd)(),{t:ie}=(0,M.WD)(),oe=(0,i.v)(),{isMedLab:te}=(0,$.A)(),{currentLang:ce}=(0,M.jc)(),ue="ar"===ce.value,me=(0,G.f)(),pe=(0,G.f)(),he=(0,D.C)(),ge=(0,D.C)(),ve=(0,D.C)(),[xe,ye]=(0,r.useState)(0);let je;return W?je=ue?null===W||void 0===W?void 0:W.name_arabic:null===W||void 0===W?void 0:W.name_english:q&&(je=ue?null===q||void 0===q?void 0:q.name_arabic:null===q||void 0===q?void 0:q.name_english),(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(L.A,{hover:!0,selected:s,children:[(0,se.jsx)(O.A,{padding:"checkbox",children:(0,se.jsx)(E.A,{checked:s,onClick:d})}),(0,se.jsx)(O.A,{align:"center",children:(0,se.jsx)(X.A,{primary:(0,I.A)(new Date(B))&&new Date(B).toLocaleTimeString(ie("en-US"),{timeZone:(null===f||void 0===f||null===(n=f.country)||void 0===n?void 0:n.time_zone)||"Asia/Amman",hour:"2-digit",minute:"2-digit"}),secondary:(0,I.A)(new Date(B))&&new Date(B).toLocaleDateString(ie("en-US"),{timeZone:(null===f||void 0===f||null===(l=f.country)||void 0===l?void 0:l.time_zone)||"Asia/Amman"}),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,se.jsx)(O.A,{align:"center",children:A}),(0,se.jsx)(O.A,{align:"center",children:ue?null===F||void 0===F?void 0:F.name_arabic:null===F||void 0===F?void 0:F.name_english}),(0,se.jsx)(O.A,{align:"center",sx:{cursor:"pointer",color:"#3F54EB"},onClick:()=>{q&&ae.push(w.f.employee.patients.info(null===q||void 0===q?void 0:q._id))},children:je}),(0,se.jsx)(O.A,{align:"center",children:S}),te&&(0,se.jsx)(O.A,{align:"center",children:(0,se.jsx)(T.A,{icon:P?"eva:checkmark-fill":"mingcute:close-line",width:16})}),(0,se.jsx)(O.A,{align:"center",children:ue?null===C||void 0===C?void 0:C.name_arabic:null===C||void 0===C?void 0:C.name_english}),(0,se.jsx)(O.A,{align:"center",children:(0,se.jsx)(R.A,{variant:"soft",color:("processing"===z?"info":"arrived"===z&&"success")||"late"===z&&"warning"||"booked"===z&&"info"||"finished"===z&&"success"||"not arrived"===z&&"error"||"canceled"===z&&"warning"||"available"===z&&"secondary"||"not booked"===z&&"secondary"||"default",children:ie(z)})}),(0,se.jsxs)(O.A,{align:"right",sx:{px:1},children:[te&&!P&&(0,se.jsx)(j.A,{lang:"ar",onClick:ve.onTrue,children:(0,se.jsx)(T.A,{icon:"octicon:upload-16"})}),(0,se.jsx)(j.A,{color:me.open?"inherit":"default",onClick:me.onOpen,children:(0,se.jsx)(T.A,{icon:"eva:more-vertical-fill"})})]})]}),(0,se.jsx)(re,{refetch:u,appointment:t,open:ge.value,onClose:ge.onFalse}),(0,se.jsxs)(G.A,{open:me.open,onClose:me.onClose,arrow:"right-top",sx:{width:155},children:[oe({category:"unit_service",subcategory:"appointments",acl:"update"})&&(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{ae.push(w.f.unitservice.appointments.edit(b)),me.onClose()},children:[(0,se.jsx)(T.A,{icon:"fluent:edit-32-filled"}),ie("edit")]}),["processing","finished"].includes(z)&&!Y&&oe({category:"unit_service",subcategory:"accounting",acl:"create"})&&(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{ae.push(`${w.f.unitservice.accounting.economicmovements.add}?appointment=${b}`),me.onClose()},sx:{color:"info.main"},children:[(0,se.jsx)(T.A,{icon:"hugeicons:invoice"}),ie("make an invoice")]}),"available"===z&&oe({category:"unit_service",subcategory:"appointments",acl:"update"})&&(0,se.jsxs)(U.A,{lang:"ar",sx:{color:"success.main"},onClick:()=>{y(),me.onClose()},children:[(0,se.jsx)(T.A,{icon:"mdi:register"}),ie("book manually")]}),"available"===z&&oe({category:"unit_service",subcategory:"appointments",acl:"delete"})&&(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{v(),me.onClose()},sx:{color:"error.main"},children:[(0,se.jsx)(T.A,{icon:"mdi:bell-cancel"}),ie("cancel")]}),"canceled"===z&&oe({category:"unit_service",subcategory:"appointments",acl:"update"})&&(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{x(),me.onClose()},sx:{color:"success.main"},children:[(0,se.jsx)(T.A,{icon:"material-symbols-light:notifications-active-rounded"}),ie("uncancel")]}),oe({category:"unit_service",subcategory:"appointments",acl:"update"})&&!["finished","canceled","not booked"].includes(z)&&(0,se.jsxs)(U.A,{lang:"ar",onClick:he.onTrue,children:[(0,se.jsx)(T.A,{icon:"mdi:timer-sync"}),ie("delay")]}),(0,se.jsxs)(U.A,{lang:"ar",onClick:pe.onOpen,children:[(0,se.jsx)(T.A,{icon:"carbon:data-quality-definition"}),ie("DDL")]}),te&&!P&&(0,se.jsxs)(U.A,{lang:"ar",onClick:ve.onTrue,children:[(0,se.jsx)(T.A,{icon:"octicon:upload-16"}),ie("upload analysis")]})]}),(0,se.jsxs)(G.A,{open:pe.open,onClose:pe.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,se.jsxs)(c.A,{sx:{fontWeight:600},children:[ie("creation time"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,se.jsx)(X.A,{primary:(0,H.ts)(N,"dd MMMMMMMM yyyy"),secondary:(0,H.ts)(N,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("created by"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===J||void 0===J?void 0:J.email}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("created by IP"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:K}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("editing time"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,se.jsx)(X.A,{primary:(0,H.ts)(Q,"dd MMMMMMMM yyyy"),secondary:(0,H.ts)(Q,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("editor"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===ee||void 0===ee?void 0:ee.email}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("editor IP"),":"]}),(0,se.jsx)(c.A,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:ne}),(0,se.jsxs)(c.A,{sx:{pt:1,fontWeight:600},children:[ie("modifications no"),": ",le]})]}),(0,se.jsx)(Z.T,{open:he.value,onClose:he.onFalse,title:ie("delay"),content:(0,se.jsxs)(se.Fragment,{children:[ie("How many minutes do you want to delay?"),(0,se.jsx)(h.A,{InputProps:{endAdornment:(0,se.jsx)(_.A,{position:"end",children:(0,se.jsx)(c.A,{sx:{fontSize:"0.8rem"},children:ie("min")})})},type:"number",sx:{p:2,width:"100%"},size:"small",onChange:e=>ye(e.target.value),helperText:ie("knowing that you can type a negative value to make it earlier")}),0!==xe&&(0,se.jsxs)(V.A,{variant:"body2",sx:{textAlign:"center",color:"error.main"},children:[ie("from"),"\xa0",new Date(B).toLocaleTimeString(ie("en-US"),{timeZone:(null===f||void 0===f||null===(a=f.country)||void 0===a?void 0:a.time_zone)||"Asia/Amman",hour:"2-digit",minute:"2-digit"}),"\xa0",ie("to"),"\xa0",new Date(new Date(B).getTime()+60*xe*1e3).toLocaleTimeString(ie("en-US"),{timeZone:(null===f||void 0===f||null===(o=f.country)||void 0===o?void 0:o.time_zone)||"Asia/Amman",hour:"2-digit",minute:"2-digit"})]})]}),action:(0,se.jsxs)(g.A,{variant:"contained",color:"info",onClick:()=>{he.onFalse(),p(t,xe)},children:[ie("delay")," "]})}),(0,se.jsx)(de.A,{open:ve.value,onClose:ve.onFalse,analysisData:{patient:(null===W||void 0===W?void 0:W._id)||W,appointment:b},refetch:u})]})}var ue=l(72221),me=l(17642),pe=l(53193),he=l(74050);function ge(e){var n,l,a,i,t,s,d,c;let{filters:u,onFilters:m,onAdd:p,dateError:h,options:g}=e;const{t:v}=(0,M.WD)(),{user:x}=(0,o.Z)(),{currentLang:y}=(0,M.jc)(),j="ar"===y.value,{workGroupsData:b}=(0,F.hJU)(null===x||void 0===x||null===(n=x.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(a=l[null===x||void 0===x?void 0:x.employee.selected_engagement])||void 0===a||null===(i=a.unit_service)||void 0===i?void 0:i._id),{workShiftsData:A}=(0,F.c8d)(null===x||void 0===x||null===(t=x.employee)||void 0===t||null===(s=t.employee_engagements)||void 0===s||null===(d=s[null===x||void 0===x?void 0:x.employee.selected_engagement])||void 0===d||null===(c=d.unit_service)||void 0===c?void 0:c._id),f=(0,G.f)(),_=(0,r.useCallback)((e=>{m("types",e.target.value)}),[m]),w=(0,r.useCallback)((e=>{m("shift",e.target.value)}),[m]),k=(0,r.useCallback)((e=>{m("group",e.target.value)}),[m]),C=(0,r.useCallback)((e=>{m("startDate",e)}),[m]),D=(0,r.useCallback)((e=>{m("endDate",e)}),[m]);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Q.A,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,se.jsxs)(pe.A,{sx:{width:{xs:1,md:200}},children:[(0,se.jsx)(me.A,{children:`${v("appointment type")}`}),(0,se.jsx)(ue.A,{value:u.appointype,onChange:_,input:(0,se.jsx)(he.A,{label:v("appointment type")}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:g.map(((e,n)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:j?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},n)))})]}),(0,se.jsxs)(pe.A,{sx:{width:{xs:1,md:200}},children:[(0,se.jsx)(me.A,{children:`${v("work group")}`}),(0,se.jsx)(ue.A,{value:u.group,onChange:k,input:(0,se.jsx)(he.A,{label:v("work group")}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:b.map(((e,n)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:j?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},n)))})]}),(0,se.jsxs)(pe.A,{sx:{width:{xs:1,md:200}},children:[(0,se.jsx)(me.A,{children:`${v("work shift")}`}),(0,se.jsx)(ue.A,{value:u.shift,onChange:w,input:(0,se.jsx)(he.A,{label:v("work shift")}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:A.map(((e,n)=>(0,se.jsx)(U.A,{lang:"ar",value:e._id,children:j?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},n)))})]}),(0,se.jsx)(le.l,{label:v("date"),value:u.startDate,onChange:C,slotProps:{textField:{fullWidth:!0}},sx:{width:{xs:1,md:200}}}),(0,se.jsx)(le.l,{label:v("end date"),value:u.endDate,onChange:D,slotProps:{textField:{fullWidth:!0,error:h}},sx:{width:{xs:1,md:200}}}),(0,se.jsx)(Q.A,{direction:"row"})]}),(0,se.jsxs)(G.A,{open:f.open,onClose:f.onClose,arrow:"right-top",sx:{width:140},children:[(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{f.onClose()},children:[(0,se.jsx)(T.A,{icon:"solar:printer-minimalistic-bold"}),v("print")]}),(0,se.jsxs)(U.A,{lang:"ar",onClick:()=>{f.onClose()},children:[(0,se.jsx)(T.A,{icon:"solar:export-bold"}),v("export")]})]})]})}var ve=l(26487),xe=l(8555),ye=l(91264);function je(e){let{filters:n,onFilters:l,onResetFilters:a,results:i,...o}=e;const{t:t}=(0,M.WD)(),s=(0,ye.fT)(n.startDate,n.endDate),r=()=>{l("startDate",null),l("endDate",null)};return(0,se.jsxs)(Q.A,{spacing:1.5,...o,children:[(0,se.jsxs)(c.A,{sx:{typography:"body2"},children:[(0,se.jsx)("strong",{children:i}),(0,se.jsx)(c.A,{component:"span",sx:{color:"text.secondary",ml:.25},children:t("results found")})]}),(0,se.jsxs)(Q.A,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:["active"!==n.status&&(0,se.jsx)(be,{label:t("status:"),children:(0,se.jsx)(ve.A,{size:"small",label:t(n.status),onDelete:()=>{l("status","all")}})}),""!==n.appointype&&(0,se.jsx)(ve.A,{size:"small",label:t("appointment type"),onDelete:()=>{l("types","")}}),""!==n.group&&(0,se.jsx)(ve.A,{size:"small",label:t("work group"),onDelete:()=>{l("group","")}}),""!==n.shift&&(0,se.jsx)(ve.A,{size:"small",label:t("work shift"),onDelete:()=>{l("shift","")}}),n.startDate&&!n.endDate&&(0,se.jsx)(be,{label:t("date:"),children:(0,se.jsx)(ve.A,{size:"small",label:(0,H.ts)(n.startDate),onDelete:r})}),n.startDate&&n.endDate&&(0,se.jsx)(be,{label:t("date:"),children:(0,se.jsx)(ve.A,{size:"small",label:s,onDelete:r})}),(0,se.jsx)(g.A,{color:"error",onClick:a,startIcon:(0,se.jsx)(T.A,{icon:"solar:trash-bin-trash-bold"}),children:t("clear")})]})]})}function be(e){let{label:n,children:l,sx:a,...i}=e;return(0,se.jsxs)(Q.A,{component:xe.A,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...a},...i,children:[(0,se.jsx)(c.A,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,se.jsx)(Q.A,{spacing:1,direction:"row",flexWrap:"wrap",children:l})]})}var Ae=l(90470);const fe={name:"",status:"booked",appointype:"",shift:"",group:"",startDate:null,endDate:null};function _e(e){var n,l,a;let{employeeData:t}=e;const{t:I}=(0,M.WD)(),{currentLang:U}=(0,M.jc)(),L="ar"===U.value,{isMedLab:E}=(0,$.A)(),O=[{id:"start_time",label:I("start time")},{id:"appoint_number",label:I("number")},{id:"appointment_type",label:I("appointment type")},{id:"patient",label:I("patient")},{id:"note",label:I("note")},E&&{id:"medicalAnalysis",label:I("medical analysis")},{id:"work_group",label:I("work group")},{id:"status",label:I("status")},{id:""}].filter(Boolean),V=(0,b.A)(),X=(0,k.rd)(),{enqueueSnackbar:H}=(0,q.dh)(),G=(0,Y.K2)({defaultOrderBy:"start_time"}),{user:N}=(0,o.Z)(),J=(0,i.v)(),K=(0,D.C)(),Q=(0,D.C)(),ee=(0,D.C)(),ne=(0,D.C)(),{appointmenttypesData:le}=(0,F.uZ5)(),[ae,ie]=(0,r.useState)(fe),[oe,te]=(0,r.useState)(0),{appointmentsData:re,refetch:de,lengths:ue,loading:me}=(0,F.ASN)(null===N||void 0===N||null===(n=N.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(a=l[null===N||void 0===N?void 0:N.employee.selected_engagement])||void 0===a?void 0:a.unit_service._id,{page:G.page||0,sortBy:G.orderBy||"code",rowsPerPage:G.rowsPerPage||5,order:G.order||"asc",populate:"all",...ae}),pe=!(!ae.startDate||!ae.endDate)&&ae.startDate.getTime()>ae.endDate.getTime(),he=re,ve=he.slice(G.page*G.rowsPerPage,G.page*G.rowsPerPage+G.rowsPerPage),xe=!s()(ae,fe),ye=!he.length&&xe||!he.length,be=E?[{value:"booked",label:I("booked"),color:"warning",count:null===ue||void 0===ue?void 0:ue.booked},{value:"finished",label:I("finished"),color:"success",count:null===ue||void 0===ue?void 0:ue.finished},{value:"available",label:I("available"),color:"secondary",count:null===ue||void 0===ue?void 0:ue.available},{value:"canceled",label:I("canceled"),color:"error",count:null===ue||void 0===ue?void 0:ue.canceled}]:[{value:"processing",label:I("current"),color:"info",count:null===ue||void 0===ue?void 0:ue.processing},{value:"arrived",label:I("arrived"),color:"success",count:null===ue||void 0===ue?void 0:ue.arrived},{value:"late",label:I("late"),color:"warning",count:null===ue||void 0===ue?void 0:ue.late},{value:"booked",label:I("booked"),color:"info",count:null===ue||void 0===ue?void 0:ue.booked},{value:"finished",label:I("finished"),color:"success",count:null===ue||void 0===ue?void 0:ue.finished},{value:"not arrived",label:I("not arrived"),color:"error",count:null===ue||void 0===ue?void 0:ue.notArrived},{value:"canceled",label:I("canceled"),color:"warning",count:null===ue||void 0===ue?void 0:ue.canceled},{value:"available",label:I("available"),color:"secondary",count:null===ue||void 0===ue?void 0:ue.available},{value:"not booked",label:I("not booked"),color:"secondary",count:null===ue||void 0===ue?void 0:ue.notBooked}],_e=(0,r.useCallback)(((e,n)=>{G.onResetPage(),ie((l=>({...l,[e]:n})))}),[G]),we=(0,r.useCallback)((async e=>{const n=new URLSearchParams({day:e.start_time,appointment:e._id});X.push({pathname:w.f.unitservice.appointments.book,search:`?${n.toString()}`})}),[X]),ke=(0,r.useCallback)((async e=>{try{await P.Ay.patch(`${P.vZ.appointments.one(e._id)}/cancel`),H(I("canceled successfully!")),S.A.emit("updated",{user:N,link:w.f.unitservice.appointments.root,msg:`canceled an appointment <strong>[ ${e.code} ]</strong>`})}catch(n){H(L&&`${n.arabic_message}`||`${n.message}`,{variant:"error"}),console.error(n)}de(),G.onUpdatePageDeleteRow(ve.length)}),[ve.length,G,de,I,H,N,L]),Ce=(0,r.useCallback)((async(e,n)=>{try{await P.Ay.patch(`${P.vZ.appointments.one(e._id)}/delay`,{minutes:n}),H(I("delayed successfully!")),S.A.emit("updated",{user:N,link:w.f.unitservice.appointments.root,msg:`delayed an appointment <strong>[ ${e.code} ]</strong>`})}catch(l){H(L&&`${l.arabic_message}`||`${l.message}`,{variant:"error"}),console.error(l)}de(),te(0),G.onUpdatePageDeleteRow(ve.length)}),[ve.length,G,de,I,H,N,L]),De=(0,r.useCallback)((async e=>{try{await P.Ay.patch(`${P.vZ.appointments.one(e._id)}/uncancel`),H(I("uncanceled successfully!")),S.A.emit("updated",{user:N,link:w.f.unitservice.appointments.root,msg:`uncanceled an appointment <strong>[ ${e.code} ]</strong>`})}catch(n){H(L&&`${n.arabic_message}`||`${n.message}`,{variant:"error"}),console.error(n)}de(),G.onUpdatePageDeleteRow(ve.length)}),[ve.length,G,de,I,H,N,L]),Pe=(0,r.useCallback)((async e=>{try{await P.Ay.patch(`${P.vZ.appointments.all}/cancel`,{ids:G.selected}),H(I("canceled successfully!")),S.A.emit("updated",{user:N,link:w.f.unitservice.appointments.root,msg:"canceled many appointments"})}catch(n){H(L&&`${n.arabic_message}`||`${n.message}`,{variant:"error"}),console.error(n)}de(),G.onUpdatePageDeleteRows({totalRows:null===ue||void 0===ue?void 0:ue.length,totalRowsInPage:ve.length,totalRowsFiltered:he.length})}),[de,L,he.length,ve.length,ue,G,H,N,I]),Se=(0,r.useCallback)((async()=>{try{await P.Ay.patch(`${P.vZ.appointments.all}/delay`,{ids:G.selected,minutes:oe}),H(I("delayed successfully!"))}catch(e){H(L&&`${e.arabic_message}`||`${e.message}`,{variant:"error"}),console.error(e)}de(),te(0),G.onUpdatePageDeleteRows({totalRows:null===ue||void 0===ue?void 0:ue.length,totalRowsInPage:ve.length,totalRowsFiltered:he.length})}),[de,L,he.length,ve.length,ue,G,I,oe,H]),Me=(0,r.useCallback)((async e=>{try{await P.Ay.patch(`${P.vZ.appointments.all}/uncancel`,{ids:G.selected}),H(I("uncanceled successfully!")),S.A.emit("updated",{user:N,link:w.f.unitservice.appointments.root,msg:"uncanceled many appointments"})}catch(n){H(L&&`${n.arabic_message}`||`${n.message}`,{variant:"error"}),console.error(n)}de(),G.onUpdatePageDeleteRows({totalRows:null===ue||void 0===ue?void 0:ue.length,totalRowsInPage:ve.length,totalRowsFiltered:he.length})}),[de,L,he.length,ve.length,ue,G,N,I,H]),$e=(0,r.useCallback)((e=>{X.push(w.f.dashboard.invoice.details(e))}),[X]),Fe=(0,r.useCallback)(((e,n)=>{_e("status",n)}),[_e]),Re=(0,r.useCallback)((()=>{ie(fe)}),[]);return me?(0,se.jsx)(B.x,{}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(x.A,{maxWidth:"xl",children:[(0,se.jsx)(z.A,{heading:I("appointments"),links:[{name:I("dashboard"),href:w.f.unitservice.root},{name:I("appointments")}],action:J({category:"unit_service",subcategory:"appointments",acl:"create"})&&!E&&(0,se.jsx)(g.A,{component:C.W,onClick:()=>K.onTrue(),variant:"contained",startIcon:(0,se.jsx)(T.A,{icon:"mingcute:add-line"}),sx:{bgcolor:"error.dark","&:hover":{bgcolor:"error.main"}},children:I("new urgent appointment")}),sx:{mb:{xs:3,md:5}}}),(0,se.jsxs)(m.A,{children:[(0,se.jsx)(u.A,{value:ae.status,onChange:Fe,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${(0,A.X4)(V.palette.grey[500],.08)}`},children:be.map(((e,n)=>(0,se.jsx)(d.A,{value:e.value,label:e.label,iconPosition:"end",icon:(0,se.jsx)(R.A,{variant:"all"===e.value||e.value===ae.status?"filled":"soft",color:e.color,children:e.count})},n)))}),(0,se.jsx)(ge,{filters:ae,onFilters:_e,onAdd:()=>K.onTrue(),dateError:pe,options:le}),xe&&(0,se.jsx)(je,{filters:ae,onFilters:_e,onResetFilters:Re,results:he.length,sx:{p:2.5,pt:0}}),(0,se.jsxs)(f.A,{sx:{position:"relative",overflow:"unset"},children:[(0,se.jsx)(Y.Uv,{numSelected:G.selected.length,rowCount:he.length,onSelectAllRows:e=>G.onSelectAllRows(e,null===he||void 0===he?void 0:he.map(((e,n)=>e._id))),action:J({category:"unit_service",subcategory:"appointments",acl:"update"})&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(v.A,{title:"delay all",children:(0,se.jsx)(j.A,{color:"info",onClick:ne.onTrue,children:(0,se.jsx)(T.A,{icon:"mdi:timer-sync"})})}),he.filter((e=>G.selected.includes(e._id))).some((e=>"canceled"===e.status))?(0,se.jsx)(v.A,{title:"uncancel all",children:(0,se.jsx)(j.A,{color:"primary",onClick:ee.onTrue,children:(0,se.jsx)(T.A,{icon:"material-symbols-light:notifications-active-rounded"})})}):(0,se.jsx)(v.A,{title:"cancel all",children:(0,se.jsx)(j.A,{color:"error",onClick:Q.onTrue,children:(0,se.jsx)(T.A,{icon:"mdi:bell-cancel"})})})]}),color:he.filter((e=>G.selected.includes(e._id))).some((e=>"canceled"===e.status))?"primary":"error"}),(0,se.jsx)(W.A,{children:(0,se.jsxs)(p.A,{size:G.dense?"small":"medium",sx:{minWidth:800},children:[(0,se.jsx)(Y.er,{order:G.order,orderBy:G.orderBy,headLabel:O,rowCount:null===ue||void 0===ue?void 0:ue.length,numSelected:G.selected.length,onSort:G.onSort,onSelectAllRows:e=>G.onSelectAllRows(e,null===he||void 0===he?void 0:he.map(((e,n)=>e._id)))}),(0,se.jsxs)(y.A,{children:[null===he||void 0===he?void 0:he.map(((e,n)=>(0,se.jsx)(ce,{refetch:de,row:e,selected:G.selected.includes(e._id),onSelectRow:()=>G.onSelectRow(e._id),onViewRow:()=>$e(e._id),onDelayRow:Ce,onBookAppoint:()=>we(e),onCancelRow:()=>ke(e),onUnCancelRow:()=>De(e)},n))),(0,se.jsx)(Y.Sm,{notFound:ye})]})]})})]}),(0,se.jsx)(Y.We,{count:null===ue||void 0===ue?void 0:ue.length,page:G.page,rowsPerPage:G.rowsPerPage,onPageChange:G.onChangePage,onRowsPerPageChange:G.onChangeRowsPerPage,dense:G.dense,onChangeDense:G.onChangeDense})]})]}),(0,se.jsx)(Ae.A,{refetch:de,open:K.value,onClose:K.onFalse}),(0,se.jsx)(Z.T,{open:Q.value,onClose:Q.onFalse,title:I("cancel"),content:(0,se.jsxs)(se.Fragment,{children:[I("Are you sure want to cancel")," ",(0,se.jsxs)("strong",{children:[" ",G.selected.length," "]})," ",I("items?")]}),action:(0,se.jsx)(g.A,{variant:"contained",color:"error",onClick:()=>{Q.onFalse(),Pe()},children:I("cancel")})}),(0,se.jsx)(Z.T,{open:ee.value,onClose:ee.onFalse,title:I("uncancel"),content:(0,se.jsxs)(se.Fragment,{children:[I("Are you sure want to uncancel")," ",(0,se.jsxs)("strong",{children:[" ",G.selected.length," "]})," ",I("items?")]}),action:(0,se.jsx)(g.A,{variant:"contained",color:"error",onClick:()=>{ee.onFalse(),Me()},children:I("uncancel")})}),(0,se.jsx)(Z.T,{open:ne.value,onClose:ne.onFalse,title:I("delay"),content:(0,se.jsxs)(se.Fragment,{children:[I("How many minutes do you want to delay items?"),(0,se.jsx)(h.A,{InputProps:{endAdornment:(0,se.jsx)(_.A,{position:"end",children:(0,se.jsx)(c.A,{sx:{fontSize:"0.8rem"},children:I("min")})})},type:"number",sx:{p:2,width:"100%"},size:"small",onChange:e=>te(e.target.value),helperText:I("knowing that you can type a negative value to make it earlier")})]}),action:(0,se.jsxs)(g.A,{variant:"contained",color:"info",onClick:()=>{ne.onFalse(),Se()},children:[I("delay")," "]})})]})}function we(){var e,n,l,t,s;const{user:r}=(0,o.Z)(),d=null===r||void 0===r||null===(e=r.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(l=n[null===r||void 0===r||null===(s=r.employee)||void 0===s?void 0:s.selected_engagement])||void 0===l||null===(t=l.unit_service)||void 0===t?void 0:t.name_english;return(0,se.jsxs)(i.A,{category:"unit_service",subcategory:"appointments",acl:"read",children:[(0,se.jsxs)(a.mg,{children:[(0,se.jsxs)("title",{children:[d||"unit of service"," : Appointments"]}),(0,se.jsx)("meta",{name:"description",content:"meta"})]}),(0,se.jsx)(_e,{})]})}},91264:(e,n,l)=>{l.d(n,{fT:()=>s});var a=l(41210),i=l(407),o=l(2431),t=l(57442);function s(e,n){const l=(new Date).getFullYear(),s=e?(0,a.A)(e):null,r=n?(0,a.A)(n):null,d=l===s&&l===r,c=!(!e||!n)&&(0,i.A)(new Date(e),new Date(n)),u=!(!e||!n)&&(0,o.A)(new Date(e),new Date(n));return d?u?c?(0,t.ts)(n,"dd MMM yy"):`${(0,t.ts)(e,"dd")} - ${(0,t.ts)(n,"dd MMM yy")}`:`${(0,t.ts)(e,"dd MMM")} - ${(0,t.ts)(n,"dd MMM yy")}`:`${(0,t.ts)(e,"dd MMM yy")} - ${(0,t.ts)(n,"dd MMM yy")}`}l(70579);l(65043)}}]);
//# sourceMappingURL=78549.f51fe8db.chunk.js.map
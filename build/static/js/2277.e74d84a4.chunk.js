"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2277],{85010:(e,a,n)=>{n.r(a),n.d(a,{default:()=>c});var t=n(6907),r=n(19208),i=n(27031),l=n(36980),s=n(35456),o=n(10266),d=n(17579),m=n(80184);function u(e){let{WorkGroupData:a,departmentData:n}=e;return(0,m.jsx)(o.Z,{maxWidth:"xl",children:a&&n&&(0,m.jsx)(d.Z,{departmentData:n,currentTable:a})})}function c(){const e=(0,r.UO)(),{id:a,acid:n}=e,o=(0,l.YLE)(a).data,{data:d,loading:c}=(0,l.tBz)(n);return(0,m.jsxs)(i.Z,{category:"department",subcategory:"management_tables",acl:"update",children:[(0,m.jsxs)(t.ql,{children:[(0,m.jsxs)("title",{children:[o.name_english||"Deartment"," : Edit Work Group"]}),(0,m.jsx)("meta",{name:"description",content:"meta"})]}),c&&(0,m.jsx)(s.a,{}),!c&&(0,m.jsx)(u,{WorkGroupData:d,departmentData:o})]})}},17579:(e,a,n)=>{n.d(a,{Z:()=>j});var t=n(8007),r=n(763),i=n(61134),l=n(72791),s=n(44695),o=n(16029),d=n(57621),m=n(85771),u=n(53767),c=n(24308),p=n(12258),g=n(38072),v=n(66664),_=n(99116),h=n(8976),y=n(81164),b=n(36980),x=n(32869),k=n(535),f=n(80184);function j(e){let{departmentData:a,currentTable:n}=e;const{t:j}=(0,y.qM)(),{currentLang:Z}=(0,y.nt)(),w="ar"===Z.value,{user:D}=(0,h.E)(),{employeesData:E}=(0,b.C$X)(a._id),[q,C]=(0,l.useState)([]),{enqueueSnackbar:G}=(0,x.Ds)(),S=t.Ry().shape({name_arabic:t.Z_().required(j("required field")),name_english:t.Z_().required(j("required field")),employees:t.IX().min(1,"".concat(j("must be at least")," 1"))}),V=(0,l.useMemo)((()=>{var e,t;return{unit_service:(null===D||void 0===D||null===(e=D.employee)||void 0===e||null===(t=e.employee_engagements[null===D||void 0===D?void 0:D.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===n||void 0===n?void 0:n.name_arabic)||"",name_english:(null===n||void 0===n?void 0:n.name_english)||"",employees:(null===n||void 0===n?void 0:n.employees.map(((e,a)=>e.employee)))||[]}}),[n,a,null===D||void 0===D?void 0:D.employee]),O=(0,i.cI)({mode:"onTouched",resolver:(0,s.X)(S),defaultValues:V}),{reset:T,handleSubmit:W,formState:{isSubmitting:$,errors:H}}=O;(0,l.useEffect)((()=>{Object.keys(H).length&&Object.keys(H).forEach(((e,a)=>{var n;return G("".concat(e,": ").concat((null===H||void 0===H||null===(n=H[e])||void 0===n?void 0:n.message)||"error"),{variant:"error"})}))}),[H,G]);const I=W((async e=>{try{n?(await v.ZP.patch(v.Hv.work_groups.one(n._id),e),_.Z.emit("updated",{data:e,user:D,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"updated work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})):(await v.ZP.post(v.Hv.work_groups.all,e),_.Z.emit("created",{data:e,user:D,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"created work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})),T(),G(j(n?"update success!":"create success!"))}catch(t){G(w&&t.arabic_message||t.message,{variant:"error"}),console.error(t)}}));return(0,l.useEffect)((()=>{var e,t;T({unit_service:(null===D||void 0===D||null===(e=D.employee)||void 0===e||null===(t=e.employee_engagements[null===D||void 0===D?void 0:D.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===n||void 0===n?void 0:n.name_arabic)||"",name_english:(null===n||void 0===n?void 0:n.name_english)||"",employees:(null===n||void 0===n?void 0:n.employees.map(((e,a)=>e.employee)))||[]})}),[n]),(0,f.jsx)(k.ZP,{methods:O,onSubmit:I,children:(0,f.jsx)(c.Z,{xs:12,maxWidth:"md",children:(0,f.jsxs)(d.Z,{sx:{p:3},children:[(0,f.jsxs)(o.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,f.jsx)(k.au,{onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%.()]*$/.test(e.target.value)&&O.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(j("name english")," *")}),(0,f.jsx)(k.au,{onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_\-()]*$/.test(e.target.value)&&O.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(j("name arabic")," *")}),(0,f.jsx)(k.Fl,{name:"employees",label:"".concat(j("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:E.filter((e=>!q.some((a=>(0,r.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a,n)=>{var t;return(0,l.createElement)("li",{...e,key:n,value:a._id},w?null===(t=a.employee)||void 0===t?void 0:t.name_arabic:a.employee.name_english)},onChange:(e,a)=>{C(a),O.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,n)=>(0,l.createElement)(m.Z,{...a({index:n}),key:n,label:w?e.employee.name_arabic:e.employee.name_english,size:"small",color:"info",variant:"soft"})))})]}),(0,f.jsx)(u.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,f.jsx)(p.Z,{type:"submit",tabIndex:-1,variant:"contained",loading:$,children:j(n?"save changes":"create")})})]})})})}}}]);
//# sourceMappingURL=2277.e74d84a4.chunk.js.map
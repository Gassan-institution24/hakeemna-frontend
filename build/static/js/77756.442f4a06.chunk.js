"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[77756],{7545:(e,n,l)=>{l.d(n,{A:()=>D});var i=l(80899),o=l(65043),a=l(46987),t=l(24858),r=l(18403),d=l(74600),s=l(49633),c=l(83462),u=l(81e3),p=l(39336),v=l(38246),h=l(4219),m=l(29347),x=l(35316),y=l(67132),g=l(31673),j=l(75139),b=l(60778),A=l(94496),f=l(67784),_=l(51787),w=l(70579);function C(e){let{name:n,button:l,helperText:i,label:o,...a}=e;const{control:r}=(0,t.xW)(),{t:s}=(0,b.WD)();return(0,w.jsx)(t.xI,{name:n,control:r,render:e=>{let{field:n,fieldState:{error:t}}=e;const r=n.value||0,c=Math.floor(r/60),u=r%60;return(0,w.jsxs)(d.A,{children:[(0,w.jsxs)(d.A,{direction:"row",justifyContent:"space-between",children:[(0,w.jsx)(A.A,{variant:"subtitle2",sx:{mb:1},children:o}),l]}),(0,w.jsxs)(d.A,{direction:"row",gap:1,children:[(0,w.jsx)(f.A,{size:"small",value:c||"",onChange:e=>{const l=60*parseInt(e.target.value||"0",10)+u;n.onChange(l)},InputLabelProps:{shrink:!0},InputProps:{endAdornment:(0,w.jsx)(_.A,{position:"end",children:s("hr")})},error:!!t,helperText:t?null===t||void 0===t?void 0:t.message:i,...a}),(0,w.jsx)(f.A,{size:"small",value:u||"",onChange:e=>{const l=parseInt(e.target.value||"0",10),i=60*c+l;n.onChange(i)},InputLabelProps:{shrink:!0},InputProps:{endAdornment:(0,w.jsx)(_.A,{position:"end",children:s("min")})},error:!!t,helperText:t?null===t||void 0===t?void 0:t.message:i,...a})]})]})}})}var k=l(59699);function D(e){var n,l,A;let{row:f,open:_,onClose:D,refetch:P,start_date:L,end_date:M,hours:S,annual:q,sick:W,unpaid:R,publicHolidays:O,other:I,ids:F,monthly:T,length:B}=e;const{user:E}=(0,j.Z)(),{id:$}=(0,y.g)(),{enqueueSnackbar:Z}=(0,a.dh)(),{t:z}=(0,b.WD)(),{currentLang:V}=(0,b.jc)(),G="ar"===V.value,U=i.Ik().shape({start_date:i.p6().required(z("required field")),end_date:i.p6().required(z("required field")),working_time:i.ai(),calculated_time:i.ai(),annual:i.ai(),sick:i.ai(),unpaid:i.ai(),public:i.ai(),other:i.ai(),social_security:i.ai(),tax:i.ai(),deduction:i.ai(),total:i.ai(),annual_equivalent:i.ai(),sick_equivalent:i.ai(),unpaid_equivalent:i.ai(),public_equivalent:i.ai(),other_equivalent:i.ai(),days:i.ai(),note:i.Yj().nullable()}),H={unit_service:(null===f||void 0===f?void 0:f.unit_service)||(null===E||void 0===E||null===(n=E.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(A=l[E.employee.selected_engagement].unit_service)||void 0===A?void 0:A._id),employee_engagement:(null===f||void 0===f?void 0:f.employee_engagement)||$,start_date:(null===f||void 0===f?void 0:f.start_date)||L||null,end_date:(null===f||void 0===f?void 0:f.end_date)||M||null,working_time:(null===f||void 0===f?void 0:f.working_time)||S||0,calculated_time:(null===f||void 0===f?void 0:f.calculated_time)||0,annual:(null===f||void 0===f?void 0:f.annual)||q||0,sick:(null===f||void 0===f?void 0:f.sick)||W||0,unpaid:(null===f||void 0===f?void 0:f.unpaid)||R||0,public:(null===f||void 0===f?void 0:f.public)||O||0,other:(null===f||void 0===f?void 0:f.other)||I||0,social_security:(null===f||void 0===f?void 0:f.social_security)||0,tax:(null===f||void 0===f?void 0:f.tax)||0,deduction:(null===f||void 0===f?void 0:f.deduction)||0,total:(null===f||void 0===f?void 0:f.total)||0,annual_equivalent:(null===f||void 0===f?void 0:f.annual_equivalent)||0,sick_equivalent:(null===f||void 0===f?void 0:f.sick_equivalent)||0,unpaid_equivalent:(null===f||void 0===f?void 0:f.unpaid_equivalent)||0,public_equivalent:(null===f||void 0===f?void 0:f.public_equivalent)||0,other_equivalent:(null===f||void 0===f?void 0:f.other_equivalent)||0,note:(null===f||void 0===f?void 0:f.note)||"",days:(null===f||void 0===f?void 0:f.days)||B||0},N=(0,t.mN)({resolver:(0,r.t)(U),defaultValues:H}),{watch:J,handleSubmit:K,formState:{isSubmitting:Y}}=N,Q=J(),X=K((async e=>{try{if(T){if(f)return await g.Ay.patch(g.vZ.yearlyReport.one(f._id),e),D(),P(),void Z(z("edited successfuly"));await g.Ay.post(g.vZ.yearlyReport.all,{...e,ids:F}),D(),P(),Z(z("created successfuly"))}else{if(f)return await g.Ay.patch(g.vZ.monthlyReport.one(f._id),e),D(),P(),void Z(z("edited successfuly"));await g.Ay.post(g.vZ.monthlyReport.all,{...e,ids:F}),D(),P(),Z(z("created successfuly"))}}catch(n){Z(G&&n.arabic_message||n.message,{variant:"error"})}}));return(0,o.useEffect)((()=>{N.setValue("total",Q.salary?Q.salary-Q.deduction-Q.tax-Q.social_security:0)}),[Q.salary,Q.deduction,Q.tax,Q.social_security]),(0,w.jsx)(c.A,{fullWidth:!0,maxWidth:"md",open:_,onClose:()=>{N.reset(),D()},children:(0,w.jsxs)(k.Ay,{methods:N,onSubmit:X,children:[(0,w.jsx)(h.A,{children:z(T?"Create Yearly report":"Create Monthly report")}),(0,w.jsx)(x.A,{dividers:!0,children:(0,w.jsxs)(d.A,{spacing:3,mt:2,children:[(0,w.jsxs)(u.A,{display:"grid",columnGap:2,rowGap:2,gridTemplateColumns:{xs:"repeat(2, 1fr)"},alignItems:"flex-end",children:[(0,w.jsx)(k.ZE,{disabled:!0,name:"start_date",label:z("Start date")}),(0,w.jsx)(k.ZE,{disabled:!0,name:"end_date",label:z("End date")}),(0,w.jsx)(C,{disabled:!0,name:"working_time",label:z("Working time")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"days",label:z("Days")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"annual",label:z("Annual")}),(0,w.jsx)(C,{type:"number",name:"annual_equivalent",label:z("Annual equivalent")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"sick",label:z("Sick")}),(0,w.jsx)(C,{type:"number",name:"sick_equivalent",label:z("Sick equivalent")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"unpaid",label:z("Unpaid")}),(0,w.jsx)(C,{type:"number",name:"unpaid_equivalent",label:z("Unpaid equivalent")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"public",label:z("Public")}),(0,w.jsx)(C,{type:"number",name:"public_equivalent",label:z("Public equivalent")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"other",label:z("Other")}),(0,w.jsx)(C,{type:"number",name:"other_equivalent",label:z("Other equivalent")})]}),(0,w.jsx)(p.A,{}),(0,w.jsxs)(u.A,{display:"grid",columnGap:2,rowGap:2,gridTemplateColumns:{xs:"repeat(2, 1fr)"},alignItems:"flex-end",children:[(0,w.jsx)(C,{name:"calculated_time",label:z("Calculated minutes"),button:(0,w.jsx)(s.A,{onClick:()=>N.setValue("calculated_time",Q.working_time+Q.unpaid_equivalent+Q.other_equivalent+Q.public_equivalent+Q.sick_equivalent+Q.annual_equivalent),sx:{my:1},size:"small",variant:"contained",color:"primary",children:z("Calculate")})}),(0,w.jsx)(k.o3,{type:"number",name:"salary",label:z("Salary")}),(0,w.jsx)(k.o3,{type:"number",name:"social_security",label:z("social security")}),(0,w.jsx)(k.o3,{type:"number",name:"tax",label:z("tax")}),(0,w.jsx)(k.o3,{type:"number",name:"deduction",label:z("deduction")}),(0,w.jsx)(k.o3,{disabled:!0,type:"number",name:"total",label:z("total")})]}),(0,w.jsx)(k.o3,{name:"note",label:z("note")})]})}),(0,w.jsxs)(m.A,{children:[(0,w.jsx)(s.A,{color:"inherit",variant:"outlined",onClick:D,children:z("Cancel")}),(0,w.jsx)(v.A,{type:"submit",variant:"contained",loading:Y,children:z("Save")})]})]})})}},52369:(e,n,l)=>{l.d(n,{A:()=>m});var i=l(65043),o=l(74600),a=l(94814),t=l(94496),r=l(49633),d=l(84284),s=l(59229),c=l(60778),u=l(35151),p=l(34624),v=l(7545),h=l(70579);function m(e){let{filters:n,onFilters:l,onAdd:m,hours:x,length:y,annual:g,sick:j,unpaid:b,publicHolidays:A,other:f,refetch:_,monthly:w,dateError:C,ids:k}=e;const{t:D}=(0,c.WD)(),[P,L]=(0,i.useState)(""),M=(0,p.f)(),S=(0,s.C)(),q=(0,i.useCallback)((e=>{P&&L(""),l("startDate",e)}),[l,P]),W=(0,i.useCallback)((e=>{P&&L(""),l("endDate",e)}),[l,P]),R=(0,i.useCallback)((()=>{n.startDate&&n.endDate?S.onTrue():L(!0)}),[n.startDate,n.endDate,S]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(o.A,{direction:"row",justifyContent:"space-between",children:[(0,h.jsxs)(o.A,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,h.jsxs)(o.A,{justifyContent:"flex-start",children:[(0,h.jsx)(d.l,{label:D("start date"),value:n.startDate,onChange:q,slotProps:{textField:{fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:P?"error.main":""}}}}},sx:{width:{xs:1,md:200}}}),P&&(0,h.jsx)(t.A,{variant:"caption",color:"error",children:D("please select start and end date")})]}),(0,h.jsxs)(o.A,{justifyContent:"flex-start",children:[(0,h.jsx)(d.l,{label:D("end date"),value:n.endDate,onChange:W,slotProps:{textField:{fullWidth:!0,error:C,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:P?"error.main":""}}}}},sx:{width:{xs:1,md:200}}}),P&&(0,h.jsx)(t.A,{variant:"caption",color:"error",children:D("please select start and end date")})]})]}),(0,h.jsx)(o.A,{justifyContent:"center",mx:3,children:(0,h.jsx)(r.A,{variant:"contained",color:"primary",onClick:R,children:D(w?"make yearly report":"make monthly report")})})]}),(0,h.jsxs)(p.A,{open:M.open,onClose:M.onClose,arrow:"right-top",sx:{width:140},children:[(0,h.jsxs)(a.A,{lang:"ar",onClick:()=>{M.onClose()},children:[(0,h.jsx)(u.A,{icon:"solar:printer-minimalistic-bold"}),D("print")]}),(0,h.jsxs)(a.A,{lang:"ar",onClick:()=>{M.onClose()},children:[(0,h.jsx)(u.A,{icon:"solar:export-bold"}),D("export")]})]}),S.value&&(0,h.jsx)(v.A,{start_date:n.startDate,end_date:n.endDate,hours:x,annual:g,sick:j,unpaid:b,publicHolidays:A,other:f,open:S.value,onClose:S.onFalse,ids:k,refetch:_,monthly:w,length:y})]})}},57287:(e,n,l)=>{l.d(n,{A:()=>B});var i=l(65043),o=l(12110),a=l(71806),t=l(77224),r=l(73460),d=l(79650),s=l(48407),c=l(67132),u=l(60778),p=l(51440),v=l(75950),h=l(46987),m=l(74600),x=l(94496),y=l(31673),g=l(40799),j=l(39556);var b=l(67555),A=l(81e3),f=l(94814),_=l(68738),w=l(39652),C=l(17392),k=l(26353),D=l(49633),P=l(59229),L=l(57442),M=l(68719),S=l(35151),q=l(70074),W=l(34624),R=l(70579);function O(e){var n,l;let{row:i,selected:o,onSelectRow:a,onDeleteRow:t,onViewRow:r,hideEmployee:d}=e;const{code:s,employee_engagement:c,start_date:p,end_date:v,working_time:h,annual:m,sick:x,unpaid:y,public:g,other:j,created_at:b,user_creation:O,ip_address_user_creation:I,updated_at:F,user_modification:T,ip_address_user_modification:B,modifications_nums:E}=i,{t:$}=(0,u.WD)(),Z=(0,M.v)(),{currentLang:z}=(0,u.jc)(),V="ar"===z.value,G=(0,W.f)(),U=(0,W.f)(),H=(0,P.C)(),N=(0,R.jsxs)(_.A,{hover:!0,selected:o,children:[(0,R.jsx)(w.A,{align:"center",children:s}),!d&&(0,R.jsx)(w.A,{align:"center",children:V?null===c||void 0===c||null===(n=c.employee)||void 0===n?void 0:n.name_arabic:null===c||void 0===c||null===(l=c.employee)||void 0===l?void 0:l.name_english}),(0,R.jsx)(w.A,{align:"center",children:(0,L.ts)(p)}),(0,R.jsx)(w.A,{align:"center",children:(0,L.ts)(v)}),(0,R.jsx)(w.A,{align:"center",children:(0,L.lU)(h)}),(0,R.jsx)(w.A,{align:"center",children:m}),(0,R.jsx)(w.A,{align:"center",children:x}),(0,R.jsx)(w.A,{align:"center",children:y}),(0,R.jsx)(w.A,{align:"center",children:g}),(0,R.jsx)(w.A,{align:"center",children:j}),(0,R.jsx)(w.A,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,R.jsx)(C.A,{color:G.open?"inherit":"default",onClick:G.onOpen,children:(0,R.jsx)(S.A,{icon:"eva:more-vertical-fill"})})})]});return(0,R.jsxs)(R.Fragment,{children:[N,(0,R.jsxs)(W.A,{open:G.open,onClose:G.onClose,arrow:"right-top",sx:{width:140},children:[(0,R.jsxs)(f.A,{lang:"ar",onClick:U.onOpen,children:[(0,R.jsx)(S.A,{icon:"carbon:data-quality-definition"}),$("DDL")]}),Z({category:"unit_service",subcategory:"hr",acl:"delete"})&&(0,R.jsxs)(f.A,{sx:{color:"error.main"},lang:"ar",onClick:H.onTrue,children:[(0,R.jsx)(S.A,{icon:"mdi:trash"}),$("Delete")]})]}),(0,R.jsxs)(W.A,{open:U.open,onClose:U.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,R.jsxs)(A.A,{sx:{fontWeight:600},children:[$("creation time"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,R.jsx)(k.A,{primary:(0,L.ts)(b,"dd MMMMMMMM yyyy"),secondary:(0,L.ts)(b,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("created by"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===O||void 0===O?void 0:O.email}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("created by IP"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:I}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("editing time"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,R.jsx)(k.A,{primary:(0,L.ts)(F,"dd MMMMMMMM yyyy"),secondary:(0,L.ts)(F,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("editor"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===T||void 0===T?void 0:T.email}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("editor IP"),":"]}),(0,R.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:B}),(0,R.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[$("modifications no"),": ",E]})]}),(0,R.jsx)(q.T,{open:H.value,onClose:H.onFalse,title:$("Deleting Report"),content:$("Are you sure to delete this?"),action:(0,R.jsx)(D.A,{variant:"contained",color:"error",onClick:()=>{G.onClose(),H.onFalse(),t(i._id)},children:$("Delete")})})]})}var I=l(52369),F=l(99812);const T={name:""};function B(e){let{employee:n}=e;const{t:l}=(0,u.WD)(),A=[{id:"code",label:l("number")},...n?[]:[{id:"employee_engagement",label:l("employee name")}],{id:"start_date",label:l("Start Date")},{id:"end_date",label:l("End Date")},{id:"working_time",label:l("Working hours")},{id:"annual",label:l("annual days off")},{id:"sick",label:l("sick days off")},{id:"unpaid",label:l("unpaid days off")},{id:"public",label:l("public days off")},{id:"other",label:l("other days off")},{id:"",width:88}].filter(Boolean),f=(0,v.K2)({defaultOrderBy:"code"}),_=(0,i.useRef)(),{enqueueSnackbar:w}=(0,h.dh)(),C=(0,c.rd)(),[k,D]=(0,i.useState)(T),{reportsData:P,refetch:L,loading:M,hours:S,annual:q,sick:W,unpaid:B,other:E,public:$,ids:Z}=function(e){const n=[y.vZ.yearlyReport.all,{params:e}],{data:l,isLoading:o,error:a,isValidating:t}=(0,g.Ay)(n,y.GO);return{...(0,i.useMemo)((()=>({reportsData:(null===l||void 0===l?void 0:l.data)||[],hasMore:null===l||void 0===l?void 0:l.hasMore,annual:null===l||void 0===l?void 0:l.annual,sick:null===l||void 0===l?void 0:l.sick,unpaid:null===l||void 0===l?void 0:l.unpaid,other:null===l||void 0===l?void 0:l.other,public:null===l||void 0===l?void 0:l.public,hours:null===l||void 0===l?void 0:l.hours,ids:null===l||void 0===l?void 0:l.ids,loading:o,error:a,validating:t,empty:!o&&!(null!==l&&void 0!==l&&l.length)})),[l,a,o,t]),refetch:async()=>{await(0,j.j)(n)}}}({populate:[{path:"employee_engagement",select:"employee",populate:{path:"employee",select:"name_english name_arabic"}}],employee_engagement:n,startDate:null===k||void 0===k?void 0:k.startDate,endDate:null===k||void 0===k?void 0:k.endDate,reported:0}),z=!(!k.startDate||!k.endDate)&&k.startDate.getTime()>k.endDate.getTime(),V=function(e){var n;let{inputData:l,comparator:i,filters:o,dateError:a}=e;const{name:t}=o,r=null===(n=l)||void 0===n?void 0:n.map(((e,n,l)=>[e,n]));r.sort(((e,n)=>{const l=i(e[0],n[0]);return 0!==l?l:e[1]-n[1]})),l=r.map(((e,n)=>e[0])),t&&(l=l.filter((e=>{var n,l,i,o,a,r,d,s,c,u,p,v,h,m,x,y,g,j,b,A,f,_,w,C,k,D,P,L,M,S,q,W,R,O,I,F,T,B,E,$,Z,z;return(null===e||void 0===e||null===(n=e.employee)||void 0===n?void 0:n.name_english)&&-1!==(null===e||void 0===e||null===(l=e.employee)||void 0===l||null===(i=l.name_english)||void 0===i?void 0:i.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(o=e.employee)||void 0===o?void 0:o.name_arabic)&&-1!==(null===e||void 0===e||null===(a=e.employee)||void 0===a||null===(r=a.name_arabic)||void 0===r?void 0:r.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(d=e.employee)||void 0===d?void 0:d.name_english)&&-1!==(null===e||void 0===e||null===(s=e.employee)||void 0===s||null===(c=s.name_english)||void 0===c?void 0:c.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(u=e.employee)||void 0===u||null===(p=u.country)||void 0===p?void 0:p.name_english)&&-1!==(null===e||void 0===e||null===(v=e.employee)||void 0===v||null===(h=v.country)||void 0===h||null===(m=h.name_english)||void 0===m?void 0:m.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(x=e.employee)||void 0===x||null===(y=x.country)||void 0===y?void 0:y.name_arabic)&&-1!==(null===e||void 0===e||null===(g=e.employee)||void 0===g||null===(j=g.country)||void 0===j||null===(b=j.name_arabic)||void 0===b?void 0:b.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(A=e.employee)||void 0===A||null===(f=A.city)||void 0===f?void 0:f.name_english)&&-1!==(null===e||void 0===e||null===(_=e.employee)||void 0===_||null===(w=_.city)||void 0===w||null===(C=w.name_english)||void 0===C?void 0:C.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(k=e.employee)||void 0===k||null===(D=k.city)||void 0===D?void 0:D.name_arabic)&&-1!==(null===e||void 0===e||null===(P=e.employee)||void 0===P||null===(L=P.city)||void 0===L||null===(M=L.name_arabic)||void 0===M?void 0:M.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(S=e.employee)||void 0===S||null===(q=S.nationality)||void 0===q?void 0:q.name_english)&&-1!==(null===e||void 0===e||null===(W=e.employee)||void 0===W||null===(R=W.nationality)||void 0===R||null===(O=R.name_english)||void 0===O?void 0:O.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(I=e.employee)||void 0===I||null===(F=I.nationality)||void 0===F?void 0:F.name_arabic)&&-1!==(null===e||void 0===e||null===(T=e.employee)||void 0===T||null===(B=T.nationality)||void 0===B||null===(E=B.name_arabic)||void 0===E?void 0:E.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===($=e.employee)||void 0===$?void 0:$.email)&&-1!==(null===e||void 0===e||null===(Z=e.employee)||void 0===Z||null===(z=Z.email)||void 0===z?void 0:z.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===t||JSON.stringify(e.code)===t})));return l}({inputData:P,comparator:(0,v.hz)(f.order,f.orderBy),filters:k,dateError:z}),G=!(null===k||void 0===k||!k.name),U=!V.length&&G||!V.length,H=(0,i.useCallback)(((e,n)=>{f.onResetPage(),D((l=>({...l,[e]:n})))}),[f]),N=(0,i.useCallback)((e=>{C.push(s.f.unitservice.hr.employee(e))}),[C]),J=(0,i.useCallback)((()=>{D(T)}),[]),K=(0,i.useCallback)((async e=>{try{await y.Ay.delete(y.vZ.yearlyReport.one(e)),L()}catch(n){console.log("error",n),w(null===n||void 0===n?void 0:n.message,{variant:"error"})}}),[w,L]);return M?(0,R.jsx)(b.x,{}):(0,R.jsxs)(t.A,{maxWidth:"xl",children:[(0,R.jsxs)(m.A,{direction:{md:"row"},justifyContent:"space-around",mb:2,children:[(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("working hours"),":"]}),(0,R.jsx)(x.A,{children:S>60?`${Math.floor(S/60)} ${l("hr")} : ${(S%60).toString().padStart(2,"0")} ${l("min")}`:`${S} ${l("min")}`})]}),(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("annual days off"),":"]}),(0,R.jsx)(x.A,{children:q})]}),(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("sick days off"),":"]}),(0,R.jsx)(x.A,{children:W})]}),(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("unpaid days off"),":"]}),(0,R.jsx)(x.A,{children:B})]}),(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("public days off"),":"]}),(0,R.jsx)(x.A,{children:$})]}),(0,R.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,R.jsxs)(x.A,{children:[l("other days off"),":"]}),(0,R.jsx)(x.A,{children:E})]})]}),(0,R.jsxs)(o.A,{children:[(0,R.jsx)(I.A,{filters:k,onFilters:H,monthly:!0,hours:S,annual:q,sick:W,unpaid:B,other:E,publicHolidays:$,refetch:L,ids:Z,canReset:G,onResetFilters:J}),G&&(0,R.jsx)(F.A,{filters:k,onFilters:H,onResetFilters:J,results:V.length,sx:{p:2.5,pt:0}}),(0,R.jsxs)(d.A,{children:[(0,R.jsx)(v.Uv,{dense:f.dense,numSelected:f.selected.length,rowCount:V.length,color:V.filter((e=>f.selected.includes(e._id))).some((e=>"inactive"===e.status))?"primary":"error"}),(0,R.jsx)(p.A,{children:(0,R.jsxs)(a.A,{ref:_,size:f.dense?"small":"medium",children:[(0,R.jsx)(v.er,{order:f.order,orderBy:f.orderBy,headLabel:A,rowCount:V.length,numSelected:f.selected.length,onSort:f.onSort}),(0,R.jsxs)(r.A,{children:[V.slice(f.page*f.rowsPerPage,f.page*f.rowsPerPage+f.rowsPerPage).map(((e,l)=>(0,R.jsx)(O,{row:e,filters:k,setFilters:D,selected:f.selected.includes(e._id),onSelectRow:()=>f.onSelectRow(e._id),onViewRow:()=>N(e._id),onDeleteRow:()=>K(e._id),hideEmployee:!!n},l))),(0,R.jsx)(v.Sm,{notFound:U})]})]})})]}),(0,R.jsx)(v.We,{count:V.length,page:f.page,rowsPerPage:f.rowsPerPage,onPageChange:f.onChangePage,onRowsPerPageChange:f.onChangeRowsPerPage,dense:f.dense,onChangeDense:f.onChangeDense})]})]})}},72361:(e,n,l)=>{l.d(n,{A:()=>E});var i=l(65043),o=l(12110),a=l(71806),t=l(77224),r=l(73460),d=l(79650),s=l(48407),c=l(67132),u=l(60778),p=l(51440),v=l(75950),h=l(46987),m=l(74600),x=l(94496),y=l(31673),g=l(40799),j=l(39556);var b=l(67555),A=l(81e3),f=l(94814),_=l(68738),w=l(39652),C=l(17392),k=l(26353),D=l(49633),P=l(59229),L=l(57442),M=l(68719),S=l(35151),q=l(70074),W=l(34624),R=l(7545),O=l(70579);function I(e){var n,l;let{row:i,selected:o,onSelectRow:a,onDeleteRow:t,onViewRow:r,hideEmployee:d,refetch:s}=e;const{code:c,employee_engagement:p,start_date:v,end_date:h,working_time:m,annual:x,sick:y,public:g,unpaid:j,other:b,created_at:I,user_creation:F,ip_address_user_creation:T,updated_at:B,user_modification:E,ip_address_user_modification:$,modifications_nums:Z,salary:z,total:V}=i,{t:G}=(0,u.WD)(),U=(0,M.v)(),{currentLang:H}=(0,u.jc)(),N="ar"===H.value,J=(0,W.f)(),K=(0,W.f)(),Y=(0,P.C)(),Q=(0,P.C)(),X=(0,O.jsxs)(_.A,{hover:!0,selected:o,children:[(0,O.jsx)(w.A,{align:"center",children:c}),!d&&(0,O.jsx)(w.A,{align:"center",children:N?null===p||void 0===p||null===(n=p.employee)||void 0===n?void 0:n.name_arabic:null===p||void 0===p||null===(l=p.employee)||void 0===l?void 0:l.name_english}),(0,O.jsx)(w.A,{align:"center",children:(0,L.ts)(v)}),(0,O.jsx)(w.A,{align:"center",children:(0,L.ts)(h)}),(0,O.jsx)(w.A,{align:"center",children:(0,L.lU)(m)}),(0,O.jsx)(w.A,{align:"center",children:x}),(0,O.jsx)(w.A,{align:"center",children:y}),(0,O.jsx)(w.A,{align:"center",children:j}),(0,O.jsx)(w.A,{align:"center",children:g}),(0,O.jsx)(w.A,{align:"center",children:b}),(0,O.jsx)(w.A,{align:"center",children:z}),(0,O.jsx)(w.A,{align:"center",children:V}),(0,O.jsx)(w.A,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,O.jsx)(C.A,{color:J.open?"inherit":"default",onClick:J.onOpen,children:(0,O.jsx)(S.A,{icon:"eva:more-vertical-fill"})})})]});return(0,O.jsxs)(O.Fragment,{children:[X,(0,O.jsxs)(W.A,{open:J.open,onClose:J.onClose,arrow:"right-top",sx:{width:140},children:[(0,O.jsxs)(f.A,{lang:"ar",onClick:K.onOpen,children:[(0,O.jsx)(S.A,{icon:"carbon:data-quality-definition"}),G("DDL")]}),U({category:"unit_service",subcategory:"hr",acl:"update"})&&(0,O.jsxs)(f.A,{lang:"ar",onClick:Q.onTrue,children:[(0,O.jsx)(S.A,{icon:"fluent:edit-32-filled"}),G("Edit")]}),U({category:"unit_service",subcategory:"hr",acl:"delete"})&&(0,O.jsxs)(f.A,{sx:{color:"error.main"},lang:"ar",onClick:Y.onTrue,children:[(0,O.jsx)(S.A,{icon:"mdi:trash"}),G("Delete")]})]}),(0,O.jsx)(R.A,{row:i,refetch:s,open:Q.value,onClose:Q.onFalse}),(0,O.jsxs)(W.A,{open:K.open,onClose:K.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,O.jsxs)(A.A,{sx:{fontWeight:600},children:[G("creation time"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,O.jsx)(k.A,{primary:(0,L.ts)(I,"dd MMMMMMMM yyyy"),secondary:(0,L.ts)(I,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("created by"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===F||void 0===F?void 0:F.email}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("created by IP"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:T}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("editing time"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,O.jsx)(k.A,{primary:(0,L.ts)(B,"dd MMMMMMMM yyyy"),secondary:(0,L.ts)(B,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("editor"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===E||void 0===E?void 0:E.email}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("editor IP"),":"]}),(0,O.jsx)(A.A,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:$}),(0,O.jsxs)(A.A,{sx:{pt:1,fontWeight:600},children:[G("modifications no"),": ",Z]})]}),(0,O.jsx)(q.T,{open:Y.value,onClose:Y.onFalse,title:G("Deleting Report"),content:G("Are you sure to delete this?"),action:(0,O.jsx)(D.A,{variant:"contained",color:"error",onClick:()=>{J.onClose(),Y.onFalse(),t(i._id)},children:G("Delete")})})]})}var F=l(52369),T=l(99812);const B={name:""};function E(e){let{employee:n}=e;const{t:l}=(0,u.WD)(),A=[{id:"code",label:l("number")},...n?[]:[{id:"employee_engagement",label:l("employee name")}],{id:"start_date",label:l("Start Date")},{id:"end_date",label:l("End Date")},{id:"working_time",label:l("Working hours")},{id:"annual",label:l("annual days off")},{id:"sick",label:l("sick days off")},{id:"unpaid",label:l("unpaid days off")},{id:"public",label:l("public days off")},{id:"other",label:l("other days off")},{id:"salary",label:l("salary")},{id:"total",label:l("total")},{id:"",width:88}].filter(Boolean),f=(0,v.K2)({defaultOrderBy:"code"}),_=(0,i.useRef)(),{enqueueSnackbar:w}=(0,h.dh)(),C=(0,c.rd)(),[k,D]=(0,i.useState)(B),{reportsData:P,refetch:L,loading:M,hours:S,annual:q,sick:W,unpaid:R,salary:E,total:$,other:Z,public:z,ids:V}=function(e){const n=[y.vZ.monthlyReport.all,{params:e}],{data:l,isLoading:o,error:a,isValidating:t}=(0,g.Ay)(n,y.GO);return{...(0,i.useMemo)((()=>({reportsData:(null===l||void 0===l?void 0:l.data)||[],hasMore:null===l||void 0===l?void 0:l.hasMore,annual:null===l||void 0===l?void 0:l.annual,sick:null===l||void 0===l?void 0:l.sick,unpaid:null===l||void 0===l?void 0:l.unpaid,other:null===l||void 0===l?void 0:l.other,public:null===l||void 0===l?void 0:l.public,hours:null===l||void 0===l?void 0:l.hours,salary:null===l||void 0===l?void 0:l.salary,total:null===l||void 0===l?void 0:l.total,ids:(null===l||void 0===l?void 0:l.ids)||[],loading:o,error:a,validating:t,empty:!o&&!(null!==l&&void 0!==l&&l.length)})),[l,a,o,t]),refetch:async()=>{await(0,j.j)(n)}}}({populate:[{path:"employee_engagement",select:"employee",populate:{path:"employee",select:"name_english name_arabic"}}],employee_engagement:n,startDate:null===k||void 0===k?void 0:k.startDate,endDate:null===k||void 0===k?void 0:k.endDate,reported:0}),G=!(!k.startDate||!k.endDate)&&k.startDate.getTime()>k.endDate.getTime(),U=function(e){var n;let{inputData:l,comparator:i,filters:o,dateError:a}=e;const{name:t}=o,r=null===(n=l)||void 0===n?void 0:n.map(((e,n,l)=>[e,n]));r.sort(((e,n)=>{const l=i(e[0],n[0]);return 0!==l?l:e[1]-n[1]})),l=r.map(((e,n)=>e[0])),t&&(l=l.filter((e=>{var n,l,i,o,a,r,d,s,c,u,p,v,h,m,x,y,g,j,b,A,f,_,w,C,k,D,P,L,M,S,q,W,R,O,I,F,T,B,E,$,Z,z;return(null===e||void 0===e||null===(n=e.employee)||void 0===n?void 0:n.name_english)&&-1!==(null===e||void 0===e||null===(l=e.employee)||void 0===l||null===(i=l.name_english)||void 0===i?void 0:i.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(o=e.employee)||void 0===o?void 0:o.name_arabic)&&-1!==(null===e||void 0===e||null===(a=e.employee)||void 0===a||null===(r=a.name_arabic)||void 0===r?void 0:r.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(d=e.employee)||void 0===d?void 0:d.name_english)&&-1!==(null===e||void 0===e||null===(s=e.employee)||void 0===s||null===(c=s.name_english)||void 0===c?void 0:c.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(u=e.employee)||void 0===u||null===(p=u.country)||void 0===p?void 0:p.name_english)&&-1!==(null===e||void 0===e||null===(v=e.employee)||void 0===v||null===(h=v.country)||void 0===h||null===(m=h.name_english)||void 0===m?void 0:m.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(x=e.employee)||void 0===x||null===(y=x.country)||void 0===y?void 0:y.name_arabic)&&-1!==(null===e||void 0===e||null===(g=e.employee)||void 0===g||null===(j=g.country)||void 0===j||null===(b=j.name_arabic)||void 0===b?void 0:b.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(A=e.employee)||void 0===A||null===(f=A.city)||void 0===f?void 0:f.name_english)&&-1!==(null===e||void 0===e||null===(_=e.employee)||void 0===_||null===(w=_.city)||void 0===w||null===(C=w.name_english)||void 0===C?void 0:C.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(k=e.employee)||void 0===k||null===(D=k.city)||void 0===D?void 0:D.name_arabic)&&-1!==(null===e||void 0===e||null===(P=e.employee)||void 0===P||null===(L=P.city)||void 0===L||null===(M=L.name_arabic)||void 0===M?void 0:M.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(S=e.employee)||void 0===S||null===(q=S.nationality)||void 0===q?void 0:q.name_english)&&-1!==(null===e||void 0===e||null===(W=e.employee)||void 0===W||null===(R=W.nationality)||void 0===R||null===(O=R.name_english)||void 0===O?void 0:O.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===(I=e.employee)||void 0===I||null===(F=I.nationality)||void 0===F?void 0:F.name_arabic)&&-1!==(null===e||void 0===e||null===(T=e.employee)||void 0===T||null===(B=T.nationality)||void 0===B||null===(E=B.name_arabic)||void 0===E?void 0:E.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e||null===($=e.employee)||void 0===$?void 0:$.email)&&-1!==(null===e||void 0===e||null===(Z=e.employee)||void 0===Z||null===(z=Z.email)||void 0===z?void 0:z.toLowerCase().indexOf(t.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===t||JSON.stringify(e.code)===t})));return l}({inputData:P,comparator:(0,v.hz)(f.order,f.orderBy),filters:k,dateError:G}),H=!(null===k||void 0===k||!k.name),N=!U.length&&H||!U.length,J=(0,i.useCallback)(((e,n)=>{f.onResetPage(),D((l=>({...l,[e]:n})))}),[f]),K=(0,i.useCallback)((e=>{C.push(s.f.unitservice.hr.employee(e))}),[C]),Y=(0,i.useCallback)((()=>{D(B)}),[]),Q=(0,i.useCallback)((async e=>{try{await y.Ay.delete(y.vZ.monthlyReport.one(e)),L()}catch(n){console.log("error",n),w(null===n||void 0===n?void 0:n.message,{variant:"error"})}}),[w,L]);return M?(0,O.jsx)(b.x,{}):(0,O.jsxs)(t.A,{maxWidth:"xl",children:[(0,O.jsxs)(m.A,{direction:{md:"row"},justifyContent:"space-around",mb:2,children:[(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("working hours"),":"]}),(0,O.jsx)(x.A,{children:S>60?`${Math.floor(S/60)} ${l("hr")} : ${(S%60).toString().padStart(2,"0")} ${l("min")}`:`${S} ${l("min")}`})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("annual days off"),":"]}),(0,O.jsx)(x.A,{children:q})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("sick days off"),":"]}),(0,O.jsx)(x.A,{children:W})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("unpaid days off"),":"]}),(0,O.jsx)(x.A,{children:R})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("public days off"),":"]}),(0,O.jsx)(x.A,{children:z})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("other days off"),":"]}),(0,O.jsx)(x.A,{children:Z})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("salary"),":"]}),(0,O.jsx)(x.A,{children:E})]}),(0,O.jsxs)(m.A,{alignItems:"center",direction:"row",gap:1,children:[(0,O.jsxs)(x.A,{children:[l("total"),":"]}),(0,O.jsx)(x.A,{children:$})]})]}),(0,O.jsxs)(o.A,{children:[(0,O.jsx)(F.A,{filters:k,onFilters:J,monthly:!0,hours:S,annual:q,sick:W,unpaid:R,other:Z,ids:V,publicHolidays:z,refetch:L,canReset:H,onResetFilters:Y}),H&&(0,O.jsx)(T.A,{filters:k,onFilters:J,onResetFilters:Y,results:U.length,sx:{p:2.5,pt:0}}),(0,O.jsxs)(d.A,{children:[(0,O.jsx)(v.Uv,{dense:f.dense,numSelected:f.selected.length,rowCount:U.length,color:U.filter((e=>f.selected.includes(e._id))).some((e=>"inactive"===e.status))?"primary":"error"}),(0,O.jsx)(p.A,{children:(0,O.jsxs)(a.A,{ref:_,size:f.dense?"small":"medium",children:[(0,O.jsx)(v.er,{order:f.order,orderBy:f.orderBy,headLabel:A,rowCount:U.length,numSelected:f.selected.length,onSort:f.onSort}),(0,O.jsxs)(r.A,{children:[U.slice(f.page*f.rowsPerPage,f.page*f.rowsPerPage+f.rowsPerPage).map(((e,l)=>(0,O.jsx)(I,{row:e,filters:k,setFilters:D,selected:f.selected.includes(e._id),onSelectRow:()=>f.onSelectRow(e._id),onViewRow:()=>K(e._id),onDeleteRow:()=>Q(e._id),hideEmployee:!!n,refetch:L},l))),(0,O.jsx)(v.Sm,{notFound:N})]})]})})]}),(0,O.jsx)(v.We,{count:U.length,page:f.page,rowsPerPage:f.rowsPerPage,onPageChange:f.onChangePage,onRowsPerPageChange:f.onChangeRowsPerPage,dense:f.dense,onChangeDense:f.onChangeDense})]})]})}}}]);
//# sourceMappingURL=77756.442f4a06.chunk.js.map
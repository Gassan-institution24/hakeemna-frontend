"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[574],{10574:(e,n,l)=>{l.r(n),l.d(n,{default:()=>ne});var i=l(6907),o=l(27031),a=l(72791),r=l(61474),s=l(2101),t=l(12065),d=l(57621),c=l(79836),u=l(13838),v=l(89164),h=l(53382),g=l(82626),x=l(39281),m=l(4419),p=l(38072),j=(l(19208),l(8976)),w=(l(22459),l(61146)),f=l(34045),_=l(64802),b=l(84954),Z=l(40268),C=l(10261),y=(l(77008),l(25279)),P=l(73379),k=l(38062),D=l(99116),S=l(89731),R=l(6385),F=l(24845),L=l(51642),T=l(6965),W=(l(84802),l(79572)),I=l(76932),O=l(52007),H=l.n(O),q=l(9195),A=l(68745),B=l(13400),M=l(80184);function z(e){let{row:n,onDeleteRow:l,setFilters:i,filters:o}=e;const{code:a,name_english:r,name_arabic:s,type:t,status:d,webpage:c,phone:u,address:v,created_at:h,user_creation:g,ip_address_user_creation:x,updated_at:m,user_modification:p,ip_address_user_modification:j,modifications_nums:w}=n,{t:f}=(0,I.qM)(),{currentLang:_}=(0,I.nt)(),C="ar"===_.value,y=((0,F.S)(),(0,F.S)(),(0,M.jsxs)(q.Z,{hover:!0,children:[(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:a}),(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:C?s:r}),(0,M.jsx)(A.Z,{align:"center",onClick:()=>i({...o,name:null===t||void 0===t?void 0:t.name_english}),children:C?null===t||void 0===t?void 0:t.name_arabic:null===t||void 0===t?void 0:t.name_english}),(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:(0,M.jsx)(b.Z,{lang:"ar",variant:"soft",color:("active"===d?"success":"inactive"===d&&"error")||"default",children:f(d)})}),(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:c}),(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:u}),(0,M.jsx)(A.Z,{lang:"ar",align:"center",children:v}),(0,M.jsx)(A.Z,{lang:"ar",align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,M.jsx)(B.Z,{sx:{color:"error.main"},onClick:l,children:(0,M.jsx)(Z.Z,{icon:"mi:delete"})})})]}));return(0,M.jsx)(M.Fragment,{children:y})}z.propTypes={setFilters:H().func,onDeleteRow:H().func,row:H().object,filters:H().object};var E=l(36314),U=l(48550),G=l(63466);function K(e){let{filters:n,onFilters:l,onPrint:i,onDownload:o,canReset:r,onResetFilters:s}=e;const t=(0,F.S)(),{t:d}=(0,I.qM)(),c=(0,a.useCallback)((e=>{l("name",e.target.value)}),[l]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(E.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,M.jsxs)(E.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[(0,M.jsx)(U.Z,{fullWidth:!0,value:n.name,onChange:c,placeholder:d("Search name or number..."),InputProps:{startAdornment:(0,M.jsx)(G.Z,{position:"start",children:(0,M.jsx)(Z.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),(0,M.jsx)(B.Z,{onClick:t.onOpen,children:(0,M.jsx)(Z.Z,{icon:"eva:more-vertical-fill"})})]}),r&&(0,M.jsx)(u.Z,{color:"error",sx:{flexShrink:0},onClick:s,startIcon:(0,M.jsx)(Z.Z,{icon:"solar:trash-bin-trash-bold"}),children:d("clear")})]}),(0,M.jsxs)(F.Z,{open:t.open,onClose:t.onClose,arrow:"right-top",sx:{width:140},children:[(0,M.jsxs)(g.Z,{onClick:()=>{i(),t.onClose()},children:[(0,M.jsx)(Z.Z,{icon:"solar:printer-minimalistic-bold"}),d("print")]}),(0,M.jsxs)(g.Z,{onClick:()=>{o(),t.onClose()},children:[(0,M.jsx)(Z.Z,{icon:"solar:import-bold"}),"Import"]})]})]})}var N=l(68870),Q=l(85771),V=l(27938),$=l(2540);function J(e){let{filters:n,onFilters:l,onResetFilters:i,results:o,...a}=e;const{t:r}=(0,I.qM)(),s=(0,$.l2)(n.startDate,n.endDate);return(0,M.jsxs)(E.Z,{spacing:1.5,...a,children:[(0,M.jsxs)(N.Z,{sx:{typography:"body2"},children:[(0,M.jsx)("strong",{children:o}),(0,M.jsx)(N.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:r("results found")})]}),(0,M.jsxs)(E.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:["all"!==n.status&&(0,M.jsx)(Y,{label:r("status:"),children:(0,M.jsx)(Q.Z,{size:"small",label:r(n.status),onDelete:()=>{l("status","all")}})}),n.startDate&&n.endDate&&(0,M.jsx)(Y,{label:r("date:"),children:(0,M.jsx)(Q.Z,{size:"small",label:s,onDelete:()=>{l("startDate",null),l("endDate",null)}})}),(0,M.jsx)(u.Z,{color:"error",onClick:i,startIcon:(0,M.jsx)(Z.Z,{icon:"solar:trash-bin-trash-bold"}),children:r("clear")})]})]})}function Y(e){let{label:n,children:l,sx:i,...o}=e;return(0,M.jsxs)(E.Z,{component:V.Z,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...i},...o,children:[(0,M.jsx)(N.Z,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,M.jsx)(E.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:l})]})}const X={name:"",status:"all"};function ee(){var e,n,l;const{t:i}=(0,I.qM)(),{currentLang:O}=(0,I.nt)(),H="ar"===O.value,q=[{id:"code",label:i("code")},{id:"name_english",label:i("name")},{id:"type",label:i("type")},{id:"status",label:i("status")},{id:"webpage",label:i("webpage")},{id:"phone",label:i("phone")},{id:"address",label:i("address")},{id:"",width:88}],{STATUS_OPTIONS:A}=(0,L.D)(),B=(0,k.x6)({defaultOrderBy:"code"}),E=(0,a.useRef)(),U=(0,F.S)(),G=(0,y.K$)(),{user:N}=(0,j.E)(),[Q,V]=(0,a.useState)(X),{insuranseCosData:$,loading:Y}=(0,W.Vc)(),{data:ee,refetch:ne}=(0,W.V5)(null===N||void 0===N||null===(e=N.employee)||void 0===e||null===(n=e.employee_engagements[null===N||void 0===N?void 0:N.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id),le=$.filter((e=>{var n;return!(null!==ee&&void 0!==ee&&null!==(n=ee.insurance)&&void 0!==n&&n.some((n=>n._id===e._id)))})).filter((e=>"active"===e.status)),ie=!(!Q.startDate||!Q.endDate)&&Q.startDate.getTime()>Q.endDate.getTime(),oe=function(e){var n;let{inputData:l,comparator:i,filters:o,dateError:a}=e;const{status:r,name:s}=o,t=null===(n=l)||void 0===n?void 0:n.map(((e,n)=>[e,n]));null===t||void 0===t||t.sort(((e,n)=>{const l=i(e[0],n[0]);return 0!==l?l:e[1]-n[1]})),l=null===t||void 0===t?void 0:t.map((e=>e[0])),s&&(l=l.filter((e=>{var n,l,i,o,a,r,t,d;return(null===e||void 0===e?void 0:e.name_english)&&-1!==(null===e||void 0===e||null===(n=e.name_english)||void 0===n?void 0:n.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e?void 0:e.name_arabic)&&-1!==(null===e||void 0===e||null===(l=e.name_arabic)||void 0===l?void 0:l.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e||null===(i=e.type)||void 0===i?void 0:i.name_english)&&-1!==(null===e||void 0===e||null===(o=e.type)||void 0===o||null===(a=o.name_english)||void 0===a?void 0:a.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e||null===(r=e.type)||void 0===r?void 0:r.name_arabic)&&-1!==(null===e||void 0===e||null===(t=e.type)||void 0===t||null===(d=t.name_arabic)||void 0===d?void 0:d.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===s||JSON.stringify(e.code)===s})));"all"!==r&&(l=l.filter((e=>e.status===r)));return l}({inputData:null===ee||void 0===ee?void 0:ee.insurance,comparator:(0,k.sQ)(B.order,B.orderBy),filters:Q,dateError:ie}),ae=null===oe||void 0===oe?void 0:oe.slice(B.page*B.rowsPerPage,B.page*B.rowsPerPage+B.rowsPerPage),re=B.dense?52:72,se=!(null===Q||void 0===Q||!Q.name)||"all"!==Q.status,te=!(null!==oe&&void 0!==oe&&oe.length)&&se||!(null!==oe&&void 0!==oe&&oe.length),de=(0,w.useReactToPrint)({content:()=>E.current}),ce=(0,a.useCallback)((async e=>{try{const n=[...ee.insurance,e];await(0,R.Z)({method:"PATCH",path:S.Hv.tables.unitservice(null===ee||void 0===ee?void 0:ee._id),data:{insurance:n}}),D.W.emit("updated",{user:N,link:p.H.unitservice.insurance.root,msg:"added an insurance"})}catch(n){D.W.emit("error",{error:n,user:N,location:window.location.href}),console.error(n)}ne(),B.onUpdatePageDeleteRow(null===ae||void 0===ae?void 0:ae.length)}),[null===ae||void 0===ae?void 0:ae.length,B,ne,null===ee||void 0===ee?void 0:ee._id,null===ee||void 0===ee?void 0:ee.insurance,N]),ue=(0,a.useCallback)((async e=>{try{var n;const l=null===ee||void 0===ee||null===(n=ee.insurance)||void 0===n?void 0:n.filter((n=>(null===n||void 0===n?void 0:n._id)!==e));await(0,R.Z)({method:"PATCH",path:S.Hv.tables.unitservice(null===ee||void 0===ee?void 0:ee._id),data:{insurance:l}}),D.W.emit("updated",{user:N,link:p.H.unitservice.insurance.root,msg:"removed an insurance"})}catch(l){D.W.emit("error",{error:l,user:N,location:window.location.href}),console.error(l)}ne(),B.onUpdatePageDeleteRow(null===ae||void 0===ae?void 0:ae.length)}),[null===ae||void 0===ae?void 0:ae.length,B,ne,null===ee||void 0===ee?void 0:ee._id,null===ee||void 0===ee?void 0:ee.insurance,N]),ve=(0,a.useCallback)(((e,n)=>{B.onResetPage(),V((l=>({...l,[e]:n})))}),[B]),he=(0,a.useCallback)((()=>{V(X)}),[]),ge=(0,a.useCallback)(((e,n)=>{ve("status",n)}),[ve]);return Y?(0,M.jsx)(T.a,{}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(v.Z,{maxWidth:!G.themeStretch&&"lg",children:[(0,M.jsx)(P.Z,{heading:i("insurance"),links:[{name:i("dashboard"),href:p.H.unitservice.root},{name:i("insurance")}],action:(0,o.Z)({category:"unit_service",subcategory:"insurance",acl:"create"})&&(0,M.jsx)(u.Z,{component:m.r,onClick:U.onOpen,variant:"contained",startIcon:(0,M.jsx)(Z.Z,{icon:"mingcute:add-line"}),children:i("new insurance")}),sx:{mb:{xs:3,md:5}}}),(0,M.jsxs)(d.Z,{children:[(0,M.jsx)(s.Z,{value:Q.status,onChange:ge,sx:{px:2.5,boxShadow:e=>"inset 0 -2px 0 0 ".concat((0,t.Fq)(e.palette.grey[500],.08))},children:A.map((e=>{var n;return(0,M.jsx)(r.Z,{iconPosition:"end",value:e.value,label:e.label,icon:(0,M.jsxs)(b.Z,{lang:"ar",variant:"all"===e.value||e.value===Q.status?"filled":"soft",color:("active"===e.value?"success":"inactive"===e.value&&"error")||"default",children:["all"===e.value&&(null===ee||void 0===ee||null===(n=ee.insurance)||void 0===n?void 0:n.length),"active"===e.value&&(null===ee||void 0===ee?void 0:ee.insurance.filter((e=>"active"===e.status)).length),"inactive"===e.value&&(null===ee||void 0===ee?void 0:ee.insurance.filter((e=>"inactive"===e.status)).length)]})},e.value)}))}),(0,M.jsx)(K,{onPrint:de,filters:Q,onFilters:ve,onDownload:()=>{const e=null===oe||void 0===oe?void 0:oe.reduce(((e,n)=>{var l,i;return e.push({code:n.code,name:n.name_english,category:null===(l=n.category)||void 0===l?void 0:l.name_english,symptoms:null===(i=n.symptoms)||void 0===i?void 0:i.map((e=>null===e||void 0===e?void 0:e.name_english))}),e}),[]),n=f.P6.book_new(),l=f.P6.json_to_sheet(e);f.P6.book_append_sheet(n,l,"Sheet 1");const i=f.cW(n,{bookType:"xlsx",type:"array"}),o=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,_.saveAs)(o,"unitservicesTable.xlsx")},canReset:se,onResetFilters:he}),se&&(0,M.jsx)(J,{filters:Q,onFilters:ve,onResetFilters:he,results:null===oe||void 0===oe?void 0:oe.length,sx:{p:2.5,pt:0}}),(0,M.jsx)(x.Z,{children:(0,M.jsx)(C.Z,{children:(0,M.jsxs)(c.Z,{ref:E,size:B.dense?"small":"medium",children:[(0,M.jsx)(k.K,{order:B.order,orderBy:B.orderBy,headLabel:q,rowCount:null===oe||void 0===oe?void 0:oe.length,numSelected:B.selected.length,onSort:B.onSort}),(0,M.jsxs)(h.Z,{children:[null===oe||void 0===oe||null===(l=oe.slice(B.page*B.rowsPerPage,B.page*B.rowsPerPage+B.rowsPerPage))||void 0===l?void 0:l.map((e=>(0,M.jsx)(z,{row:e,filters:Q,setFilters:V,onSelectRow:()=>B.onSelectRow(null===e||void 0===e?void 0:e._id),onDeleteRow:()=>ue(null===e||void 0===e?void 0:e._id)},null===e||void 0===e?void 0:e._id))),(0,M.jsx)(k.$W,{height:re,emptyRows:(0,k.fQ)(B.page,B.rowsPerPage,null===ee||void 0===ee?void 0:ee.insurance.length)}),(0,M.jsx)(k.et,{notFound:te})]})]})})}),(0,M.jsx)(k.S_,{count:null===oe||void 0===oe?void 0:oe.length,page:B.page,rowsPerPage:B.rowsPerPage,onPageChange:B.onChangePage,onRowsPerPageChange:B.onChangeRowsPerPage,dense:B.dense,onChangeDense:B.onChangeDense})]})]}),(0,M.jsx)(F.Z,{open:U.open,onClose:U.onClose,arrow:"right-top",children:(0,M.jsx)("div",{style:{maxHeight:"150px",overflowY:"auto",scrollbarWidth:"thin",scrollbarColor:"darkgray lightgray"},children:null===le||void 0===le?void 0:le.map((e=>(0,M.jsx)(g.Z,{onClick:()=>ce(e._id),children:H?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english})))})})]})}function ne(){return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(o.Z,{hasContent:!0,category:"unit_service",subcategory:"insurance",acl:"read",children:[(0,M.jsx)(i.ql,{children:(0,M.jsx)("title",{children:"Insurances"})}),(0,M.jsx)(ee,{})]})})}}}]);
//# sourceMappingURL=574.8fb6e431.chunk.js.map
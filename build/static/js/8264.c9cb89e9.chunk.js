"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[8264],{38563:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(68870),i=a(50533),r=a(36314),s=a(4567),l=a(93517),o=a(4419),d=a(80184);function c(e){let{link:n,activeLast:a,disabled:r}=e;const s={typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex",...r&&!a&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}},l=(0,d.jsxs)(d.Fragment,{children:[n.icon&&(0,d.jsx)(t.Z,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:n.icon}),n.name]});return n.href?(0,d.jsx)(i.Z,{component:o.r,href:n.href,sx:s,children:l}):(0,d.jsxs)(t.Z,{sx:s,children:[" ",l," "]})}function m(e){let{links:n,action:a,heading:o,moreLink:m,activeLast:p,sx:h,...g}=e;const v=n&&n[n.length-1].name;return(0,d.jsxs)(t.Z,{sx:{...h},children:[(0,d.jsxs)(r.Z,{direction:"row",alignItems:"center",children:[(0,d.jsxs)(t.Z,{sx:{flexGrow:1,display:"flex",gap:3,alignItems:"center"},children:[o&&(0,d.jsx)(s.Z,{variant:"h4",gutterBottom:!0,children:o}),n&&!!n.length&&(0,d.jsx)(l.Z,{separator:(0,d.jsx)(u,{}),...g,children:null===n||void 0===n?void 0:n.map((e=>(0,d.jsx)(c,{link:e,activeLast:p,disabled:e.name===v},e.name||"")))})]}),a&&(0,d.jsxs)(t.Z,{sx:{flexShrink:0},children:[" ",a," "]})]}),!!m&&(0,d.jsx)(t.Z,{sx:{mt:2},children:m.map((e=>(0,d.jsx)(i.Z,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}function u(){return(0,d.jsx)(t.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}},73379:(e,n,a)=>{a.d(n,{Z:()=>t.Z});var t=a(38563)},78264:(e,n,a)=>{a.r(n),a.d(n,{default:()=>u});var t=a(6907),i=a(89164),r=a(38072),s=a(76932),l=a(25279),o=a(73379),d=a(86579),c=a(80184);function m(){const e=(0,l.K$)(),{t:n}=(0,s.qM)();return(0,c.jsxs)(i.Z,{maxWidth:!e.themeStretch&&"lg",children:[(0,c.jsx)(o.Z,{heading:n("create a new work group"),links:[{name:n("dashboard"),href:r.H.unitservice.root},{name:n("work groups"),href:r.H.unitservice.tables.workgroups.root},{name:n("new")}],sx:{mb:{xs:3,md:5}}}),(0,c.jsx)(d.Z,{})]})}function u(){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.ql,{children:(0,c.jsx)("title",{children:"New Work Group"})}),(0,c.jsx)(m,{})]})}},86579:(e,n,a)=>{a.d(n,{Z:()=>C});var t=a(8007),i=a(763),r=a(72791),s=a(61134),l=a(44695),o=a(68870),d=a(57621),c=a(85771),m=a(36314),u=a(82626),p=a(24308),h=a(12258),g=a(38072),v=a(19208),_=a(99116),x=a(89731),b=a(32869),y=a(29028),f=a(31243),Z=a(8976),j=a(6385),k=a(76932),w=a(79572),q=a(80184);function C(e){var n,a,C,S,H,I,E,T,V,L;let{currentTable:W}=e;const D=(0,v.tv)(),{t:F}=(0,k.qM)(),{currentLang:P}=(0,k.nt)(),$="ar"===P.value,{user:A}=(0,Z.E)(),{employeesData:G}=(0,w.Y3)(null===A||void 0===A||null===(n=A.employee)||void 0===n||null===(a=n.employee_engagements)||void 0===a||null===(C=a[null===A||void 0===A||null===(H=A.employee)||void 0===H?void 0:H.selected_engagement])||void 0===C||null===(S=C.unit_service)||void 0===S?void 0:S._id),{departmentsData:O}=(0,w.T8)(null===A||void 0===A||null===(I=A.employee)||void 0===I||null===(E=I.employee_engagements)||void 0===E||null===(T=E[null===A||void 0===A||null===(L=A.employee)||void 0===L?void 0:L.selected_engagement])||void 0===T||null===(V=T.unit_service)||void 0===V?void 0:V._id),[z,M]=(0,r.useState)([]),{enqueueSnackbar:N}=(0,b.Ds)(),B=t.Ry().shape({department:t.Z_().required("department is required"),name_arabic:t.Z_().required("Name is required"),name_english:t.Z_().required("Name is required"),employees:t.IX().min(1,"Choose at least one option")}),R=(0,r.useMemo)((()=>{var e,n,a;return{unit_service:null===A||void 0===A||null===(e=A.employee)||void 0===e||null===(n=e.employee_engagements[null===A||void 0===A?void 0:A.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id,department:(null===W||void 0===W||null===(a=W.department)||void 0===a?void 0:a._id)||null,name_arabic:(null===W||void 0===W?void 0:W.name_arabic)||"",name_english:(null===W||void 0===W?void 0:W.name_english)||"",employees:(null===W||void 0===W?void 0:W.employees)||[]}}),[W,null===A||void 0===A?void 0:A.employee]),X=(0,s.cI)({resolver:(0,l.X)(B),defaultValues:R}),{reset:K,handleSubmit:Y,formState:{isSubmitting:J}}=X,Q=Y((async e=>{try{const n=await f.Z.get("https://geolocation-db.com/json/");W?(await(0,j.Z)({method:"PATCH",path:x.Hv.tables.workgroup(W._id),data:{modifications_nums:(W.modifications_nums||0)+1,ip_address_user_modification:n.data.IPv4,user_modification:A._id,...e}}),_.W.emit("updated",{user:A,link:g.H.unitservice.tables.workgroups.root,msg:"updated a work group <strong>".concat(e.name_english,"</strong>")})):(await(0,j.Z)({method:"POST",path:x.Hv.tables.workgroups,data:{ip_address_user_creation:n.data.IPv4,user_creation:A._id,...e}}),_.W.emit("created",{user:A,link:g.H.unitservice.tables.workgroups.root,msg:"created a work group <strong>".concat(e.name_english,"</strong>")})),K(),N(F(W?"update success!":"create success!")),D.push(g.H.unitservice.tables.workgroups.root),console.info("DATA",e)}catch(n){_.W.emit("error",{error:n,user:A,location:window.location.href}),console.error(n)}}));return(0,q.jsx)(y.ZP,{methods:X,onSubmit:Q,children:(0,q.jsx)(p.Z,{xs:12,maxWidth:"md",children:(0,q.jsxs)(d.Z,{sx:{p:3},children:[(0,q.jsxs)(o.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,q.jsx)(y.au,{lang:"ar",onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%]*$/.test(e.target.value)&&X.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(F("name english")," *")}),(0,q.jsx)(y.au,{lang:"ar",onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_-]*$/.test(e.target.value)&&X.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(F("name arabic")," *")}),(0,q.jsx)(y.Cc,{name:"department",label:F("department"),children:O.map((e=>(0,q.jsx)(u.Z,{value:e._id,children:$?e.name_arabic:e.name_english},e._id)))}),(0,q.jsx)(y.Fl,{name:"employees",label:"".concat(F("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:G.filter((e=>!z.some((n=>(0,i.isEqual)(e,n))))),getOptionLabel:e=>e._id,renderOption:(e,n)=>(0,r.createElement)("li",{...e,key:n._id,value:n._id},n.employee.first_name," ",n.employee.middle_name," ",n.employee.family_name),onChange:(e,n)=>{M(n),X.setValue("employees",n,{shouldValidate:!0})},renderTags:(e,n)=>e.map(((e,a)=>(0,r.createElement)(c.Z,{...n({index:a}),key:e._id,label:e.employee.first_name,size:"small",color:"info",variant:"soft"})))})]}),(0,q.jsx)(m.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,q.jsx)(h.Z,{type:"submit",variant:"contained",loading:J,children:F(W?"save changes":"create")})})]})})})}},6385:(e,n,a)=>{a.d(n,{Z:()=>s});var t=a(31243),i=a(88329),r=a(33805);async function s(e){let{setData:n,setError:a,method:s,path:l,data:o}=e;const d="".concat(r.E0).concat(l),c=i.Z.get("user_token"),m=await(0,t.Z)({method:s,url:d,headers:{authorization:"Bearer ".concat(c)},data:o});return m.status,n&&n(m.data),m}}}]);
//# sourceMappingURL=8264.c9cb89e9.chunk.js.map
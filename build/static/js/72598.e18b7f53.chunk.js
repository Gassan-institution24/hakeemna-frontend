"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[72598],{72598:(e,n,l)=>{l.d(n,{A:()=>G});var t=l(80899),a=l(24858),i=l(78023),s=l.n(i),o=l(65043),d=l(18403),r=l(12110),m=l(74600),u=l(77224),c=l(38246),p=l(71861),x=l(94496),v=l(81e3),h=l(81637),_=l(48407),g=l(67132),y=l(59229),f=l(31673),j=l(75139),b=l(7625),A=l(60778),w=l(59699),k=l(94857),z=l(70074),S=l(48751),$=l(39336),I=l(94814),C=l(51787),D=l(84284),F=l(5124),T=l(57442),W=l(35151),P=l(70579);function M(e){var n,l,t;let{appointmentConfigData:i,setAppointTime:s}=e;const{t:o}=(0,A.WD)(),{currentLang:d}=(0,A.jc)(),r="ar"===d.value,{id:u}=(0,g.g)(),c=[{value:"saturday",label:o("Saturday")},{value:"sunday",label:o("Sunday")},{value:"monday",label:o("Monday")},{value:"tuesday",label:o("Tuesday")},{value:"wednesday",label:o("Wednesday")},{value:"thursday",label:o("Thursday")},{value:"friday",label:o("Friday")}],{control:p,watch:h,trigger:y}=(0,a.xW)(),f=h(),{myunitTime:k}=(0,T.nM)(),{user:z}=(0,j.Z)(),{handleAddNew:M}=(0,F.I)(),{workGroupsData:q}=(0,b.VnY)(u),{workShiftsData:L}=(0,b.c8d)(null===z||void 0===z||null===(n=z.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(t=l[null===z||void 0===z?void 0:z.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,P.jsxs)(m.A,{sx:{p:3},children:[(0,P.jsxs)(m.A,{spacing:2,direction:{xs:"column",sm:"row"},sx:{p:3,width:{xs:"100%",md:"auto"}},children:[(0,P.jsx)(a.xI,{name:"start_date",control:p,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,P.jsx)(D.l,{label:`${o("start date")} *`,value:k(f.start_date),onChange:e=>{var l,t,a,i,s;const o=(0,S.A)(e,(null===z||void 0===z||null===(l=z.employee)||void 0===l||null===(t=l.employee_engagements)||void 0===t||null===(a=t[null===z||void 0===z?void 0:z.employee.selected_engagement])||void 0===a||null===(i=a.unit_service)||void 0===i||null===(s=i.country)||void 0===s?void 0:s.time_zone)||"Asia/Amman");n.onChange(o)},slotProps:{textField:{fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}}),(0,P.jsx)(a.xI,{name:"end_date",control:p,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,P.jsx)(D.l,{label:o("end date"),value:k(f.end_date),onChange:e=>{var l,t,a,i,s;const o=(0,S.A)(e,(null===z||void 0===z||null===(l=z.employee)||void 0===l||null===(t=l.employee_engagements)||void 0===t||null===(a=t[null===z||void 0===z?void 0:z.employee.selected_engagement])||void 0===a||null===(i=a.unit_service)||void 0===i||null===(s=i.country)||void 0===s?void 0:s.time_zone)||"Asia/Amman");n.onChange(o)},slotProps:{textField:{fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}})]}),(0,P.jsxs)(m.A,{spacing:2,direction:{xs:"column",sm:"row"},sx:{px:3,pb:3,width:{xs:"100%",md:"auto"}},children:[(0,P.jsxs)(w.tX,{size:"small",name:"work_shift",label:`${o("work shift")} *`,InputLabelProps:{shrink:!0},PaperPropsSx:{textTransform:"capitalize"},disabled:Boolean(i),children:[L.map(((e,n)=>(0,P.jsx)(I.A,{lang:"ar",value:e._id,children:r?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},n))),(0,P.jsx)($.A,{}),(0,P.jsxs)(I.A,{lang:"ar",sx:{display:"flex",justifyContent:"flex-end",gap:1,fontWeight:600},onClick:()=>M(_.f.unitservice.tables.workshifts.new),children:[(0,P.jsx)(x.A,{variant:"body2",sx:{color:"info.main"},children:o("Add new")}),(0,P.jsx)(W.A,{icon:"material-symbols:new-window-sharp"})]})]}),(0,P.jsxs)(w.tX,{size:"small",name:"work_group",label:`${o("work group")} *`,InputLabelProps:{shrink:!0},PaperPropsSx:{textTransform:"capitalize"},disabled:Boolean(i),children:[q&&(null===q||void 0===q?void 0:q.map(((e,n)=>(0,P.jsx)(I.A,{lang:"ar",value:e._id,children:r?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},n)))),(0,P.jsx)($.A,{}),(0,P.jsxs)(I.A,{lang:"ar",sx:{display:"flex",justifyContent:"flex-end",gap:1,fontWeight:600},onClick:()=>M(_.f.unitservice.tables.workgroups.new),children:[(0,P.jsx)(x.A,{variant:"body2",sx:{color:"info.main"},children:o("Add new")}),(0,P.jsx)(W.A,{icon:"material-symbols:new-window-sharp"})]})]}),(0,P.jsx)(w.o3,{fullWidth:!0,step:"5",name:"appointment_time",label:o("appointment duration time"),type:"number",onBlur:e=>{s(e.target.value),y("appointment_time")},size:"small",InputLabelProps:{shrink:!0},InputProps:{endAdornment:(0,P.jsx)(C.A,{position:"end",children:(0,P.jsx)(v.A,{sx:{fontSize:"0.8rem"},children:o("min")})})}}),(0,P.jsx)(w.o3,{size:"small",InputProps:{startAdornment:(0,P.jsx)(C.A,{position:"start",children:(0,P.jsx)(v.A,{sx:{fontSize:"0.8rem"},children:r?"\u0644\u0628\u0639\u062f":"for the next"})}),endAdornment:(0,P.jsx)(C.A,{position:"end",children:(0,P.jsx)(v.A,{sx:{fontSize:"0.8rem"},children:r?"\u0623\u064a\u0627\u0645":"days"})})},name:"config_frequency",label:o("available for booking"),type:"number",inputProps:{min:0,max:30,textAlign:"center"},InputLabelProps:{shrink:!0}})]}),(0,P.jsxs)(x.A,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:[r?"\u0627\u0644\u0639\u0637\u0644 \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064a\u0629":"Weekly Days Off",":"]}),(0,P.jsx)(m.A,{spacing:2,direction:{xs:"column",sm:"row"},sx:{p:3},children:(0,P.jsx)(w.lE,{size:"small",name:"weekend",options:c,sx:{display:"grid",gridTemplateColumns:{md:"repeat(7, 1fr)",sm:"repeat(4, 1fr)",xs:"repeat(2, 1fr)"}}})})]})]})}var q=l(49633),L=l(17392);function Y(){const{t:e}=(0,A.WD)(),{currentLang:n}=(0,A.jc)(),l="ar"===n.value,{myunitTime:t}=(0,T.nM)(),{user:i}=(0,j.Z)(),{control:s,watch:o}=(0,a.xW)(),{fields:d,append:r,remove:u}=(0,a.jz)({control:s,name:"holidays"}),c=o();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,P.jsxs)(v.A,{sx:{p:3},children:[(0,P.jsxs)(x.A,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:[l?"\u0627\u0644\u0639\u0637\u0644":"Holidays",":"]}),(0,P.jsx)(m.A,{sx:{mt:3},divider:(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:2,children:d.map(((n,l,o)=>(0,P.jsx)(m.A,{alignItems:"flex-start",spacing:1.5,sx:{width:{xs:"100%",md:"auto"}},children:(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:{xs:"100%",md:"auto"}},children:[(0,P.jsx)(w.o3,{size:"small",name:`holidays[${l}].description`,label:e("description")}),(0,P.jsx)(a.xI,{name:`holidays[${l}].date`,control:s,render:n=>{let{field:a,fieldState:{error:s}}=n;return(0,P.jsx)(D.l,{label:e("date"),value:t(c.holidays[l].date),onChange:e=>{var n,l,t,s,o;const d=(0,S.A)(e,(null===i||void 0===i||null===(n=i.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(t=l[null===i||void 0===i?void 0:i.employee.selected_engagement])||void 0===t||null===(s=t.unit_service)||void 0===s||null===(o=s.country)||void 0===o?void 0:o.time_zone)||"Asia/Amman");a.onChange(d)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!s,helperText:null===s||void 0===s?void 0:s.message}}})}}),(0,P.jsx)(L.A,{sx:{justifySelf:"flex-end",alignSelf:"flex-end",width:35},size:"small",color:"error",onClick:()=>(e=>{u(e)})(l),children:(0,P.jsx)(W.A,{icon:"solar:trash-bin-trash-bold"})})]})},o)))}),(0,P.jsx)($.A,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,P.jsx)(m.A,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,P.jsx)(q.A,{size:"small",color:"primary",startIcon:(0,P.jsx)(W.A,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{r({date:null,description:""})},children:l?"\u0625\u0636\u0627\u0641\u0629 \u0623\u064a\u0627\u0645 \u0639\u0637\u0644":"add holiday"})})]})]})}var E=l(72221),O=l(30279),Z=l(1273),B=l(17642),H=l(53193),N=l(66124);function V(e){var n,l,t,i;let{ParentIndex:s,open:o,appointmenttypesData:d,serviceTypesData:r,setAppointmentsNum:u}=e;const{t:c}=(0,A.WD)(),{currentLang:p}=(0,A.jc)(),h="ar"===p.value,{control:_,watch:g}=(0,a.xW)(),{fields:y,append:f,remove:j}=(0,a.jz)({control:_,name:`days_details[${s}].appointments`}),b=g(),k=e=>{const n=null===r||void 0===r?void 0:r.filter((n=>null===e||void 0===e?void 0:e.includes(n._id)));return null===n||void 0===n?void 0:n.map((e=>h?e.name_arabic:e.name_english)).join(", ")};return(0,P.jsx)(O.A,{in:o,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:(0,P.jsxs)(v.A,{sx:{px:2,pb:0},children:[(null===(n=b.days_details[s])||void 0===n||null===(l=n.appointments)||void 0===l?void 0:l.length)>0&&(0,P.jsxs)(x.A,{variant:"p",sx:{color:"text.disabled",mb:3,fontSize:14},children:[c("appointments"),":"]}),(0,P.jsx)(m.A,{sx:{mt:3},divider:(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,alignItems:"flex-end",children:y.map(((e,n)=>(0,P.jsx)(m.A,{alignItems:"center",flexWrap:"wrap",spacing:1.5,sx:{width:"80%"},children:(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:"100%"},children:[(0,P.jsx)(w.tX,{size:"small",InputLabelProps:{shrink:!0},name:`days_details[${s}].appointments[${n}].appointment_type`,label:`${c("appointment type")} *`,children:null===d||void 0===d?void 0:d.map(((e,n)=>(0,P.jsx)(I.A,{lang:"ar",value:e._id,children:h?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english})))}),(0,P.jsx)(w.MB,{name:`days_details[${s}].appointments[${n}].start_time`,label:c("start time"),slotProps:{textField:{size:"small",fullWidth:!0}}}),(0,P.jsx)(a.xI,{name:`days_details[${s}].appointments[${n}].service_types`,control:_,render:e=>{let{field:l,fieldState:{error:t}}=e;return(0,P.jsxs)(H.A,{error:!!t,size:"small",sx:{width:"100%",shrink:!0},children:[(0,P.jsxs)(B.A,{shrink:!0,children:[" ",c("service types")," "]}),(0,P.jsx)(E.A,{...l,multiple:!0,id:`multiple-days_details[${s}].appointments[${n}].service_types`,label:c("service types"),renderValue:k,children:null===r||void 0===r?void 0:r.map(((e,n)=>{var t;const a=null===l||void 0===l||null===(t=l.value)||void 0===t?void 0:t.includes(e._id);return(0,P.jsxs)(I.A,{lang:"ar",value:e._id,children:[(0,P.jsx)(Z.A,{size:"small",disableRipple:!0,checked:a}),h?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english]},n)}))}),!!t&&(0,P.jsx)(N.A,{error:!!t,children:null===t||void 0===t?void 0:t.message})]})}}),(0,P.jsx)(w.SF,{size:"small",InputLabelProps:{shrink:!0},name:`days_details[${s}].appointments[${n}].online_available`,label:(0,P.jsx)(x.A,{sx:{fontSize:12},children:c("online avaliable")})}),(0,P.jsx)(L.A,{size:"small",color:"error",sx:{justifySelf:{xs:"flex-end"},alignSelf:{xs:"flex-end"},width:35},onClick:()=>(e=>{j(e),u((e=>({...e,[s]:e[s]-1})))})(n),children:(0,P.jsx)(W.A,{icon:"solar:trash-bin-trash-bold"})})]})},n)))}),(0,P.jsx)($.A,{sx:{mt:(null===(t=b.days_details[s])||void 0===t||null===(i=t.appointments)||void 0===i?void 0:i.length)>0?3:0,mb:1,borderStyle:"dashed"}}),(0,P.jsx)(m.A,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,P.jsx)(q.A,{size:"small",color:"primary",startIcon:(0,P.jsx)(W.A,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{const e=b.days_details[s].appointments?b.days_details[s].appointments[b.days_details[s].appointments.length-1]:null,n=new Date(e?null===e||void 0===e?void 0:e.start_time:b.days_details[s].work_start_time);e&&n.setMinutes(n.getMinutes()+b.appointment_time);const l={appointment_type:null,start_time:null,price:null,online_available:!0,service_types:[],...e,start_time:n};f(l),u((e=>({...e,[s]:e[s]+1})))},children:h?"\u0625\u0636\u0627\u0641\u0629 \u0645\u0648\u0627\u0639\u064a\u062f \u0628\u0627\u0644\u062a\u0641\u0635\u064a\u0644":"Add Detailed Appointment"})})]})})}function X(e){let{setErrorMsg:n,appointTime:l}=e;const{t:t}=(0,A.WD)(),{currentLang:i}=(0,A.jc)(),s="ar"===i.value,[d,r]=(0,o.useState)(!0),{enqueueSnackbar:u}=(0,k.dh)(),c=[{value:"saturday",label:t("Saturday")},{value:"sunday",label:t("Sunday")},{value:"monday",label:t("Monday")},{value:"tuesday",label:t("Tuesday")},{value:"wednesday",label:t("Wednesday")},{value:"thursday",label:t("Thursday")},{value:"friday",label:t("Friday")}],{control:p,setValue:h,watch:_,clearErrors:g}=(0,a.xW)(),{fields:f,append:j,remove:z}=(0,a.jz)({control:p,name:"days_details"}),S=_(),[C,D]=(0,o.useState)({}),[F,T]=(0,o.useState)({}),{appointmenttypesData:M}=(0,b.uZ5)(),Y=(0,y.C)(),E=(0,o.useCallback)((e=>{try{if(D({}),Y.onTrue(),g(),!S.appointment_time)return h(`days_details[${e}].appointments`,[]),void Y.onFalse();if(!S.days_details[e].work_start_time)return h(`days_details[${e}].appointments`,[]),void Y.onFalse();if(!S.days_details[e].work_end_time)return h(`days_details[${e}].appointments`,[]),void Y.onFalse();const n=[],l=new Date,t=60*S.appointment_time*1e3,a=S.days_details[e],i=new Date(l.getFullYear(),l.getMonth(),l.getDate(),new Date(a.work_start_time).getHours(),new Date(a.work_start_time).getMinutes()).getTime();let s=new Date(l.getFullYear(),l.getMonth(),l.getDate(),new Date(a.work_end_time).getHours(),new Date(a.work_end_time).getMinutes()).getTime(),o=a.break_start_time?new Date(l.getFullYear(),l.getMonth(),l.getDate(),new Date(a.break_start_time).getHours(),new Date(a.break_start_time).getMinutes()).getTime():null,d=a.break_end_time?new Date(l.getFullYear(),l.getMonth(),l.getDate(),new Date(a.break_end_time).getHours(),new Date(a.break_end_time).getMinutes()).getTime():null;i>=s&&(s+=864e5),o&&i>o&&(o+=864e5),o&&d&&o>d&&(d+=864e5);let r=i;for(;r+t<=s;)!o||!d||r+t<=o||r>=d?(n.push({appointment_type:a.appointment_type,start_time:r,online_available:a.online_available,service_types:a.service_types}),r+=t):r=d;h(`days_details[${e}].appointments`,n),Y.onFalse()}catch(n){console.error(n),Y.onFalse(),u(n.message,{variant:"error"})}}),[S.appointment_time,S.days_details]);function O(e){const n=S.days_details[e];if(null!==n&&void 0!==n&&n.appointments.length)return null===n||void 0===n?void 0:n.appointments.length;const l=60*S.appointment_time*1e3,t=new Date(n.work_start_time).getTime();let a=new Date(n.work_end_time).getTime(),i=new Date(n.break_start_time).getTime(),s=new Date(n.break_end_time).getTime();return t>a&&(a+=864e5),t>i&&(i+=864e5),t>s&&(s+=864e5),t<s&&t<=i&&a>=s&&a>i?Math.floor((a-t-(s-i))/l)||0:t<s&&t<=i&&a<=s&&a>i?Math.floor((a-t-(a-i))/l)||0:Math.floor((a-t)/l)||0}return(0,o.useEffect)((()=>{if(l)for(let e=0;e<S.days_details.length;e++)E(e)}),[l]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"solid"}}),d&&(0,P.jsxs)(v.A,{sx:{p:3},children:[(0,P.jsxs)(x.A,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:[s?"\u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u064a\u0648\u0645":"Days Details",":"]}),(0,P.jsx)(m.A,{sx:{mt:3},divider:(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:f.map(((e,n)=>{var l,a;return(0,P.jsxs)(m.A,{spacing:1.5,sx:{width:"100%"},children:[(0,P.jsxs)(m.A,{direction:{xs:"column",md:"column"},spacing:2,sx:{width:"100%",mt:2},children:[(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:"100%",mt:2},children:[(0,P.jsx)(w.tX,{disabled:!(null!==S&&void 0!==S&&null!==(l=S.weekend)&&void 0!==l&&l.includes(null===(a=S.days_details[n])||void 0===a?void 0:a.day)),InputLabelProps:{shrink:!0},size:"small",name:`days_details[${n}].day`,label:t("day"),children:c.filter((e=>!S.weekend.includes(e.value)&&!S.days_details.some((l=>{var t;return l.day===e.value&&(null===(t=S.days_details[n])||void 0===t?void 0:t.day)!==e.value})))).map(((e,n)=>(0,P.jsx)(I.A,{lang:"ar",value:e.value,children:e.label})))}),(0,P.jsx)(w.tX,{size:"small",InputLabelProps:{shrink:!0},name:`days_details[${n}].appointment_type`,onChange:e=>{h(`days_details[${n}].appointment_type`,e.target.value),E(n)},label:`${t("appointment type")} *`,children:null===M||void 0===M?void 0:M.map(((e,n)=>(0,P.jsx)(I.A,{lang:"ar",value:e._id,children:s?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english})))}),(0,P.jsx)(w.o3,{disabled:!0,size:"small",name:`days_details[${n}].appointment_number`,label:t("appointments number"),InputLabelProps:{shrink:!0},value:F[n]||O(n)})]}),(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:"100%",mt:2},children:[(0,P.jsx)(w.MB,{name:`days_details[${n}].work_start_time`,label:t("work start time"),slotProps:{textField:{size:"small",fullWidth:!0}},onChange:()=>{h(`days_details[${n}].work_end_time`,null),E(n)}}),(0,P.jsx)(w.MB,{name:`days_details[${n}].work_end_time`,label:t("work end time"),slotProps:{textField:{size:"small",fullWidth:!0}},onChange:()=>{E(n)}}),(0,P.jsx)(w.MB,{name:`days_details[${n}].break_start_time`,label:t("break start time"),slotProps:{textField:{size:"small",fullWidth:!0}},onChange:()=>{h(`days_details[${n}].work_end_time`,null),E(n)}}),(0,P.jsx)(w.MB,{name:`days_details[${n}].break_end_time`,label:t("break end time"),slotProps:{textField:{size:"small",fullWidth:!0}},onChange:()=>{E(n)}})]}),(0,P.jsx)(m.A,{display:"flex",alignItems:"flex-end",children:(0,P.jsx)(w.SF,{size:"small",InputLabelProps:{shrink:!0},name:`days_details[${n}].online_available`,onChange:e=>{h(`days_details[${n}].online_available`,!S.days_details[n].online_available),E(n)},label:(0,P.jsx)(x.A,{sx:{fontSize:12},children:t("online avaliable")})})}),(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:.2,sx:{justifySelf:{xs:"flex-end"},alignSelf:{xs:"flex-end"}},children:[(0,P.jsx)(L.A,{size:"small",color:"error",onClick:()=>(e=>{z(e),r(!1),setTimeout((()=>{r(!0)}),100)})(n),children:(0,P.jsx)(W.A,{icon:"solar:trash-bin-trash-bold"})}),(0,P.jsx)(L.A,{size:"small",onClick:()=>E(n),children:(0,P.jsx)(W.A,{icon:"zondicons:refresh"})}),(0,P.jsx)(L.A,{size:"small",onClick:()=>D({[n]:!C[n]}),children:(0,P.jsx)(W.A,{icon:C[n]?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"})})]})]}),C[n]&&(0,P.jsx)(V,{setAppointmentsNum:T,appointmenttypesData:M,open:C[n],ParentIndex:n,unmountOnExit:!0})]},n)}))}),(0,P.jsx)($.A,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,P.jsx)(m.A,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,P.jsx)(q.A,{size:"small",color:"primary",startIcon:(0,P.jsx)(W.A,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{try{var e;const n=null===(e=c.filter((e=>!S.weekend.includes(e.value)&&!S.days_details.some((n=>n.day===e.value))))[0])||void 0===e?void 0:e.value;if(!n)throw Error("No valid date to create");const l={day:"",work_start_time:null,work_end_time:null,break_start_time:null,break_end_time:null,appointments:[],service_types:[],appointment_type:null,online_available:null},t=S.days_details?S.days_details[S.days_details.length-1]:[],a={...l,...t,day:n};j(a)}catch(n){console.error(n),u(n.message,{variant:"error"})}},children:s?"\u0625\u0636\u0627\u0641\u0629 \u064a\u0648\u0645 \u062c\u062f\u064a\u062f":"add new day"})})]})]})}function R(){const{t:e}=(0,A.WD)(),{currentLang:n}=(0,A.jc)(),l="ar"===n.value,{myunitTime:t}=(0,T.nM)(),{user:i}=(0,j.Z)(),{control:s,watch:o,setValue:d}=(0,a.xW)(),{fields:r,append:u,remove:c}=(0,a.jz)({control:s,name:"long_holidays"}),p=o();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,P.jsxs)(v.A,{sx:{p:3},children:[(0,P.jsxs)(x.A,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:[l?"\u0639\u0637\u0644 \u0637\u0648\u064a\u0644\u0629":"Long Holidays",":"]}),(0,P.jsx)(m.A,{sx:{mt:3},divider:(0,P.jsx)($.A,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:r.map(((n,l,o)=>(0,P.jsx)(m.A,{alignItems:"flex-start",spacing:1.5,sx:{width:{xs:"100%",md:"auto"}},children:(0,P.jsxs)(m.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:{xs:"100%",md:"auto"}},children:[(0,P.jsx)(w.o3,{size:"small",name:`long_holidays[${l}].description`,label:e("description")}),(0,P.jsx)(a.xI,{name:`long_holidays[${l}].start_date`,control:s,render:n=>{let{field:a,fieldState:{error:s}}=n;return(0,P.jsx)(D.l,{label:e("start date"),value:t(p.long_holidays[l].start_date),onChange:e=>{var n,t,s,o,r;const m=(0,S.A)(e,(null===i||void 0===i||null===(n=i.employee)||void 0===n||null===(t=n.employee_engagements)||void 0===t||null===(s=t[null===i||void 0===i?void 0:i.employee.selected_engagement])||void 0===s||null===(o=s.unit_service)||void 0===o||null===(r=o.country)||void 0===r?void 0:r.time_zone)||"Asia/Amman");d(`long_holidays[${l}].end_date`,m),a.onChange(m)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!s,helperText:null===s||void 0===s?void 0:s.message}}})}}),(0,P.jsx)(a.xI,{name:`long_holidays[${l}].end_date`,control:s,render:n=>{let{field:a,fieldState:{error:s}}=n;return(0,P.jsx)(D.l,{label:e("end date"),value:t(p.long_holidays[l].end_date),onChange:e=>{var n,l,t,s,o;const d=(0,S.A)(e,(null===i||void 0===i||null===(n=i.employee)||void 0===n||null===(l=n.employee_engagements)||void 0===l||null===(t=l[null===i||void 0===i?void 0:i.employee.selected_engagement])||void 0===t||null===(s=t.unit_service)||void 0===s||null===(o=s.country)||void 0===o?void 0:o.time_zone)||"Asia/Amman");a.onChange(d)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!s,helperText:null===s||void 0===s?void 0:s.message}}})}}),(0,P.jsx)(L.A,{size:"small",color:"error",sx:{justifySelf:"flex-end",alignSelf:"flex-end",width:35},onClick:()=>(e=>{c(e)})(l),children:(0,P.jsx)(W.A,{icon:"solar:trash-bin-trash-bold"})})]})},o)))}),(0,P.jsx)($.A,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,P.jsx)(m.A,{spacing:1,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,P.jsx)(q.A,{size:"small",color:"primary",startIcon:(0,P.jsx)(W.A,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{u({start_date:null,end_date:null,description:""})},children:l?"\u0625\u0636\u0627\u0641\u0629 \u0639\u0637\u0644 \u0637\u0648\u064a\u0644\u0629":"add long holiday"})})]})]})}function G(e){let{appointmentConfigData:n,refetch:l,loading:i}=e;const S=(0,g.rd)(),{t:$}=(0,A.WD)(),{currentLang:I}=(0,A.jc)(),C="ar"===I.value,{id:D}=(0,g.g)(),{user:F}=(0,j.Z)(),T=(0,b.tH$)(D).data,[W,q]=(0,o.useState)(0),[L,E]=(0,o.useState)(),[O,Z]=(0,o.useState)([]),{enqueueSnackbar:B}=(0,k.dh)(),H=(0,y.C)(!1),N=(0,y.C)(!1),V=(0,y.C)(),G=(0,y.C)(),J=t.Ik().shape({weekend:t.YO(),start_date:t.gl().nullable(),end_date:t.gl().nullable(),appointment_time:t.ai().required($("required field")).min(5,"Appointment Time must be at least 5").max(180,"Appointment Time must be at most 180"),config_frequency:t.ai().required($("required field")).min(1,"must be at least 1").max(360,"must be at most 360"),holidays:t.YO(),long_holidays:t.YO().of(t.Ik().shape({start_date:t.gl().nullable(),end_date:t.gl().nullable(),description:t.Yj().nullable()})),work_group:t.Yj().required($("required field")),work_shift:t.Yj().required($("required field")),days_details:t.YO().of(t.Ik().shape({day:t.Yj().required($("required field")),work_start_time:t.gl().nullable().required($("required field")),work_end_time:t.gl().nullable().required($("required field")),appointments:t.YO(),service_types:t.YO(),appointment_type:t.Yj().nullable(),online_available:t.zM()}))}),K=(0,o.useMemo)((()=>{var e,l,t,a,i,s;return{unit_service:(null===n||void 0===n?void 0:n.unit_service._id)||(null===F||void 0===F||null===(e=F.employee)||void 0===e||null===(l=e.employee_engagements)||void 0===l||null===(t=l[null===F||void 0===F?void 0:F.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id),department:(null===T||void 0===T||null===(a=T.department)||void 0===a?void 0:a._id)||null,start_date:(null===n||void 0===n?void 0:n.start_date)||null,end_date:(null===n||void 0===n?void 0:n.end_date)||null,weekend:(null===n||void 0===n?void 0:n.weekend)||[],appointment_time:(null===n||void 0===n?void 0:n.appointment_time)||null,config_frequency:(null===n||void 0===n?void 0:n.config_frequency)||null,holidays:(null===n||void 0===n?void 0:n.holidays)||[{description:"",date:null}],long_holidays:(null===n||void 0===n?void 0:n.long_holidays)||[{description:"",start_date:null,end_date:null}],work_group:(null===n||void 0===n||null===(i=n.work_group)||void 0===i?void 0:i._id)||null,work_shift:(null===n||void 0===n||null===(s=n.work_shift)||void 0===s?void 0:s._id)||null,online_available:(null===n||void 0===n?void 0:n.online_available)||!1,days_details:(null===n||void 0===n?void 0:n.days_details)||[{day:"saturday",work_start_time:null,work_end_time:null,break_start_time:null,break_end_time:null,appointments:[],service_types:[],appointment_type:null,online_available:!0}]}}),[n,null===F||void 0===F?void 0:F.employee,null===T||void 0===T?void 0:T.department]),Q=(0,a.mN)({mode:"all",resolver:(0,d.t)(J),defaultValues:K}),{reset:U,handleSubmit:ee,formState:{isSubmitting:ne,errors:le}}=Q,te=ee((async e=>{G.onTrue();const l=new Date,t=new Date(l.getTime()+24*e.config_frequency*60*60*1e3);try{n?!e.start_date&&!e.end_date||new Date(e.end_date)>l&&(new Date(e.start_date)<=l||new Date(e.start_date)<t)?(Z(e),V.onTrue()):(await f.Ay.patch(`${f.vZ.appointment_configs.all}/${null===n||void 0===n?void 0:n._id}`,e),S.push(_.f.unitservice.employees.appointmentconfig.root(D))):(N.onTrue(),await f.Ay.post(f.vZ.appointment_configs.all,e),N.onFalse(),B($("added successfully!")),S.push(_.f.unitservice.employees.appointmentconfig.root(D))),G.onFalse(),console.info("DATA",JSON.stringify(e,null,2))}catch(a){N.onFalse(),G.onFalse(),B(C&&`${a.arabic_message}`||`${a.message}`,{variant:"error"}),console.error(a)}}));return(0,o.useEffect)((()=>{Object.keys(le).length&&Object.keys(le).forEach(((e,n)=>{var l;return B(`${e}: ${(null===le||void 0===le||null===(l=le[e])||void 0===l?void 0:l.message)||"error"}`,{variant:"error"})}))}),[le,B]),(0,o.useEffect)((()=>{U(K)}),[K,U]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(u.A,{maxWidth:"lg",children:(0,P.jsxs)(w.Ay,{methods:Q,children:[!i&&(0,P.jsxs)(r.A,{children:[!!L&&(0,P.jsx)(p.A,{sx:{borderRadius:0},severity:"error",children:(0,P.jsx)("div",{dangerouslySetInnerHTML:{__html:L}})}),(0,P.jsx)(M,{setAppointTime:q,appointmentConfigData:n}),(0,P.jsx)(X,{setErrorMsg:E,appointTime:W}),(0,P.jsx)(Y,{}),(0,P.jsx)(R,{})]}),(0,P.jsx)(m.A,{justifyContent:"flex-end",direction:"row",spacing:2,sx:{mt:3},children:(0,P.jsx)(c.A,{variant:"contained",loading:ne||H.value||N.value,onClick:te,children:$("save")})})]})}),(0,P.jsx)(z.T,{disabled:N.value,open:N.value||V.value,onClose:V.onFalse,title:N.value?"Creating appointments...":"Do you want to change your existance appointments?",content:N.value?(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(s(),{options:{strings:["It might take several minutes..","We are getting appointments ready..","We are almost done.."],autoStart:!0,loop:!0,deleteSpeed:5,cursor:"",delay:20}})}):(0,P.jsxs)(P.Fragment,{children:[C?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{mt:1,color:"text.disabled"},children:["\u0627\u0636\u063a\u0637 ",(0,P.jsx)("strong",{children:" \u0646\u0639\u0645 "})," \u0644\u062a\u063a\u064a\u064a\u0631 \u0627\u0644\u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u0645\u0646\u0634\u0623\u0629"]}),(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{color:"info.dark"},children:[(0,P.jsx)("strong",{children:" \u0645\u0644\u0627\u062d\u0638\u0629: "})," \u0644\u0646 \u064a\u062a\u0645 \u0627\u0644\u062a\u0639\u062f\u064a\u0644 \u0639\u0644\u0649 \u0623\u064a \u0645\u0646 \u0627\u0644\u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u0645\u062d\u062c\u0648\u0632\u0629"]})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{mt:1,color:"text.disabled"},children:["press",(0,P.jsx)("strong",{children:" yes"})," to change existance appointments"]}),(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{color:"info.dark"},children:[(0,P.jsx)("strong",{children:" note:"})," booked appointment will not change"]})]}),C?(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{mt:1,color:"text.disabled"},children:["\u0627\u0636\u063a\u0637 ",(0,P.jsx)("strong",{children:" \u0644\u0627 "})," \u0644\u062d\u0641\u0638 \u0627\u0644\u0627\u0639\u062f\u0627\u062f\u0627\u062a \u0644\u0644\u0628\u062f\u0621 \u0645\u0646 \u0627\u0644\u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u062a\u064a \u064a\u0631\u0627\u062f \u0625\u0646\u0634\u0627\u0626\u0647\u0627"]}):(0,P.jsxs)(x.A,{variant:"body2",component:"p",sx:{mt:1,color:"text.disabled"},children:["press",(0,P.jsx)("strong",{children:" No"})," to start changing when creating new appointments"]})]}),action:(0,P.jsxs)(P.Fragment,{children:[N.value&&(0,P.jsx)(v.A,{height:"40",sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,P.jsx)(h.A,{size:24,color:"primary"})}),!N.value&&(0,P.jsx)(c.A,{variant:"contained",loading:N.value,color:"warning",onClick:async()=>{N.onTrue();try{await f.Ay.patch(`${f.vZ.appointment_configs.all}/${null===n||void 0===n?void 0:n._id}`,{...O,ImmediateEdit:!0}),N.onFalse(),V.onFalse(),B($("updated successfully!")),S.push(_.f.unitservice.employees.appointmentconfig.root(D))}catch(e){N.onFalse(),V.onFalse(),B(C&&`${e.arabic_message}`||`${e.message}`,{variant:"error"}),console.error(e)}},children:$("yes")}),!N.value&&(0,P.jsx)(c.A,{disabled:N.value,loading:H.value,variant:"contained",color:"success",onClick:async()=>{H.onTrue();try{await f.Ay.patch(`${f.vZ.appointment_configs.all}/${null===n||void 0===n?void 0:n._id}`,{...O,ImmediateEdit:!1}),B($("updated successfully!")),H.onFalse(),V.onFalse(),S.push(_.f.unitservice.employees.appointmentconfig.root(D))}catch(e){H.onFalse(),V.onFalse(),B(C&&`${e.arabic_message}`||`${e.message}`,{variant:"error"}),console.error(e)}},children:$("no")})]})})]})}}}]);
//# sourceMappingURL=72598.e18b7f53.chunk.js.map
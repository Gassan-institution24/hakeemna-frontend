"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[5378],{38563:(e,a,t)=>{t.d(a,{Z:()=>u});var i=t(68870),n=t(50533),s=t(36314),r=t(4567),l=t(93517),d=t(4419),o=t(80184);function c(e){let{link:a,activeLast:t,disabled:s}=e;const r={typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex",...s&&!t&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}},l=(0,o.jsxs)(o.Fragment,{children:[a.icon&&(0,o.jsx)(i.Z,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:a.icon}),a.name]});return a.href?(0,o.jsx)(n.Z,{component:d.r,href:a.href,sx:r,children:l}):(0,o.jsxs)(i.Z,{sx:r,children:[" ",l," "]})}function u(e){let{links:a,action:t,heading:d,moreLink:u,activeLast:h,sx:v,...g}=e;const x=a&&a[a.length-1].name;return(0,o.jsxs)(i.Z,{sx:{...v},children:[(0,o.jsxs)(s.Z,{direction:"row",alignItems:"center",children:[(0,o.jsxs)(i.Z,{sx:{flexGrow:1,display:"flex",gap:3,alignItems:"center"},children:[d&&(0,o.jsx)(r.Z,{variant:"h4",gutterBottom:!0,children:d}),a&&!!a.length&&(0,o.jsx)(l.Z,{separator:(0,o.jsx)(m,{}),...g,children:null===a||void 0===a?void 0:a.map((e=>(0,o.jsx)(c,{link:e,activeLast:h,disabled:e.name===x},e.name||"")))})]}),t&&(0,o.jsxs)(i.Z,{sx:{flexShrink:0},children:[" ",t," "]})]}),!!u&&(0,o.jsx)(i.Z,{sx:{mt:2},children:u.map((e=>(0,o.jsx)(n.Z,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}function m(){return(0,o.jsx)(i.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}},73379:(e,a,t)=>{t.d(a,{Z:()=>i.Z});var i=t(38563)},15378:(e,a,t)=>{t.r(a),t.d(a,{default:()=>x});var i=t(6907),n=t(89164),s=t(38072),r=t(76932),l=t(25279),d=t(73379),o=t(28020),c=t(80184);function u(e){let{activityData:a}=e;const t=(0,l.K$)(),{t:i}=(0,r.qM)();return(0,c.jsxs)(n.Z,{maxWidth:!t.themeStretch&&"lg",children:[(0,c.jsx)(d.Z,{heading:i("Edit Activity"),links:[{name:i("dashboard"),href:s.H.unitservice.root},{name:i("activities"),href:s.H.unitservice.activities.root},{name:i("edit")}],sx:{mb:{xs:3,md:5}}}),a&&(0,c.jsx)(o.Z,{currentTable:a})]})}var m=t(79572),h=t(19208),v=t(6965),g=t(27031);function x(){const e=(0,h.UO)(),{id:a}=e,{data:t,loading:n}=(0,m.NF)(a),s=null===t||void 0===t?void 0:t.name_english;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(g.Z,{hasContent:!0,category:"unit_service",subcategory:"activities",acl:"update",children:[(0,c.jsx)(i.ql,{children:(0,c.jsxs)("title",{children:["Edit ",s||""," Activity"]})}),n&&(0,c.jsx)(v.a,{}),!n&&(0,c.jsx)(u,{activityData:t})]})})}},28020:(e,a,t)=>{t.d(a,{Z:()=>w});var i=t(8007),n=t(72791),s=t(61134),r=t(44695),l=t(68870),d=t(57621),o=t(82626),c=t(36314),u=t(24308),m=t(12258),h=t(38072),v=t(19208),g=t(79572),x=t(99116),_=t(76932),p=t(32869),b=t(29028),j=t(89731),Z=t(6385),f=t(31243),y=t(8976),k=t(80184);function w(e){var a,t;let{currentTable:w}=e;const C=(0,v.tv)(),{t:q}=(0,_.qM)(),{currentLang:H}=(0,_.nt)(),S="ar"===H.value,{user:I}=(0,y.E)(),{departmentsData:T}=(0,g.T8)(null===I||void 0===I||null===(a=I.employee)||void 0===a||null===(t=a.employee_engagements[null===I||void 0===I?void 0:I.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id),{enqueueSnackbar:A}=(0,p.Ds)(),D=i.Ry().shape({department:i.Z_().nullable(),name_arabic:i.Z_().required("Name is required"),name_english:i.Z_().required("Name is required"),details:i.Z_(),details_arabic:i.Z_()}),E=(0,n.useMemo)((()=>{var e,a;return{unit_service:(null===w||void 0===w?void 0:w.unit_service._id)||(null===I||void 0===I||null===(e=I.employee)||void 0===e||null===(a=e.employee_engagements[null===I||void 0===I?void 0:I.employee.selected_engagement])||void 0===a?void 0:a.unit_service._id),department:(null===w||void 0===w?void 0:w.department._id)||null,name_english:(null===w||void 0===w?void 0:w.name_english)||"",name_arabic:(null===w||void 0===w?void 0:w.name_arabic)||"",details:(null===w||void 0===w?void 0:w.details)||"",details_arabic:(null===w||void 0===w?void 0:w.details_arabic)||""}}),[w,null===I||void 0===I?void 0:I.employee]),F=(0,s.cI)({resolver:(0,r.X)(D),defaultValues:E}),{reset:L,handleSubmit:P,formState:{isSubmitting:V}}=F,W=e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_-]*$/.test(e.target.value)&&F.setValue(e.target.name,e.target.value,{shouldValidate:!0})},$=e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%]*$/.test(e.target.value)&&F.setValue(e.target.name,e.target.value,{shouldValidate:!0})},G=P((async e=>{try{const a=await f.Z.get("https://geolocation-db.com/json/");w?(await(0,Z.Z)({method:"PATCH",path:"".concat(j.Hv.tables.activity(w._id)),data:{modifications_nums:(w.modifications_nums||0)+1,ip_address_user_modification:a.data.IPv4,user_modification:I._id,...e}}),x.W.emit("updated",{data:e,user:I,link:h.H.unitservice.activities.root,msg:"updated an activity <strong>".concat(e.name_english,"</strong>")})):(await(0,Z.Z)({method:"POST",path:"".concat(j.Hv.tables.activities),data:{ip_address_user_creation:a.data.IPv4,user_creation:I._id,...e}}),x.W.emit("created",{data:e,user:I,link:h.H.unitservice.activities.root,msg:"created an activity <strong>".concat(e.name_english,"</strong>")})),L(),C.push(h.H.unitservice.activities.root),A(q(w?"update success!":"create success!")),console.info("DATA",e)}catch(a){x.W.emit("error",{error:a,user:I,location:window.location.href}),console.error(a)}}));return(0,k.jsx)(b.ZP,{methods:F,onSubmit:G,children:(0,k.jsx)(u.Z,{container:!0,spacing:3,children:(0,k.jsx)(u.Z,{xs:12,maxWidth:"md",children:(0,k.jsxs)(d.Z,{sx:{p:3},children:[(0,k.jsxs)(l.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,k.jsx)(b.au,{lang:"ar",onChange:$,name:"name_english",label:"".concat(q("name english")," *")}),(0,k.jsx)(b.au,{lang:"ar",onChange:W,name:"name_arabic",label:"".concat(q("name arabic")," *")}),(0,k.jsx)(b.Cc,{lang:"ar",name:"department",label:q("department"),children:T.map((e=>(0,k.jsx)(o.Z,{value:e._id,children:S?e.name_arabic:e.name_english},e._id)))}),(0,k.jsx)(b.au,{lang:"ar",onChange:$,name:"details",label:q("details")}),(0,k.jsx)(b.au,{lang:"ar",onChange:W,name:"details_arabic",label:q("details arabic")})]}),(0,k.jsx)(c.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,k.jsx)(m.Z,{lang:"ar",type:"submit",variant:"contained",loading:V,children:q(w?"save changes":"create")})})]})})})})}},6385:(e,a,t)=>{t.d(a,{Z:()=>r});var i=t(31243),n=t(88329),s=t(33805);async function r(e){let{setData:a,setError:t,method:r,path:l,data:d}=e;const o="".concat(s.E0).concat(l),c=n.Z.get("user_token"),u=await(0,i.Z)({method:r,url:o,headers:{authorization:"Bearer ".concat(c)},data:d});return u.status,a&&a(u.data),u}}}]);
//# sourceMappingURL=5378.0e6ac64c.chunk.js.map
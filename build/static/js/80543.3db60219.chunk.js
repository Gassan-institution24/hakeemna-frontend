"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[80543],{25872:(e,n,l)=>{l.d(n,{A:()=>_});var t=l(80899),i=l(65043),r=l(46987),o=l(24858),s=l(18403),a=l(74600),d=l(49633),c=l(83462),h=l(81e3),u=l(94814),x=l(38246),p=l(4219),j=l(29347),m=l(35316),g=l(31673),v=l(60778),A=l(59699),y=l(70579);function _(e){let{row:n,open:l,onClose:_,refetch:b,employeeId:f}=e;const{enqueueSnackbar:k}=(0,r.dh)(),{t:w}=(0,v.WD)(),{currentLang:C}=(0,v.jc)(),D="ar"===C.value,M=t.Ik().shape({date:t.p6().nullable(),check_in_time:t.p6().nullable(),off:t.zM().nullable(),check_out_time:t.p6().nullable(),leave_end:t.p6().nullable(),leave_start:t.p6().nullable(),employee_engagement:t.Yj().nullable(),leave:t.Yj().nullable(),work_type:t.Yj().nullable(),note:t.Yj().nullable()}),W={date:(null===n||void 0===n?void 0:n.date)||null,check_in_time:(null===n||void 0===n?void 0:n.check_in_time)||null,off:(null===n||void 0===n?void 0:n.off)||!(null===n||void 0===n||!n.leave)||!1,check_out_time:(null===n||void 0===n?void 0:n.check_out_time)||null,leave_end:(null===n||void 0===n?void 0:n.leave_end)||null,leave_start:(null===n||void 0===n?void 0:n.leave_start)||null,leave:(null===n||void 0===n?void 0:n.leave)||"",work_type:(null===n||void 0===n?void 0:n.work_type)||"",note:(null===n||void 0===n?void 0:n.note)||"",employee_engagement:f||""},P=(0,o.mN)({resolver:(0,s.t)(M),defaultValues:W}),{watch:S,handleSubmit:B,formState:{isSubmitting:I}}=P,R=S("leave"),T=S("off"),F=B((async e=>{try{T?(e.check_in_time=null,e.check_out_time=null,e.leave_start=null,e.leave_end=null,e.work_type=""):e.leave="",null!==n&&void 0!==n&&n._id?(await g.Ay.patch(g.vZ.attendence.one(null===n||void 0===n?void 0:n._id),e),_(),b(),k(w("updated successfuly"))):(await g.Ay.post(g.vZ.attendence.create,e),_(),b(),k(w("created successfuly")))}catch(l){k(D?l.arabic_message||l.message:l.message||l,{variant:"error"}),b()}}));return(0,i.useEffect)((()=>{R?(P.setValue("check_in_time",null),P.setValue("check_out_time",null),P.setValue("leave_start",null),P.setValue("leave_end",null),P.setValue("work_type","")):P.setValue("leave","")}),[R]),(0,y.jsx)(c.A,{fullWidth:!0,maxWidth:"sm",open:l,onClose:()=>{P.reset(),_()},children:(0,y.jsxs)(A.Ay,{methods:P,onSubmit:F,children:[(0,y.jsx)(p.A,{children:w(n?"Edit Attendance details":"Create New Attendance")}),(0,y.jsx)(m.A,{dividers:!0,children:(0,y.jsxs)(a.A,{spacing:3,mt:2,children:[(0,y.jsxs)(h.A,{children:[(0,y.jsx)(A.ZE,{name:"date",label:w("Date")}),(0,y.jsx)(a.A,{direction:"row",justifyContent:"flex-end",children:(0,y.jsx)(A.SF,{name:"off",label:w("leave"),onChange:()=>P.setValue("off",!T)})})]}),T&&(0,y.jsxs)(A.tX,{name:"leave",label:w("Leave"),children:[(0,y.jsx)(u.A,{value:"annual",children:w("annual")}),(0,y.jsx)(u.A,{value:"sick",children:w("sick")}),(0,y.jsx)(u.A,{value:"unpaid",children:w("unpaid")}),(0,y.jsx)(u.A,{value:"public",children:w("public")}),(0,y.jsx)(u.A,{value:"other",children:w("other")})]}),!T&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(A.tX,{name:"work_type",label:w("Work type"),children:[(0,y.jsx)(u.A,{value:"online",children:w("online")}),(0,y.jsx)(u.A,{value:"onsite",children:w("onsite")}),(0,y.jsx)(u.A,{value:"hybrid",children:w("hybrid")}),(0,y.jsx)(u.A,{value:"field",children:w("on the ground")})]}),(0,y.jsx)(A.MB,{name:"check_in_time",label:w("Check in time")}),(0,y.jsx)(A.MB,{name:"check_out_time",label:w("Check out time")}),(0,y.jsx)(A.MB,{name:"leave_start",label:w("Leave start")}),(0,y.jsx)(A.MB,{name:"leave_end",label:w("Leave end")})]}),(0,y.jsx)(A.o3,{name:"note",label:w("note")})]})}),(0,y.jsxs)(j.A,{children:[(0,y.jsx)(d.A,{color:"inherit",variant:"outlined",onClick:_,children:w("Cancel")}),(0,y.jsx)(x.A,{type:"submit",variant:"contained",loading:I,children:w("Save")})]})]})})}},80543:(e,n,l)=>{l.r(n),l.d(n,{default:()=>G});var t=l(29490),i=l(75139),r=l(73216),o=l(65043),s=l(77224),a=l(74600),d=l(17392),c=l(94496),h=l(29013),u=l(40360),x=l(67132),p=l(7625),j=l(60778),m=l(35151),g=l(57287),v=l(72361),A=l(12110),y=l(71806),_=l(77739),b=l(73460),f=l(79650),k=l(59229),w=l(31673),C=l(51440),D=l(75950),M=l(81e3),W=l(49633),P=l(94814),S=l(68738),B=l(39652),I=l(26353),R=l(57442),T=l(68719),F=l(70074),E=l(34624),V=l(25872),L=l(70579);function $(e){let{row:n,selected:l,refetch:t,onSelectRow:i,onViewRow:r,onCancelRow:s,onDeleteRow:a}=e;const{date:c,check_in_time:h,check_out_time:u,leave:x,work_type:p,leaveTime:g,workTime:v,note:A,created_at:y,user_creation:_,ip_address_user_creation:b,updated_at:f,user_modification:k,ip_address_user_modification:w,modifications_nums:C}=n,{t:D}=(0,j.WD)(),$=(0,E.f)(),z=(0,E.f)(),Z=(0,E.f)(),[q,O]=(0,o.useState)(!1),U=(0,T.v)();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(S.A,{hover:!0,selected:l,children:[(0,L.jsx)(B.A,{align:"center",children:(0,R.ts)(c,"EEEE, dd MMMMMMMM yyyy")}),(0,L.jsx)(B.A,{align:"center",children:(0,R.qi)(h)}),(0,L.jsx)(B.A,{align:"center",children:(0,R.qi)(u)}),(0,L.jsx)(B.A,{align:"center",children:(0,R.lU)(g)}),(0,L.jsx)(B.A,{align:"center",children:(0,R.lU)(v)}),(0,L.jsx)(B.A,{align:"center",children:D(p)}),(0,L.jsx)(B.A,{align:"center",children:D(x)}),(0,L.jsx)(B.A,{align:"center",children:A}),(0,L.jsx)(B.A,{align:"right",sx:{px:1},children:(0,L.jsx)(d.A,{color:$.open?"inherit":"default",onClick:$.onOpen,children:(0,L.jsx)(m.A,{icon:"eva:more-vertical-fill"})})})]}),(0,L.jsxs)(E.A,{open:$.open,onClose:$.onClose,arrow:"right-top",children:[(0,L.jsxs)(P.A,{lang:"ar",onClick:z.onOpen,children:[(0,L.jsx)(m.A,{icon:"carbon:data-quality-definition"}),D("DDL")]}),U({category:"unit_service",subcategory:"hr",acl:"update"})&&(0,L.jsxs)(P.A,{lang:"ar",onClick:()=>O(!0),children:[(0,L.jsx)(m.A,{icon:"fluent:edit-32-filled"}),D("Edit")]}),U({category:"unit_service",subcategory:"hr",acl:"delete"})&&(0,L.jsxs)(P.A,{sx:{color:"error.main"},lang:"ar",onClick:Z.onOpen,children:[(0,L.jsx)(m.A,{icon:"mdi:trash"}),D("Delete")]})]}),(0,L.jsxs)(E.A,{open:z.open,onClose:z.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,L.jsxs)(M.A,{sx:{fontWeight:600},children:[D("creation time"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,L.jsx)(I.A,{primary:(0,R.ts)(y,"dd MMMMMMMM yyyy"),secondary:(0,R.ts)(y,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("created by"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===_||void 0===_?void 0:_.email}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("created by IP"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:b}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("editing time"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,L.jsx)(I.A,{primary:(0,R.ts)(f,"dd MMMMMMMM yyyy"),secondary:(0,R.ts)(f,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("editor"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===k||void 0===k?void 0:k.email}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("editor IP"),":"]}),(0,L.jsx)(M.A,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:w}),(0,L.jsxs)(M.A,{sx:{pt:1,fontWeight:600},children:[D("modifications no"),": ",C]})]}),q&&(0,L.jsx)(V.A,{row:n,open:q,refetch:t,onClose:()=>O(!1)}),(0,L.jsx)(F.T,{open:Z.open,onClose:Z.onClose,title:D("Deleting Attendence"),content:D("Are you sure to delete this?"),action:(0,L.jsx)(W.A,{variant:"contained",color:"error",onClick:()=>{$.onClose(),Z.onClose(),a(n._id)},children:D("Delete")})})]})}var z=l(52369),Z=l(26487),q=l(8555),O=l(91264);function U(e){let{filters:n,onFilters:l,onResetFilters:t,results:i,...r}=e;const{t:o}=(0,j.WD)(),s=(0,O.fT)(n.startDate,n.endDate),d=()=>{l("startDate",null),l("endDate",null)};return(0,L.jsxs)(a.A,{spacing:1.5,...r,children:[(0,L.jsxs)(M.A,{sx:{typography:"body2"},children:[(0,L.jsx)("strong",{children:i}),(0,L.jsx)(M.A,{component:"span",sx:{color:"text.secondary",ml:.25},children:o("results found")})]}),(0,L.jsxs)(a.A,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[n.startDate&&!n.endDate&&(0,L.jsx)(Y,{label:o("date:"),children:(0,L.jsx)(Z.A,{size:"small",label:(0,R.ts)(n.startDate),onDelete:d})}),n.startDate&&n.endDate&&(0,L.jsx)(Y,{label:o("date:"),children:(0,L.jsx)(Z.A,{size:"small",label:s,onDelete:d})}),(0,L.jsx)(W.A,{color:"error",onClick:t,startIcon:(0,L.jsx)(m.A,{icon:"solar:trash-bin-trash-bold"}),children:o("clear")})]})]})}function Y(e){let{label:n,children:l,sx:t,...i}=e;return(0,L.jsxs)(a.A,{component:q.A,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...t},...i,children:[(0,L.jsx)(M.A,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,L.jsx)(a.A,{spacing:1,direction:"row",flexWrap:"wrap",children:l})]})}const H={startDate:null,endDate:null};function N(e){let{employee:n}=e;const{t:l}=(0,j.WD)(),t=[{id:"date",label:l("Day")},{id:"check_in_time",label:l("check in")},{id:"check_out_time",label:l("check out")},{id:"leave_time",label:l("leave time")},{id:"work_time",label:l("work time")},{id:"work_type",label:l("work type")},{id:"leave",label:l("leave")},{id:"note",label:l("note")},{id:""}].filter(Boolean),i=(0,D.K2)({defaultOrderBy:"code"}),r=(0,k.C)(),[h,u]=(0,o.useState)(H),{attendence:x,length:g,hours:v,annual:M,sick:W,unpaid:P,other:S,public:B,ids:I,refetch:R}=(0,p.b6Q)(null===n||void 0===n?void 0:n._id,{page:i.page,rowsPerPage:i.rowsPerPage,order:i.order,sortBy:i.orderBy,reported:0,...h}),T=!(!h.startDate||!h.endDate)&&h.startDate.getTime()>h.endDate.getTime(),F=!!h.startDate&&!!h.endDate,E=!x.length&&F||!x.length,V=(0,o.useCallback)(((e,n)=>{i.onResetPage(),u((l=>({...l,[e]:n})))}),[i]),Z=(0,o.useCallback)((()=>{u(H)}),[]),q=(0,o.useCallback)((async e=>{await w.Ay.delete(w.vZ.attendence.one(e)),R()}),[R]);return(0,L.jsxs)(s.A,{maxWidth:"xl",children:[(0,L.jsxs)(a.A,{direction:{md:"row"},justifyContent:"space-around",mb:2,children:[(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("working hours"),":"]}),(0,L.jsx)(c.A,{children:v>60?`${Math.floor(v/60)} ${l("hr")} : ${(v%60).toString().padStart(2,"0")} ${l("min")}`:`${v} ${l("min")}`})]}),(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("annual days off"),":"]}),(0,L.jsx)(c.A,{children:M})]}),(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("sick days off"),":"]}),(0,L.jsx)(c.A,{children:W})]}),(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("unpaid days off"),":"]}),(0,L.jsx)(c.A,{children:P})]}),(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("public days off"),":"]}),(0,L.jsx)(c.A,{children:B})]}),(0,L.jsxs)(a.A,{alignItems:"center",direction:"row",gap:1,children:[(0,L.jsxs)(c.A,{children:[l("other days off"),":"]}),(0,L.jsx)(c.A,{children:S})]})]}),(0,L.jsxs)(A.A,{children:[(0,L.jsx)(z.A,{filters:h,onFilters:V,hours:v,annual:M,sick:W,unpaid:P,publicHolidays:B,other:S,ids:I,refetch:R,length:g,dateError:T}),F&&(0,L.jsx)(U,{filters:h,onFilters:V,onResetFilters:Z,results:g,sx:{p:2.5,pt:0}}),(0,L.jsxs)(f.A,{sx:{position:"relative",overflow:"unset"},children:[(0,L.jsx)(D.Uv,{dense:i.dense,numSelected:i.selected.length,rowCount:x.length,action:(0,L.jsx)(_.A,{title:"Unbook all",children:(0,L.jsx)(d.A,{color:"error",onClick:r.onTrue,children:(0,L.jsx)(m.A,{icon:"mdi:bell-cancel"})})}),color:"error"}),(0,L.jsx)(C.A,{children:(0,L.jsxs)(y.A,{size:i.dense?"small":"medium",sx:{minWidth:800},children:[(0,L.jsx)(D.er,{order:i.order,orderBy:i.orderBy,headLabel:t,rowCount:x.length,numSelected:i.selected.length,onSort:i.onSort}),(0,L.jsxs)(b.A,{children:[x.map(((e,n)=>(0,L.jsx)($,{row:e,refetch:R,onDeleteRow:q},n))),(0,L.jsx)(D.Sm,{notFound:E})]})]})})]}),(0,L.jsx)(D.We,{count:g,page:i.page,rowsPerPage:i.rowsPerPage,onPageChange:i.onChangePage,onRowsPerPageChange:i.onChangeRowsPerPage,dense:i.dense,onChangeDense:i.onChangeDense})]})]})}function X(){var e,n;const{t:l}=(0,j.WD)(),{id:t}=(0,r.g)(),{data:i}=(0,p.tH$)(t),A=(0,x.rd)(),[y,_]=(0,o.useState)("attendence"),b=(0,o.useCallback)(((e,n)=>{_(n)}),[]),{currentLang:f}=(0,j.jc)(),k="ar"===f.value;return(0,L.jsxs)(s.A,{maxWidth:"xl",children:[(0,L.jsxs)(a.A,{direction:"row",alignItems:"center",gap:2,mb:3,children:[(0,L.jsx)(d.A,{onClick:()=>A.back(),children:(0,L.jsx)(m.A,{icon:"eva:arrow-ios-back-fill"})}),(0,L.jsx)(c.A,{variant:"h6",children:k?null===i||void 0===i||null===(e=i.employee)||void 0===e?void 0:e.name_arabic:null===i||void 0===i||null===(n=i.employee)||void 0===n?void 0:n.name_english})]}),(0,L.jsx)(h.A,{value:y,onChange:b,sx:{mb:{xs:3,md:5}},children:["attendence","monthly reports","yearly reports"].map(((e,n)=>(0,L.jsx)(u.A,{label:l(e),value:e},n)))}),"attendence"===y&&(0,L.jsx)(N,{employee:i}),"monthly reports"===y&&(0,L.jsx)(v.A,{employee:null===i||void 0===i?void 0:i._id}),"yearly reports"===y&&(0,L.jsx)(g.A,{employee:null===i||void 0===i?void 0:i._id})]})}function G(){var e,n,l,r,o;const{user:s}=(0,i.Z)(),a=null===s||void 0===s||null===(e=s.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(l=n[null===s||void 0===s||null===(o=s.employee)||void 0===o?void 0:o.selected_engagement])||void 0===l||null===(r=l.unit_service)||void 0===r?void 0:r.name_english;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(t.mg,{children:[(0,L.jsxs)("title",{children:[a||"unit of service"," : Human resourse"]}),(0,L.jsx)("meta",{name:"description",content:"meta"})]}),(0,L.jsx)(X,{})]})}}}]);
//# sourceMappingURL=80543.3db60219.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[51317],{48538:(e,a,t)=>{t.d(a,{A:()=>$});var n=t(80899),r=t(53536),s=t(24858),l=t(65043),i=t(18403),o=t(81e3),d=t(12110),m=t(26487),u=t(74600),c=t(22075),p=t(38246),g=t(48407),_=t(67132),v=t(31673),h=t(91562),b=t(75139),y=t(60778),x=t(7625),j=t(94857),f=t(59699),k=t(70579);function $(e){let{departmentData:a,currentTable:t}=e;const $=(0,_.rd)(),{t:A}=(0,y.WD)(),{currentLang:w}=(0,y.jc)(),D="ar"===w.value,{user:G}=(0,b.Z)(),{employeesData:C}=(0,x.$ln)(a._id),[E,O]=(0,l.useState)([]),{enqueueSnackbar:S}=(0,j.dh)(),V=n.Ik().shape({name_arabic:n.Yj().required(A("required field")),name_english:n.Yj().required(A("required field")),employees:n.YO().min(1,`${A("must be at least")} 1`)}),q=(0,l.useMemo)((()=>{var e,n,r;return{unit_service:(null===G||void 0===G||null===(e=G.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(r=n[null===G||void 0===G?void 0:G.employee.selected_engagement])||void 0===r?void 0:r.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===t||void 0===t?void 0:t.name_arabic)||"",name_english:(null===t||void 0===t?void 0:t.name_english)||"",employees:(null===t||void 0===t?void 0:t.employees.map(((e,a)=>e.employee)))||[]}}),[t,a,null===G||void 0===G?void 0:G.employee]),W=(0,s.mN)({mode:"all",resolver:(0,i.t)(V),defaultValues:q}),{reset:T,handleSubmit:Z,formState:{isSubmitting:I,errors:Y}}=W;(0,l.useEffect)((()=>{Object.keys(Y).length&&Object.keys(Y).forEach(((e,a)=>{var t;return S(`${e}: ${(null===Y||void 0===Y||null===(t=Y[e])||void 0===t?void 0:t.message)||"error"}`,{variant:"error"})}))}),[Y,S]);const z=Z((async e=>{try{t?(await v.Ay.patch(v.vZ.work_groups.one(t._id),e),h.A.emit("updated",{data:e,user:G,link:g.f.unitservice.departments.workGroups.root(a._id),msg:`updated work group <strong>${e.name_english||""}</strong> in <strong>${a.name_english}</strong> department`}),$.push(g.f.unitservice.departments.workGroups.root(a._id))):(await v.Ay.post(v.vZ.work_groups.all,e),h.A.emit("created",{data:e,user:G,link:g.f.unitservice.departments.workGroups.root(a._id),msg:`created work group <strong>${e.name_english||""}</strong> in <strong>${a.name_english}</strong> department`})),T(),S(A(t?"update success!":"create success!"))}catch(n){S(D&&`${n.arabic_message}`||`${n.message}`,{variant:"error"}),console.error(n)}}));return(0,l.useEffect)((()=>{T(q)}),[q,T]),(0,k.jsx)(f.Ay,{methods:W,onSubmit:z,children:(0,k.jsx)(c.A,{xs:12,maxWidth:"md",children:(0,k.jsxs)(d.A,{sx:{p:3},children:[(0,k.jsxs)(o.A,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,k.jsx)(f.o3,{onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%.()]*$/.test(e.target.value)&&W.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:`${A("name english")} *`}),(0,k.jsx)(f.o3,{onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_\-().]*$/.test(e.target.value)&&W.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:`${A("name arabic")} *`}),(0,k.jsx)(f.j2,{name:"employees",label:`${A("employees")} *`,multiple:!0,disableCloseOnSelect:!0,options:C.filter((e=>!E.some((a=>(0,r.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a,t)=>{var n;return(0,l.createElement)("li",{lang:"ar",...e,key:t,value:a._id},D?null===(n=a.employee)||void 0===n?void 0:n.name_arabic:a.employee.name_english)},onChange:(e,a)=>{O(a),W.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,t)=>(0,l.createElement)(m.A,{...a({index:t}),key:t,label:D?e.employee.name_arabic:e.employee.name_english,size:"small",color:"info",variant:"soft"})))})]}),(0,k.jsx)(u.A,{alignItems:"flex-end",sx:{mt:3},children:(0,k.jsx)(p.A,{type:"submit",tabIndex:-1,variant:"contained",loading:I,children:A(t?"save changes":"create")})})]})})})}},51317:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var n=t(29490),r=t(67132),s=t(68719),l=t(7625),i=t(67555),o=t(77224),d=t(48538),m=t(70579);function u(e){let{WorkGroupData:a,departmentData:t}=e;return(0,m.jsx)(o.A,{maxWidth:"xl",children:a&&t&&(0,m.jsx)(d.A,{departmentData:t,currentTable:a})})}function c(){const e=(0,r.g)(),{id:a,acid:t}=e,o=(0,l.UMH)(a).data,{data:d,loading:c}=(0,l.w5O)(t);return(0,m.jsxs)(s.A,{category:"department",subcategory:"management_tables",acl:"update",children:[(0,m.jsxs)(n.mg,{children:[(0,m.jsxs)("title",{children:[o.name_english||"Deartment"," : Edit Work Group"]}),(0,m.jsx)("meta",{name:"description",content:"meta"})]}),c&&(0,m.jsx)(i.x,{}),!c&&(0,m.jsx)(u,{WorkGroupData:d,departmentData:o})]})}}}]);
//# sourceMappingURL=51317.0ce1b761.chunk.js.map
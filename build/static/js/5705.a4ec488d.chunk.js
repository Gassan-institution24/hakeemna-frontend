"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[5705],{75705:(e,t,a)=>{a.r(t),a.d(t,{default:()=>le});var n=a(6907),l=(a(31357),a(72791)),o=a(61474),s=a(2101),i=a(89164),r=a(76932),d=a(13967),c=a(38072),u=a(84954),h=a(40268),v=a(10261),x=(a(4419),a(25279)),g=a(38563),p=a(20068),m=a(12065),f=a(13400),j=a(57621),_=a(79836),Z=a(13838),w=a(53382),y=a(39281),b=a(19208),C=a(22459),P=a(61146),k=a(34045),S=a(64802),R=a(77008),D=(a(73379),a(38062)),O=a(30250),F=a(6965),A=a(79572),I=a(6385),W=a(89731),L=a(90811),T=a(16386),M=a(68870),B=a(49900),H=a(82626),q=a(9195),E=a(13034),U=a(68745),Q=a(24845),z=a(80184);function K(e){let{row:t,onView:a,onActivate:n,onInactivate:l,onSelectRow:o,selected:s,setFilters:i,filters:d}=e;const{code:c,name_english:v,comment:x,quantity:g,price:p,currency:m,start_date:j,end_date:_,services:Z,status:w,created_at:y,user_creation:b,ip_address_user_creation:C,updated_at:P,user_modification:k,ip_address_user_modification:S,modifications_nums:R}=t,{t:D}=(0,r.qM)(),F=(0,Q.S)(),A=(0,Q.S)(),I=(0,z.jsxs)(q.Z,{hover:!0,selected:s,children:[(0,z.jsx)(U.Z,{padding:"checkbox",children:(0,z.jsx)(E.Z,{checked:s,onClick:o})}),(0,z.jsx)(U.Z,{align:"center",children:c}),(0,z.jsx)(U.Z,{align:"center",children:v}),(0,z.jsx)(U.Z,{align:"center",children:x}),(0,z.jsx)(U.Z,{align:"center",children:g}),(0,z.jsxs)(U.Z,{align:"center",children:[null===m||void 0===m?void 0:m.symbol,p]}),(0,z.jsx)(U.Z,{align:"center",children:(0,z.jsx)(B.Z,{primary:(0,L.Z)(new Date(j))&&(0,T.Z)(new Date(j),"dd MMM yyyy"),secondary:(0,L.Z)(new Date(j))&&(0,T.Z)(new Date(j),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,z.jsx)(U.Z,{align:"center",children:(0,z.jsx)(B.Z,{primary:(0,L.Z)(new Date(_))&&(0,T.Z)(new Date(_),"dd MMM yyyy"),secondary:(0,L.Z)(new Date(_))&&(0,T.Z)(new Date(_),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,z.jsx)(U.Z,{align:"center",children:null===Z||void 0===Z?void 0:Z.length}),(0,z.jsx)(U.Z,{align:"center",children:(0,z.jsx)(u.Z,{variant:"soft",color:("active"===w?"success":"inactive"===w&&"error")||"default",children:D(w)})}),(0,z.jsx)(U.Z,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,z.jsx)(f.Z,{color:F.open?"inherit":"default",onClick:F.onOpen,children:(0,z.jsx)(h.Z,{icon:"eva:more-vertical-fill"})})})]});return(0,z.jsxs)(z.Fragment,{children:[I,(0,z.jsxs)(Q.Z,{open:F.open,onClose:F.onClose,arrow:"right-top",sx:{width:140},children:["active"===w?(0,z.jsxs)(H.Z,{onClick:()=>{l(),F.onClose()},sx:{color:"error.main"},children:[(0,z.jsx)(h.Z,{icon:"ic:baseline-pause"}),"Inactivate"]}):(0,z.jsxs)(H.Z,{onClick:()=>{n(),F.onClose()},sx:{color:"success.main"},children:[(0,z.jsx)(h.Z,{icon:"bi:play-fill"}),"activate"]}),(0,z.jsxs)(H.Z,{onClick:()=>{a(),F.onClose()},children:[(0,z.jsx)(h.Z,{icon:"solar:eye-bold"}),"View"]}),(0,z.jsxs)(H.Z,{onClick:A.onOpen,children:[(0,z.jsx)(h.Z,{icon:"carbon:data-quality-definition"}),"DDL"]})]}),(0,z.jsxs)(Q.Z,{open:A.open,onClose:A.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,z.jsx)(M.Z,{sx:{fontWeight:600},children:"Creation Time:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,O.zM)(y)}),(0,z.jsx)(M.Z,{sx:{pt:1,fontWeight:600},children:"Creator:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===b||void 0===b?void 0:b.email}),(0,z.jsx)(M.Z,{sx:{pt:1,fontWeight:600},children:"Creator IP:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:C}),(0,z.jsx)(M.Z,{sx:{pt:1,fontWeight:600},children:"Editing Time:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,O.zM)(P)}),(0,z.jsx)(M.Z,{sx:{pt:1,fontWeight:600},children:"Editor:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===k||void 0===k?void 0:k.email}),(0,z.jsx)(M.Z,{sx:{pt:1,fontWeight:600},children:"Editor IP:"}),(0,z.jsx)(M.Z,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:S}),(0,z.jsxs)(M.Z,{sx:{pt:1,fontWeight:600},children:["Modifications No: ",R]})]})]})}var N=a(36314),V=a(48550),$=a(63466),G=a(41985);function J(e){let{filters:t,onFilters:a,canReset:n,onResetFilters:o,dateError:s}=e;const{t:i}=(0,r.qM)(),d=(0,l.useCallback)((e=>{a("name",e.target.value)}),[a]),c=((0,l.useCallback)((e=>{a("rate","string"===typeof e.target.value?e.target.value.split(","):e.target.value)}),[a]),(0,l.useCallback)((e=>{a("start_date",e)}),[a])),u=(0,l.useCallback)((e=>{a("end_date",e)}),[a]);return(0,z.jsxs)(N.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,z.jsx)(G.M,{label:"Start date",value:t.start_date,onChange:c,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:180}}}),(0,z.jsx)(G.M,{label:"End date",value:t.end_date,onChange:u,slotProps:{textField:{fullWidth:!0,error:s}},sx:{maxWidth:{md:180}}}),(0,z.jsx)(N.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:(0,z.jsx)(V.Z,{fullWidth:!0,value:t.name,onChange:d,placeholder:i("Search name or number..."),InputProps:{startAdornment:(0,z.jsx)($.Z,{position:"start",children:(0,z.jsx)(h.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),n&&(0,z.jsx)(Z.Z,{color:"error",sx:{flexShrink:0},onClick:o,startIcon:(0,z.jsx)(h.Z,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})}var X=a(99443);const Y=[{id:"code",label:"Code"},{id:"name_english",label:"Name"},{id:"comment",label:"Comment"},{id:"quantity",label:"Quantity"},{id:"price",label:"Price"},{id:"start_date",label:"Start Date"},{id:"end_date",label:"End Date"},{id:"services",label:"Services"},{id:"status",label:"Status"},{id:"",width:88}],ee={name:"",status:"all",start_date:null,end_date:null,rate:[]},te=[{value:"all",label:"All"},{value:"active",label:"active"},{value:"inactive",label:"inactive"}];function ae(e){let{stakeholderData:t}=e;const a=(0,D.x6)({defaultOrderBy:"code"}),n=(0,b.UO)(),{id:d}=n,g=(0,l.useRef)(),L=(0,x.K$)(),T=(0,C.k)(),M=(0,C.k)(),B=(0,b.tv)(),{offersData:H,loading:q,refetch:E}=(0,A.SA)(d),[U,Q]=(0,l.useState)(ee),N=!(!U.start_date||!U.end_date)&&U.start_date.getTime()>U.end_date.getTime(),V=function(e){var t;let{inputData:a,comparator:n,filters:l,dateError:o}=e;const{status:s,name:i,rate:r,start_date:d,end_date:c}=l,u=null===(t=a)||void 0===t?void 0:t.map(((e,t)=>[e,t]));null===u||void 0===u||u.sort(((e,t)=>{const a=n(e[0],t[0]);return 0!==a?a:e[1]-t[1]})),a=u.map((e=>e[0])),i&&(a=a.filter((e=>{var t,a,n,l,o,s,r,d,c,u,h,v,x,g,p,m,f,j,_,Z;return(null===e||void 0===e?void 0:e.name_english)&&-1!==(null===e||void 0===e||null===(t=e.name_english)||void 0===t?void 0:t.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e?void 0:e.name_arabic)&&-1!==(null===e||void 0===e||null===(a=e.name_arabic)||void 0===a?void 0:a.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(n=e.unit_service)||void 0===n?void 0:n.name_english)&&-1!==(null===e||void 0===e||null===(l=e.unit_service)||void 0===l||null===(o=l.name_english)||void 0===o?void 0:o.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(s=e.unit_service)||void 0===s?void 0:s.name_arabic)&&-1!==(null===e||void 0===e||null===(r=e.unit_service)||void 0===r||null===(d=r.name_arabic)||void 0===d?void 0:d.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(c=e.country)||void 0===c?void 0:c.name_english)&&-1!==(null===e||void 0===e||null===(u=e.country)||void 0===u||null===(h=u.name_english)||void 0===h?void 0:h.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(v=e.country)||void 0===v?void 0:v.name_arabic)&&-1!==(null===e||void 0===e||null===(x=e.country)||void 0===x||null===(g=x.name_arabic)||void 0===g?void 0:g.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(p=e.city)||void 0===p?void 0:p.name_english)&&-1!==(null===e||void 0===e||null===(m=e.city)||void 0===m||null===(f=m.name_english)||void 0===f?void 0:f.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e||null===(j=e.city)||void 0===j?void 0:j.name_arabic)&&-1!==(null===e||void 0===e||null===(_=e.city)||void 0===_||null===(Z=_.name_arabic)||void 0===Z?void 0:Z.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===i||JSON.stringify(e.code)===i})));"all"!==s&&(a=a.filter((e=>e.status===s)));r.length>0&&(a=a.filter((e=>r.includes(e.Rate))));o||d&&c&&(a=a.filter((e=>(0,O.IO)(e.start_date)<=(0,O.IO)(c)&&(0,O.IO)(e.end_date)>=(0,O.IO)(d))));return a}({inputData:H,comparator:(0,D.sQ)(a.order,a.orderBy),filters:U,dateError:N}),$=V.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage),{t:G}=(0,r.qM)(),ae=a.dense?52:72,ne=!(null===U||void 0===U||!U.name)||"all"!==U.status||U.rate.length>0||!!U.start_date&&!!U.end_date,le=!V.length&&ne||!V.length,oe=(0,P.useReactToPrint)({content:()=>g.current}),se=(0,l.useCallback)(((e,t)=>{a.onResetPage(),Q((a=>({...a,[e]:t})))}),[a]),ie=(0,l.useCallback)((()=>{Q(ee)}),[]),re=(0,l.useCallback)(((e,t)=>{se("status",t)}),[se]),de=(0,l.useCallback)((e=>{B.push(c.H.superadmin.stakeholders.offer(t._id,e))}),[B,t._id]),ce=(0,l.useCallback)((async e=>{await(0,I.Z)({method:"PATCH",path:"".concat(W.Hv.tables.offer(e),"/updatestatus"),data:{status:"active"}}),E(),a.onUpdatePageDeleteRow($.length)}),[$.length,a,E]),ue=(0,l.useCallback)((async e=>{await(0,I.Z)({method:"PATCH",path:"".concat(W.Hv.tables.offer(e),"/updatestatus"),data:{status:"inactive"}}),E(),a.onUpdatePageDeleteRow($.length)}),[$.length,a,E]),he=(0,l.useCallback)((async()=>{await(0,I.Z)({method:"PATCH",path:"".concat(W.Hv.tables.offers,"/updatestatus"),data:{status:"active",ids:a.selected}}),E(),a.onUpdatePageDeleteRows({totalRows:H.length,totalRowsInPage:$.length,totalRowsFiltered:V.length})}),[V.length,$.length,a,H,E]),ve=(0,l.useCallback)((async()=>{await(0,I.Z)({method:"PATCH",path:"".concat(W.Hv.tables.offers,"/updatestatus"),data:{status:"inactive",ids:a.selected}}),E(),a.onUpdatePageDeleteRows({totalRows:H.length,totalRowsInPage:$.length,totalRowsFiltered:V.length})}),[V.length,$.length,a,H,E]);return q?(0,z.jsx)(F.a,{}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(i.Z,{maxWidth:!L.themeStretch&&"lg",children:(0,z.jsxs)(j.Z,{children:[(0,z.jsx)(s.Z,{value:U.status,onChange:re,sx:{px:2.5,boxShadow:e=>"inset 0 -2px 0 0 ".concat((0,m.Fq)(e.palette.grey[500],.08))},children:te.map((e=>(0,z.jsx)(o.Z,{iconPosition:"end",value:e.value,label:e.label,icon:(0,z.jsxs)(u.Z,{variant:"all"===e.value||e.value===U.status?"filled":"soft",color:("active"===e.value?"success":"inactive"===e.value&&"error")||"default",children:["all"===e.value&&H.length,"active"===e.value&&H.filter((e=>"active"===e.status)).length,"inactive"===e.value&&H.filter((e=>"inactive"===e.status)).length]})},e.value)))}),(0,z.jsx)(J,{onPrint:oe,filters:U,onFilters:se,onDownload:()=>{const e=V.reduce(((e,t)=>{var a,n;return e.push({code:t.code,name:t.name_english,category:null===(a=t.category)||void 0===a?void 0:a.name_english,symptoms:null===(n=t.symptoms)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.name_english))}),e}),[]),t=k.P6.book_new(),a=k.P6.json_to_sheet(e);k.P6.book_append_sheet(t,a,"Sheet 1");const n=k.cW(t,{bookType:"xlsx",type:"array"}),l=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,S.saveAs)(l,"unitservicesTable.xlsx")},canReset:ne,onResetFilters:ie}),ne&&(0,z.jsx)(X.Z,{filters:U,onFilters:se,onResetFilters:ie,results:V.length,sx:{p:2.5,pt:0}}),(0,z.jsxs)(y.Z,{children:[(0,z.jsx)(D.Z4,{numSelected:a.selected.length,rowCount:V.length,onSelectAllRows:e=>a.onSelectAllRows(e,V.map((e=>e._id))),action:(0,z.jsx)(z.Fragment,{children:V.filter((e=>a.selected.includes(e._id))).some((e=>"inactive"===e.status))?(0,z.jsx)(p.Z,{title:"Activate all",children:(0,z.jsx)(f.Z,{color:"primary",onClick:T.onTrue,children:(0,z.jsx)(h.Z,{icon:"codicon:run-all"})})}):(0,z.jsx)(p.Z,{title:"Inactivate all",children:(0,z.jsx)(f.Z,{color:"error",onClick:M.onTrue,children:(0,z.jsx)(h.Z,{icon:"iconoir:pause-solid"})})})}),color:V.filter((e=>a.selected.includes(e._id))).some((e=>"inactive"===e.status))?"primary":"error"}),(0,z.jsx)(v.Z,{children:(0,z.jsxs)(_.Z,{ref:g,size:a.dense?"small":"medium",children:[(0,z.jsx)(D.K,{order:a.order,orderBy:a.orderBy,headLabel:Y,rowCount:V.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:e=>a.onSelectAllRows(e,V.map((e=>e._id)))}),(0,z.jsxs)(w.Z,{children:[V.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map((e=>(0,z.jsx)(K,{row:e,filters:U,setFilters:Q,selected:a.selected.includes(e._id),onSelectRow:()=>a.onSelectRow(e._id),onView:()=>de(e._id),onActivate:()=>ce(e._id),onInactivate:()=>ue(e._id)},e._id))),(0,z.jsx)(D.$W,{height:ae,emptyRows:(0,D.fQ)(a.page,a.rowsPerPage,H.length)}),(0,z.jsx)(D.et,{notFound:le})]})]})})]}),(0,z.jsx)(D.S_,{count:V.length,page:a.page,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onRowsPerPageChange:a.onChangeRowsPerPage,dense:a.dense,onChangeDense:a.onChangeDense})]})}),(0,z.jsx)(R.Q,{open:M.value,onClose:M.onFalse,title:"Inactivate",content:(0,z.jsxs)(z.Fragment,{children:["Are you sure want to Inactivate ",(0,z.jsxs)("strong",{children:[" ",a.selected.length," "]})," items?"]}),action:(0,z.jsx)(Z.Z,{variant:"contained",color:"error",onClick:()=>{ve(),M.onFalse()},children:"Inactivate"})}),(0,z.jsx)(R.Q,{open:T.value,onClose:T.onFalse,title:"Activate",content:(0,z.jsxs)(z.Fragment,{children:["Are you sure want to Activate ",(0,z.jsxs)("strong",{children:[" ",a.selected.length," "]})," items?"]}),action:(0,z.jsx)(Z.Z,{variant:"contained",color:"primary",onClick:()=>{he(),T.onFalse()},children:"Activate"})})]})}function ne(e){let{stakeholderData:t}=e;(0,d.Z)();const{t:a}=(0,r.qM)(),n=(0,x.K$)(),[u,h]=(0,l.useState)("Offers"),v=(0,l.useCallback)(((e,t)=>{h(t)}),[]),p=(s.Z,["Offers","Taken Offers"].map(((e,t)=>(0,z.jsx)(o.Z,{iconPosition:"end",value:e,label:e},t))),(null===t||void 0===t?void 0:t.name_english)||"Stakeholder");return(0,z.jsxs)(i.Z,{maxWidth:!n.themeStretch&&"lg",children:[(0,z.jsx)(g.Z,{heading:"".concat(p," Offers"),links:[{name:a("dashboard"),href:c.H.superadmin.root},{name:a("stakeholders"),href:c.H.superadmin.stakeholders.root},{name:"".concat(p," Offers")}],sx:{mb:{xs:3,md:5}}}),"Offers"===u&&(0,z.jsx)(ae,{stakeholderData:t})]})}function le(){const e=(0,b.UO)(),{id:t}=e,{data:a,loading:l}=(0,A.Db)(t),o=(null===a||void 0===a?void 0:a.name_english)||"Stackeholder";return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(n.ql,{children:(0,z.jsxs)("title",{children:[" stakeholders: ",o," Offers "]})}),l&&(0,z.jsx)(F.a,{}),!l&&(0,z.jsx)(ne,{stakeholderData:a})]})}}}]);
//# sourceMappingURL=5705.a4ec488d.chunk.js.map
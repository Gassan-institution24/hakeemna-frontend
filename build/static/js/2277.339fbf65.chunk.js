"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2277],{85010:(e,a,t)=>{t.r(a),t.d(a,{default:()=>p});var n=t(6907),i=t(19208),l=t(27031),r=t(76119),s=t(35456),o=t(10266),d=t(25279),m=t(17579),u=t(80184);function c(e){let{WorkGroupData:a,departmentData:t}=e;const n=(0,d.K$)();return(0,u.jsx)(o.Z,{maxWidth:!n.themeStretch&&"lg",children:a&&t&&(0,u.jsx)(m.Z,{departmentData:t,currentTable:a})})}function p(){const e=(0,i.UO)(),{id:a,acid:t}=e,o=(0,r.YLE)(a).data,{data:d,loading:m}=(0,r.tBz)(t);return(0,u.jsxs)(l.Z,{category:"department",subcategory:"management_tables",acl:"update",children:[(0,u.jsxs)(n.ql,{children:[(0,u.jsxs)("title",{children:[o.name_english||"Deartment"," : Edit Work Group"]}),(0,u.jsx)("meta",{name:"description",content:"meta"})]}),m&&(0,u.jsx)(s.a,{}),!m&&(0,u.jsx)(c,{WorkGroupData:d,departmentData:o})]})}},17579:(e,a,t)=>{t.d(a,{Z:()=>f});var n=t(8007),i=t(763),l=t(61134),r=t(72791),s=t(44695),o=t(16029),d=t(57621),m=t(85771),u=t(53767),c=t(24308),p=t(12258),g=t(38072),_=t(66664),v=t(99116),h=t(8976),y=t(78644),b=t(76119),x=t(32869),k=t(78812),j=t(80184);function f(e){let{departmentData:a,currentTable:t}=e;const{t:f}=(0,y.qM)(),{currentLang:Z}=(0,y.nt)(),w="ar"===Z.value,{user:D}=(0,h.E)(),{employeesData:q}=(0,b.C$X)(a._id),[C,S]=(0,r.useState)([]),{enqueueSnackbar:E}=(0,x.Ds)(),G=n.Ry().shape({name_arabic:n.Z_().required(f("required field")),name_english:n.Z_().required(f("required field")),employees:n.IX().min(1,"".concat(f("must be at least")," 1"))}),V=(0,r.useMemo)((()=>{var e,n;return{unit_service:(null===D||void 0===D||null===(e=D.employee)||void 0===e||null===(n=e.employee_engagements[null===D||void 0===D?void 0:D.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===t||void 0===t?void 0:t.name_arabic)||"",name_english:(null===t||void 0===t?void 0:t.name_english)||"",employees:(null===t||void 0===t?void 0:t.employees.map(((e,a)=>e.employee)))||[]}}),[t,a,null===D||void 0===D?void 0:D.employee]),$=(0,l.cI)({mode:"onTouched",resolver:(0,s.X)(G),defaultValues:V}),{reset:T,handleSubmit:W,formState:{isSubmitting:H}}=$,I=W((async e=>{try{t?(await _.ZP.patch(_.Hv.work_groups.one(t._id),e),v.Z.emit("updated",{data:e,user:D,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"updated work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})):(await _.ZP.post(_.Hv.work_groups.all,e),v.Z.emit("created",{data:e,user:D,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"created work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})),T(),E(f(t?"update success!":"create success!"))}catch(n){E(w&&n.arabic_message||n.message,{variant:"error"}),console.error(n)}}));return(0,r.useEffect)((()=>{var e,n;T({unit_service:(null===D||void 0===D||null===(e=D.employee)||void 0===e||null===(n=e.employee_engagements[null===D||void 0===D?void 0:D.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===t||void 0===t?void 0:t.name_arabic)||"",name_english:(null===t||void 0===t?void 0:t.name_english)||"",employees:(null===t||void 0===t?void 0:t.employees.map(((e,a)=>e.employee)))||[]})}),[t]),(0,j.jsx)(k.ZP,{methods:$,onSubmit:I,children:(0,j.jsx)(c.Z,{xs:12,maxWidth:"md",children:(0,j.jsxs)(d.Z,{sx:{p:3},children:[(0,j.jsxs)(o.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,j.jsx)(k.au,{onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%.()]*$/.test(e.target.value)&&$.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(f("name english")," *")}),(0,j.jsx)(k.au,{onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_\-()]*$/.test(e.target.value)&&$.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(f("name arabic")," *")}),(0,j.jsx)(k.Fl,{name:"employees",label:"".concat(f("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:q.filter((e=>!C.some((a=>(0,i.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a,t)=>{var n;return(0,r.createElement)("li",{...e,key:t,value:a._id},w?null===(n=a.employee)||void 0===n?void 0:n.name_arabic:a.employee.name_english)},onChange:(e,a)=>{S(a),$.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,t)=>(0,r.createElement)(m.Z,{...a({index:t}),key:t,label:w?e.employee.name_arabic:e.employee.name_english,size:"small",color:"info",variant:"soft"})))})]}),(0,j.jsx)(u.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,j.jsx)(p.Z,{type:"submit",tabIndex:-1,variant:"contained",loading:H,children:f(t?"save changes":"create")})})]})})})}}}]);
//# sourceMappingURL=2277.339fbf65.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[50189],{50189:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Q});var a=s(29490),i=s(67132),r=s(7625),n=s(65043),o=s(74600),l=s(77224),c=s(22075),d=s(48407),h=s(46987),u=s(31673),p=s(10202),x=s(12110),v=s(79958),g=s(68903),m=s(67784),y=s(94814),A=s(77739),j=s(26353),f=s(49633),b=s(70579);const w=["very urgent","urgent","normal"];function k(e){var t,s,a,i;let{ticket:l,refetch:c}=e;const{enqueueSnackbar:d}=(0,h.dh)(),{ticketCategoriesData:p}=(0,r.o3g)(),{usersData:k}=(0,r.wxu)({role:"superadmin"}),[C,_]=(0,n.useState)(l.note),[S,T]=(0,n.useState)(l.priority),[R,I]=(0,n.useState)(null===(t=l.category)||void 0===t?void 0:t._id),[H,N]=(0,n.useState)(null===(s=l.assigned_to)||void 0===s?void 0:s._id);return(0,b.jsxs)(x.A,{children:[(0,b.jsx)(v.A,{title:"Ticket Info"}),(0,b.jsx)(o.A,{direction:"row",sx:{p:3},children:(0,b.jsxs)(g.Ay,{sx:{p:4},container:!0,spacing:3,rowGap:2,children:[[{label:"user",value:null===l||void 0===l||null===(a=l.user_creation)||void 0===a?void 0:a.email},{label:"role",value:null===l||void 0===l||null===(i=l.user_creation)||void 0===i?void 0:i.role},{label:"category",value:(0,b.jsx)(m.A,{select:!0,variant:"standard",size:"small",sx:{width:150},value:R,onChange:e=>{try{u.Ay.patch(u.vZ.tickets.one(null===l||void 0===l?void 0:l._id),{category:e.target.value}),I(e.target.value),d("changed successfully!"),c()}catch(t){d(t.message),c()}},children:p.map(((e,t)=>(0,b.jsx)(y.A,{value:null===e||void 0===e?void 0:e._id,children:e.name_english},t)))})},{label:"priority",value:(0,b.jsx)(m.A,{select:!0,variant:"standard",size:"small",sx:{width:150},value:S,onChange:e=>{try{u.Ay.patch(u.vZ.tickets.one(null===l||void 0===l?void 0:l._id),{priority:e.target.value}),T(e.target.value),d("changed successfully!"),c()}catch(t){d(t.message),c()}},children:w.map(((e,t)=>(0,b.jsx)(y.A,{value:e,children:e},t)))})},{label:"URL",value:(0,b.jsxs)(A.A,{title:l.URL.length>20&&l.URL,children:[" ",l.URL.length>20?`${l.URL.slice(0,20)}..`:l.URL]})},{label:"assigned to",value:(0,b.jsx)(m.A,{select:!0,variant:"standard",size:"small",sx:{width:150},value:H,onChange:e=>{try{u.Ay.patch(u.vZ.tickets.one(null===l||void 0===l?void 0:l._id),{assigned_to:e.target.value}),N(e.target.value),d("changed successfully!"),c()}catch(t){d(t.message),c()}},children:k.map(((e,t)=>(0,b.jsx)(y.A,{value:null===e||void 0===e?void 0:e._id,children:e.email},t)))})}].map(((e,t)=>(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g.Ay,{xs:12,md:6,children:(0,b.jsx)(j.A,{primary:e.label,secondary:e.value,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5,mr:2},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}})})}))),(0,b.jsxs)(g.Ay,{xs:12,children:[(0,b.jsx)(j.A,{primary:"details",secondary:l.details,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}}),(0,b.jsxs)(o.A,{direction:"row",alignItems:"flex-end",children:[(0,b.jsx)(m.A,{variant:"standard",sx:{width:1,mt:2},label:"Note",value:C,onChange:e=>_(e.target.value)}),C!==l.note&&(0,b.jsx)(f.A,{onClick:e=>{try{u.Ay.patch(u.vZ.tickets.one(null===l||void 0===l?void 0:l._id),{note:C}),d("changed successfully!"),c()}catch(t){d(t.message),c()}},sx:{height:30},children:"\u2713"})]})]})]})})]})}var C=s(91562),_=s(75139),S=s(89141),T=s(65172),R=s(65485);function I(e){var t;let{ticket:s}=e;const{user:a}=(0,_.Z)(),{conversation:i,refetch:r}=(0,S.ZB)(s.chat),l=i?null===(t=i.participants)||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e._id)!==(null===a||void 0===a?void 0:a._id))):[];return(0,n.useEffect)((()=>{C.A.on("message",(e=>{e.chat===s.chat&&r()}))}),[]),(0,b.jsx)(x.A,{sx:{width:1,height:600,overflow:"hidden"},children:(0,b.jsxs)(o.A,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,b.jsx)(o.A,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:"Chat"}),(0,b.jsx)(o.A,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:e=>`solid 1px ${e.palette.divider}`},children:(0,b.jsxs)(o.A,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,b.jsx)(T.A,{messages:null===i||void 0===i?void 0:i.messages,participants:l}),(0,b.jsx)(R.A,{selectedConversationId:s.chat,refetch:r})]})})]})})}var H=s(17392),N=s(94496),L=s(65381),M=s(57442),P=s(16236),Z=s(35151),U=s(34624);function $(e){let{status:t,backLink:s,ticket:a,statusOptions:i,onChangeStatus:r}=e;const n=(0,U.f)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(o.A,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[(0,b.jsxs)(o.A,{spacing:1,direction:"row",alignItems:"flex-start",children:[(0,b.jsx)(H.A,{component:L.W,href:s,children:(0,b.jsx)(Z.A,{icon:"eva:arrow-ios-back-fill"})}),(0,b.jsxs)(o.A,{spacing:.5,children:[(0,b.jsxs)(o.A,{spacing:1,direction:"row",alignItems:"center",children:[(0,b.jsxs)(N.A,{variant:"h4",children:[" ",null===a||void 0===a?void 0:a.subject," "]}),(0,b.jsx)(P.A,{variant:"soft",color:("pending"===t?"warning":"waiting"===t&&"secondary")||"processing"===t&&"info"||"completed"===t&&"success"||"closed"===t&&"error"||"default",children:t})]}),(0,b.jsx)(N.A,{variant:"body2",sx:{color:"text.disabled"},children:(0,M.uK)(a.created_at)})]})]}),(0,b.jsx)(o.A,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,b.jsx)(f.A,{color:"inherit",variant:"outlined",endIcon:(0,b.jsx)(Z.A,{icon:"eva:arrow-ios-downward-fill"}),onClick:n.onOpen,sx:{textTransform:"capitalize"},children:t})})]}),(0,b.jsx)(U.A,{open:n.open,onClose:n.onClose,arrow:"top-right",sx:{width:140},children:null===i||void 0===i?void 0:i.map((e=>(0,b.jsx)(y.A,{selected:e===t,onClick:()=>{n.onClose(),r(e)},children:e},e)))})]})}var z=s(81e3),F=s(69872),O=s(98029),q=s(25570),B=s(53797),D=s(27634),E=s(39974),G=s(32116),K=s(51440);function W(e){let{history:t}=e;const s=(0,b.jsx)(F.A,{sx:{p:0,m:0,[`& .${E.A.root}:before`]:{flex:0,padding:0}},children:null===t||void 0===t?void 0:t.map(((e,s)=>{var a;const i=0===s,r=s===t.length-1;return(0,b.jsxs)(G.A,{children:[(0,b.jsxs)(B.A,{children:[(0,b.jsx)(O.A,{color:i?"primary":"grey"}),r?null:(0,b.jsx)(D.A,{})]}),(0,b.jsxs)(q.A,{children:[(0,b.jsx)(N.A,{variant:"subtitle2",children:e.note}),(0,b.jsxs)(o.A,{direction:"row",gap:5,children:[(0,b.jsx)(z.A,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:(0,M.uK)(e.date)}),(0,b.jsx)(z.A,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:null===(a=e.user)||void 0===a?void 0:a.email})]})]})]},e.note)}))});return(0,b.jsxs)(x.A,{children:[(0,b.jsx)(v.A,{title:"History"}),(0,b.jsx)(K.A,{spacing:3,alignItems:{md:"flex-start"},direction:{xs:"column-reverse",md:"row"},sx:{p:3,mt:2,height:"400px"},children:s})]})}function J(e){let{ticket:t,refetch:s}=e;const a=(0,p.Mp)(),{enqueueSnackbar:i}=(0,h.dh)(),[r,x]=(0,n.useState)(t.status),v=(0,n.useCallback)((e=>{try{u.Ay.patch(u.vZ.tickets.one(null===t||void 0===t?void 0:t._id),{status:e}),x(e),i("changed successfully!"),s()}catch(a){i(a.message),s()}}),[null===t||void 0===t?void 0:t._id,i,s]);return(0,b.jsxs)(l.A,{maxWidth:!a.themeStretch&&"lg",children:[(0,b.jsx)($,{backLink:d.f.superadmin.communication.root,ticket:t,status:r,refetch:s,onChangeStatus:v,statusOptions:["pending","processing","waiting","completed","closed"]}),(0,b.jsxs)(c.A,{container:!0,spacing:3,children:[(0,b.jsx)(c.A,{xs:12,md:7,children:(0,b.jsxs)(o.A,{spacing:3,direction:{xs:"column-reverse",md:"column"},children:[(0,b.jsx)(k,{ticket:t,refetch:s}),(0,b.jsx)(W,{history:t.history})]})}),(0,b.jsx)(c.A,{xs:12,md:5,children:(0,b.jsx)(I,{ticket:t})})]})]})}function Q(){const{id:e}=(0,i.g)(),{data:t,refetch:s}=(0,r.iEc)(e);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(a.mg,{children:[(0,b.jsx)("title",{children:" Ticket info "}),(0,b.jsx)("meta",{name:"description",content:"meta"})]}),t&&(0,b.jsx)(J,{ticket:t,refetch:s})]})}},79958:(e,t,s)=>{s.d(t,{A:()=>f});var a=s(98587),i=s(58168),r=s(65043),n=s(58387),o=s(98610),l=s(94496),c=s(98206),d=s(34535),h=s(92532),u=s(72372);function p(e){return(0,u.Ay)("MuiCardHeader",e)}const x=(0,h.A)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var v=s(70579);const g=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],m=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,i.A)({[`& .${x.title}`]:t.title,[`& .${x.subheader}`]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),y=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),A=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),j=(0,d.Ay)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),f=r.forwardRef((function(e,t){const s=(0,c.b)({props:e,name:"MuiCardHeader"}),{action:r,avatar:d,className:h,component:u="div",disableTypography:x=!1,subheader:f,subheaderTypographyProps:b,title:w,titleTypographyProps:k}=s,C=(0,a.A)(s,g),_=(0,i.A)({},s,{component:u,disableTypography:x}),S=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},p,t)})(_);let T=w;null==T||T.type===l.A||x||(T=(0,v.jsx)(l.A,(0,i.A)({variant:d?"body2":"h5",className:S.title,component:"span",display:"block"},k,{children:T})));let R=f;return null==R||R.type===l.A||x||(R=(0,v.jsx)(l.A,(0,i.A)({variant:d?"body2":"body1",className:S.subheader,color:"text.secondary",component:"span",display:"block"},b,{children:R}))),(0,v.jsxs)(m,(0,i.A)({className:(0,n.A)(S.root,h),as:u,ref:t,ownerState:_},C,{children:[d&&(0,v.jsx)(y,{className:S.avatar,ownerState:_,children:d}),(0,v.jsxs)(j,{className:S.content,ownerState:_,children:[T,R]}),r&&(0,v.jsx)(A,{className:S.action,ownerState:_,children:r})]}))}))}}]);
//# sourceMappingURL=50189.b9104173.chunk.js.map
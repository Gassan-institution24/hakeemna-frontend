"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[8489],{98489:(e,t,s)=>{s.r(t),s.d(t,{default:()=>le});var o=s(6907),n=s(27031),r=s(72791),a=s(61474),i=s(2101),l=s(57621),c=s(79836),d=s(13838),h=s(20068),u=s(12065),x=s(89164),g=s(53382),p=s(13400),m=s(39281),v=s(4419),w=s(38072),j=s(76932),f=s(19208),Z=s(8976),y=s(99116),b=s(22459),_=s(61146),k=s(34045),C=s(64802),P=s(84954),R=s(40268),S=s(10261),D=s(77008),W=s(25279),F=s(73379),A=s(38062),I=s(51642),T=s(6965),H=s(79572),L=s(6385),O=s(89731),B=s(90811),q=s(16386),z=s(68870),M=s(82626),E=s(9195),U=s(13034),Q=s(68745),G=s(49900),K=s(30250),N=s(24845),$=s(80184);function J(e){let{row:t,selected:s,onEditRow:o,onSelectRow:r,onInactivate:a,onActivate:i,filters:l,setFilters:c}=e;const{code:d,name_english:h,name_arabic:u,start_time:x,end_time:g,status:m,created_at:v,user_creation:w,ip_address_user_creation:f,updated_at:Z,user_modification:y,ip_address_user_modification:_,modifications_nums:k}=t,{t:C}=(0,j.qM)(),{currentLang:S}=(0,j.nt)(),D="ar"===S.value,W=((0,b.k)(),(0,N.S)()),F=(0,N.S)(),A=((0,N.S)(),(0,$.jsxs)(E.Z,{hover:!0,selected:s,children:[(0,$.jsx)(Q.Z,{lang:"ar",padding:"checkbox",children:(0,$.jsx)(U.Z,{checked:s,onClick:r})}),(0,$.jsx)(Q.Z,{lang:"ar",align:"center",children:(0,$.jsx)(z.Z,{children:d})}),(0,$.jsx)(Q.Z,{lang:"ar",align:"center",children:(0,$.jsx)(G.Z,{primary:(0,B.Z)(new Date(x))&&(0,q.Z)(new Date(x),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0}})}),(0,$.jsx)(Q.Z,{lang:"ar",align:"center",children:(0,$.jsx)(G.Z,{primary:(0,B.Z)(new Date(g))&&(0,q.Z)(new Date(g),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0}})}),(0,$.jsx)(Q.Z,{lang:"ar",align:"center",children:D?u:h}),(0,$.jsx)(Q.Z,{lang:"ar",align:"center",children:(0,$.jsx)(P.Z,{lang:"ar",variant:"soft",color:("active"===m?"success":"inactive"===m&&"error")||"default",children:C(m)})}),(0,$.jsx)(Q.Z,{lang:"ar",align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,$.jsx)(p.Z,{color:W.open?"inherit":"default",onClick:W.onOpen,children:(0,$.jsx)(R.Z,{icon:"eva:more-vertical-fill"})})})]}));return(0,$.jsxs)($.Fragment,{children:[A,(0,$.jsxs)(N.Z,{open:W.open,onClose:W.onClose,arrow:"right-top",sx:{width:140},children:["active"===m?(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"delete"})&&(0,$.jsxs)(M.Z,{onClick:()=>{a(),W.onClose()},sx:{color:"error.main"},children:[(0,$.jsx)(R.Z,{icon:"ic:baseline-pause"}),C("inactivate")]}):(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"update"})&&(0,$.jsxs)(M.Z,{onClick:()=>{i(),W.onClose()},sx:{color:"success.main"},children:[(0,$.jsx)(R.Z,{icon:"bi:play-fill"}),C("activate")]}),(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"update"})&&(0,$.jsxs)(M.Z,{onClick:()=>{o(),W.onClose()},children:[(0,$.jsx)(R.Z,{icon:"fluent:edit-32-filled"}),C("edit")]}),(0,$.jsxs)(M.Z,{onClick:F.onOpen,children:[(0,$.jsx)(R.Z,{icon:"carbon:data-quality-definition"}),C("DDL")]})]}),(0,$.jsxs)(N.Z,{open:F.open,onClose:F.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,$.jsxs)(z.Z,{sx:{fontWeight:600},children:[C("creation time"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,K.zM)(v)}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("creator"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===w||void 0===w?void 0:w.email}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("creator IP"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:f}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("editing time"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,K.zM)(Z)}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("editor"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===y||void 0===y?void 0:y.email}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("editor IP"),":"]}),(0,$.jsx)(z.Z,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:_}),(0,$.jsxs)(z.Z,{sx:{pt:1,fontWeight:600},children:[C("modifications no"),": ",k]})]})]})}var V=s(36314),X=s(48550),Y=s(63466);function ee(e){let{filters:t,onFilters:s,onPrint:o,onDownload:n,canReset:a,onResetFilters:i}=e;const l=(0,N.S)(),{t:c}=(0,j.qM)(),h=(0,r.useCallback)((e=>{s("name",e.target.value)}),[s]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(V.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,$.jsxs)(V.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[(0,$.jsx)(X.Z,{fullWidth:!0,value:t.name,onChange:h,placeholder:c("Search name or number..."),InputProps:{startAdornment:(0,$.jsx)(Y.Z,{position:"start",children:(0,$.jsx)(R.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),(0,$.jsx)(p.Z,{onClick:l.onOpen,children:(0,$.jsx)(R.Z,{icon:"eva:more-vertical-fill"})})]}),a&&(0,$.jsx)(d.Z,{color:"error",sx:{flexShrink:0},onClick:i,startIcon:(0,$.jsx)(R.Z,{icon:"solar:trash-bin-trash-bold"}),children:c("clear")})]}),(0,$.jsxs)(N.Z,{open:l.open,onClose:l.onClose,arrow:"right-top",sx:{width:140},children:[(0,$.jsxs)(M.Z,{onClick:()=>{o(),l.onClose()},children:[(0,$.jsx)(R.Z,{icon:"solar:printer-minimalistic-bold"}),c("print")]}),(0,$.jsxs)(M.Z,{onClick:()=>{n(),l.onClose()},children:[(0,$.jsx)(R.Z,{icon:"solar:import-bold"}),"Import"]})]})]})}var te=s(85771),se=s(27938),oe=s(2540);function ne(e){let{filters:t,onFilters:s,onResetFilters:o,results:n,...r}=e;const{t:a}=(0,j.qM)(),i=(0,oe.l2)(t.startDate,t.endDate);return(0,$.jsxs)(V.Z,{spacing:1.5,...r,children:[(0,$.jsxs)(z.Z,{sx:{typography:"body2"},children:[(0,$.jsx)("strong",{children:n}),(0,$.jsx)(z.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:a("results found")})]}),(0,$.jsxs)(V.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:["all"!==t.status&&(0,$.jsx)(re,{label:a("status:"),children:(0,$.jsx)(te.Z,{size:"small",label:a(t.status),onDelete:()=>{s("status","all")}})}),t.startDate&&t.endDate&&(0,$.jsx)(re,{label:a("date:"),children:(0,$.jsx)(te.Z,{size:"small",label:i,onDelete:()=>{s("startDate",null),s("endDate",null)}})}),(0,$.jsx)(d.Z,{color:"error",onClick:o,startIcon:(0,$.jsx)(R.Z,{icon:"solar:trash-bin-trash-bold"}),children:a("clear")})]})]})}function re(e){let{label:t,children:s,sx:o,...n}=e;return(0,$.jsxs)(V.Z,{component:se.Z,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...o},...n,children:[(0,$.jsx)(z.Z,{component:"span",sx:{typography:"subtitle2"},children:t}),(0,$.jsx)(V.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:s})]})}const ae={name:"",status:"all"};function ie(){var e,t;const{t:s}=(0,j.qM)(),o=[{id:"code",label:s("code")},{id:"name",label:s("name")},{id:"start_time",label:s("start time")},{id:"end_time",label:s("end time")},{id:"status",label:s("status")},{id:"",width:88}],{STATUS_OPTIONS:B}=(0,I.D)(),{user:q}=(0,Z.E)(),z=(0,A.x6)({defaultOrderBy:"code"}),M=(0,r.useRef)(),E=(0,W.K$)(),U=(0,f.tv)(),Q=(0,b.k)(),G=(0,b.k)(),{workShiftsData:K,loading:N,refetch:V}=(0,H.lL)(null===q||void 0===q||null===(e=q.employee)||void 0===e||null===(t=e.employee_engagements[null===q||void 0===q?void 0:q.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id),[X,Y]=(0,r.useState)(ae),te=!(!X.startDate||!X.endDate)&&X.startDate.getTime()>X.endDate.getTime(),se=function(e){let{inputData:t,comparator:s,filters:o,dateError:n}=e;const{status:r,name:a}=o,i=t.map(((e,t)=>[e,t]));i.sort(((e,t)=>{const o=s(e[0],t[0]);return 0!==o?o:e[1]-t[1]})),t=i.map((e=>e[0])),a&&(t=t.filter((e=>{var t,s,o,n;return(null===e||void 0===e?void 0:e.name_english)&&-1!==(null===e||void 0===e?void 0:e.name_english.toLowerCase().indexOf(a.toLowerCase()))||(null===e||void 0===e?void 0:e.name_arabic)&&-1!==(null===e||void 0===e||null===(t=e.name_arabic)||void 0===t?void 0:t.toLowerCase().indexOf(a.toLowerCase()))||(null===e||void 0===e?void 0:e.employees)&&(null===e||void 0===e||null===(s=e.employees)||void 0===s?void 0:s.some((e=>-1!==e.employee.first_name.toLowerCase().indexOf(a.toLowerCase()))))||(null===e||void 0===e?void 0:e.employees)&&(null===e||void 0===e||null===(o=e.employees)||void 0===o?void 0:o.some((e=>-1!==e.employee.middle_name.toLowerCase().indexOf(a.toLowerCase()))))||(null===e||void 0===e?void 0:e.employees)&&(null===e||void 0===e||null===(n=e.employees)||void 0===n?void 0:n.some((e=>-1!==e.employee.family_name.toLowerCase().indexOf(a.toLowerCase()))))||(null===e||void 0===e?void 0:e._id)===a||JSON.stringify(e.code)===a})));"all"!==r&&(t=t.filter((e=>e.status===r)));return t}({inputData:K,comparator:(0,A.sQ)(z.order,z.orderBy),filters:X,dateError:te}),oe=se.slice(z.page*z.rowsPerPage,z.page*z.rowsPerPage+z.rowsPerPage),re=z.dense?52:72,ie=!(null===X||void 0===X||!X.name)||"all"!==X.status,le=!se.length&&ie||!se.length,ce=(0,_.useReactToPrint)({content:()=>M.current}),de=(0,r.useCallback)(((e,t)=>{z.onResetPage(),Y((s=>({...s,[e]:t})))}),[z]),he=(0,r.useCallback)((async e=>{try{await(0,L.Z)({method:"PATCH",path:"".concat(O.Hv.tables.workshift(e._id),"/updatestatus"),data:{status:"active"}}),y.W.emit("updated",{user:q,link:w.H.unitservice.tables.workshifts.root,msg:"activated a work shift <strong>".concat(e.name_english,"</strong>")})}catch(t){y.W.emit("error",{error:t,user:q,location:window.location.href}),console.error(t)}V(),z.onUpdatePageDeleteRow(oe.length)}),[oe.length,z,V,q]),ue=(0,r.useCallback)((async e=>{try{await(0,L.Z)({method:"PATCH",path:"".concat(O.Hv.tables.workshift(e._id),"/updatestatus"),data:{status:"inactive"}}),y.W.emit("updated",{user:q,link:w.H.unitservice.tables.workshifts.root,msg:"inactivated a work shift <strong>".concat(e.name_english,"</strong>")})}catch(t){y.W.emit("error",{error:t,user:q,location:window.location.href}),console.error(t)}V(),z.onUpdatePageDeleteRow(oe.length)}),[oe.length,z,V,q]),xe=(0,r.useCallback)((async()=>{try{await(0,L.Z)({method:"PATCH",path:"".concat(O.Hv.tables.workshifts,"/updatestatus"),data:{status:"active",ids:z.selected}}),y.W.emit("updated",{user:q,link:w.H.unitservice.tables.workshifts.root,msg:"activated many work shifts"})}catch(e){y.W.emit("error",{error:e,user:q,location:window.location.href}),console.error(e)}V(),z.onUpdatePageDeleteRows({totalRows:K.length,totalRowsInPage:oe.length,totalRowsFiltered:se.length})}),[se.length,oe.length,z,K,V,q]),ge=(0,r.useCallback)((async()=>{try{await(0,L.Z)({method:"PATCH",path:"".concat(O.Hv.tables.workshifts,"/updatestatus"),data:{status:"inactive",ids:z.selected}}),y.W.emit("updated",{user:q,link:w.H.unitservice.tables.workshifts.root,msg:"inactivated many work shifts"})}catch(e){y.W.emit("error",{error:e,user:q,location:window.location.href}),console.error(e)}V(),z.onUpdatePageDeleteRows({totalRows:K.length,totalRowsInPage:oe.length,totalRowsFiltered:se.length})}),[se.length,oe.length,z,K,V,q]),pe=(0,r.useCallback)((e=>{U.push(w.H.unitservice.tables.workshifts.edit(e))}),[U]),me=(0,r.useCallback)((()=>{Y(ae)}),[]),ve=(0,r.useCallback)(((e,t)=>{de("status",t)}),[de]);return N?(0,$.jsx)(T.a,{}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(x.Z,{maxWidth:!E.themeStretch&&"lg",children:[(0,$.jsx)(F.Z,{heading:s("work shifts"),links:[{name:s("dashboard"),href:w.H.unitservice.root},{name:s("work shifts")}],action:(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"create"})&&(0,$.jsx)(d.Z,{component:v.r,href:w.H.unitservice.tables.workshifts.new,variant:"contained",startIcon:(0,$.jsx)(R.Z,{icon:"mingcute:add-line"}),children:s("new work shift")}),sx:{mb:{xs:3,md:5}}}),(0,$.jsxs)(l.Z,{children:[(0,$.jsx)(i.Z,{value:X.status,onChange:ve,sx:{px:2.5,boxShadow:e=>"inset 0 -2px 0 0 ".concat((0,u.Fq)(e.palette.grey[500],.08))},children:B.map((e=>(0,$.jsx)(a.Z,{iconPosition:"end",value:e.value,label:e.label,icon:(0,$.jsxs)(P.Z,{lang:"ar",variant:"all"===e.value||e.value===X.status?"filled":"soft",color:("active"===e.value?"success":"inactive"===e.value&&"error")||"default",children:["all"===e.value&&K.length,"active"===e.value&&K.filter((e=>"active"===e.status)).length,"inactive"===e.value&&K.filter((e=>"inactive"===e.status)).length]})},e.value)))}),(0,$.jsx)(ee,{onPrint:ce,filters:X,onFilters:de,onDownload:()=>{const e=se.reduce(((e,t)=>{var s;return e.push({code:t.code,name:t.name_english,country:null===(s=t.country)||void 0===s?void 0:s.name_english,status:t.status}),e}),[]),t=k.P6.book_new(),s=k.P6.json_to_sheet(e);k.P6.book_append_sheet(t,s,"Sheet 1");const o=k.cW(t,{bookType:"xlsx",type:"array"}),n=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,C.saveAs)(n,"RoomsTable.xlsx")},canReset:ie,onResetFilters:me}),ie&&(0,$.jsx)(ne,{filters:X,onFilters:de,onResetFilters:me,results:se.length,sx:{p:2.5,pt:0}}),(0,$.jsxs)(m.Z,{children:[(0,$.jsx)(A.Z4,{numSelected:z.selected.length,rowCount:se.length,onSelectAllRows:e=>z.onSelectAllRows(e,se.map((e=>e._id))),action:(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"update"})&&(0,$.jsx)($.Fragment,{children:se.filter((e=>z.selected.includes(e._id))).some((e=>"inactive"===e.status))?(0,$.jsx)(h.Z,{title:"Activate all",children:(0,$.jsx)(p.Z,{color:"primary",onClick:Q.onTrue,children:(0,$.jsx)(R.Z,{icon:"codicon:run-all"})})}):(0,$.jsx)(h.Z,{title:"Inactivate all",children:(0,$.jsx)(p.Z,{color:"error",onClick:G.onTrue,children:(0,$.jsx)(R.Z,{icon:"iconoir:pause-solid"})})})}),color:(0,n.Z)({category:"unit_service",subcategory:"work_shift",acl:"update"})&&se.filter((e=>z.selected.includes(e._id))).some((e=>"inactive"===e.status))?"primary":"error"}),(0,$.jsx)(S.Z,{children:(0,$.jsxs)(c.Z,{ref:M,size:z.dense?"small":"medium",children:[(0,$.jsx)(A.K,{order:z.order,orderBy:z.orderBy,headLabel:o,rowCount:se.length,numSelected:z.selected.length,onSort:z.onSort,onSelectAllRows:e=>z.onSelectAllRows(e,se.map((e=>e._id)))}),(0,$.jsxs)(g.Z,{children:[se.slice(z.page*z.rowsPerPage,z.page*z.rowsPerPage+z.rowsPerPage).map((e=>(0,$.jsx)(J,{row:e,selected:z.selected.includes(e._id),onSelectRow:()=>z.onSelectRow(e._id),onActivate:()=>he(e),onInactivate:()=>ue(e),onEditRow:()=>pe(e._id)},e._id))),(0,$.jsx)(A.$W,{height:re,emptyRows:(0,A.fQ)(z.page,z.rowsPerPage,K.length)}),(0,$.jsx)(A.et,{notFound:le})]})]})})]}),(0,$.jsx)(A.S_,{count:se.length,page:z.page,rowsPerPage:z.rowsPerPage,onPageChange:z.onChangePage,onRowsPerPageChange:z.onChangeRowsPerPage,dense:z.dense,onChangeDense:z.onChangeDense})]})]}),(0,$.jsx)(D.Q,{open:G.value,onClose:G.onFalse,title:"Inactivate",content:(0,$.jsxs)($.Fragment,{children:["Are you sure want to Inactivate ",(0,$.jsxs)("strong",{children:[" ",z.selected.length," "]})," items?"]}),action:(0,$.jsx)(d.Z,{variant:"contained",color:"error",onClick:()=>{ge(),G.onFalse()},children:"Inactivate"})}),(0,$.jsx)(D.Q,{open:Q.value,onClose:Q.onFalse,title:"Activate",content:(0,$.jsxs)($.Fragment,{children:["Are you sure want to Activate ",(0,$.jsxs)("strong",{children:[" ",z.selected.length," "]})," items?"]}),action:(0,$.jsx)(d.Z,{variant:"contained",color:"primary",onClick:()=>{xe(),Q.onFalse()},children:"Activate"})})]})}function le(){return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(n.Z,{hasContent:!0,category:"unit_service",subcategory:"work_shift",acl:"read",children:[(0,$.jsx)(o.ql,{children:(0,$.jsx)("title",{children:"Work Shifts"})}),(0,$.jsx)(ie,{})]})})}}}]);
//# sourceMappingURL=8489.ddd3f607.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[57150],{57150:(e,n,i)=>{i.r(n),i.d(n,{default:()=>F});var o=i(29490),l=i(65043),s=i(29013),t=i(40360),r=i(77224),a=i(60778),d=i(92974),c=i(11238),u=i(72450),p=i(93141),x=i(12110),m=i(71806),h=i(73460),g=i(79650),v=i(48407),j=i(67132),y=i(7625),_=i(51440),b=i(67555),f=i(75950),w=i(81e3),A=i(26353),k=i(94814),C=i(68738),q=i(39652),P=i(17392),W=i(57442),S=i(35151),D=i(34624),M=i(70579);function z(e){let{row:n,selected:i,onEditRow:o}=e;const{sequence_number:l,title:s,description:t,created_at:r,user_creation:d,ip_address_user_creation:c,updated_at:u,user_modification:p,ip_address_user_modification:x,modifications_nums:m}=n,h=(0,D.f)(),g=(0,D.f)(),{t:v}=(0,a.WD)(),j=(0,M.jsxs)(C.A,{hover:!0,selected:i,children:[(0,M.jsx)(q.A,{align:"center",children:(0,M.jsx)(w.A,{children:l})}),(0,M.jsx)(q.A,{align:"center",children:s}),(0,M.jsx)(q.A,{align:"center",children:t}),(0,M.jsx)(q.A,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,M.jsx)(P.A,{color:h.open?"inherit":"default",onClick:o,children:(0,M.jsx)(S.A,{sx:{width:25,height:25,color:"info.main"},icon:"solar:eye-bold"})})})]});return(0,M.jsxs)(M.Fragment,{children:[j,(0,M.jsx)(D.A,{open:h.open,onClose:h.onClose,arrow:"right-top",sx:{width:140},children:(0,M.jsxs)(k.A,{lang:"ar",onClick:()=>{o(),h.onClose()},children:[(0,M.jsx)(S.A,{icon:"fluent:edit-32-filled"}),v("edit")]})}),(0,M.jsxs)(D.A,{open:g.open,onClose:g.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,M.jsxs)(w.A,{sx:{fontWeight:600},children:[v("creation time"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,M.jsx)(A.A,{primary:(0,W.ts)(r,"dd MMMMMMMM yyyy"),secondary:(0,W.ts)(r,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("created by"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===d||void 0===d?void 0:d.email}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("created by IP"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:c}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("editing time"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,M.jsx)(A.A,{primary:(0,W.ts)(u,"dd MMMMMMMM yyyy"),secondary:(0,W.ts)(u,"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{component:"span",typography:"caption"}})}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("editor"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===p||void 0===p?void 0:p.email}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("editor IP"),":"]}),(0,M.jsx)(w.A,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:x}),(0,M.jsxs)(w.A,{sx:{pt:1,fontWeight:600},children:[v("modifications no"),": ",m]})]})]})}var I=i(67932),R=i(11780);const T={name:""};function Y(){const e=(0,f.K2)({defaultOrderBy:"code"}),{t:n}=(0,a.WD)(),i=[{id:"code",label:n("code")},{id:"title",label:n("title")},{id:"description",label:n("description")},{id:"",width:120}],o=(0,l.useRef)(),s=(0,j.rd)(),{CheckListData:t,loading:d}=(0,y.XNk)(),[w,A]=(0,l.useState)(T),k=!(!w.startDate||!w.endDate)&&w.startDate.getTime()>w.endDate.getTime(),C=function(e){let{inputData:n,comparator:i,filters:o,dateError:l}=e;const{name:s}=o,t=n.map(((e,n,i)=>[e,n]));t.sort(((e,n)=>{const o=i(e[0],n[0]);return 0!==o?o:e[1]-n[1]})),n=t.map(((e,n)=>e[0])),s&&(n=n.filter((e=>{var n;return-1!==(null===e||void 0===e?void 0:e.name_english.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e?void 0:e.name_arabic)&&-1!==(null===e||void 0===e||null===(n=e.name_arabic)||void 0===n?void 0:n.toLowerCase().indexOf(s.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===s||JSON.stringify(e.code)===s})));return n}({inputData:t,comparator:(0,f.hz)(e.order,e.orderBy),filters:w,dateError:k}),q=!(null===w||void 0===w||!w.name),P=!C.length&&q||!C.length,W=(0,p.useReactToPrint)({content:()=>o.current}),S=(0,l.useCallback)(((n,i)=>{e.onResetPage(),A((e=>({...e,[n]:i})))}),[e]),D=(0,l.useCallback)((e=>{s.push(v.f.employee.checklist.edit(e))}),[s]),Y=(0,l.useCallback)((()=>{A(T)}),[]);return d?(0,M.jsx)(b.x,{}):(0,M.jsx)(r.A,{maxWidth:"xl",children:(0,M.jsxs)(x.A,{children:[(0,M.jsx)(I.A,{onPrint:W,filters:w,onFilters:S,onDownload:()=>{const e=C.reduce(((e,n)=>{var i;return e.push({code:n.code,name:n.name_english,country:null===(i=n.country)||void 0===i?void 0:i.name_english,status:n.status}),e}),[]),n=c.Wp.book_new(),i=c.Wp.json_to_sheet(e);c.Wp.book_append_sheet(n,i,"Sheet 1");const o=c.M9(n,{bookType:"xlsx",type:"array"}),l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,u.saveAs)(l,"checklist.xlsx")},canReset:q,onResetFilters:Y}),q&&(0,M.jsx)(R.A,{filters:w,onFilters:S,onResetFilters:Y,results:C.length,sx:{p:2.5,pt:0}}),(0,M.jsx)(g.A,{children:(0,M.jsx)(_.A,{children:(0,M.jsxs)(m.A,{ref:o,size:e.dense?"small":"medium",children:[(0,M.jsx)(f.er,{order:e.order,orderBy:e.orderBy,headLabel:i,rowCount:C.length,numSelected:e.selected.length,onSort:e.onSort}),(0,M.jsxs)(h.A,{children:[C.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map(((n,i)=>(0,M.jsx)(z,{row:n,selected:e.selected.includes(n._id),onSelectRow:()=>e.onSelectRow(n._id),onEditRow:()=>D(n._id)},i))),(0,M.jsx)(f.Sm,{notFound:P})]})]})})}),(0,M.jsx)(f.We,{count:C.length,page:e.page,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onRowsPerPageChange:e.onChangeRowsPerPage,dense:e.dense,onChangeDense:e.onChangeDense})]})})}function B(){const[e,n]=(0,l.useState)("create"),i=(0,l.useCallback)(((e,i)=>{n(i)}),[]),{t:o}=(0,a.WD)(),c=[{value:"create",label:o("create your custom checklist")},{value:"select",label:o("select from general checklist")}];return(0,M.jsxs)(r.A,{maxWidth:"xl",children:[(0,M.jsx)(s.A,{value:e,onChange:i,sx:{mb:{xs:3,md:5}},children:c.map(((e,n)=>(0,M.jsx)(t.A,{label:e.label,value:e.value},n)))}),"select"===e&&(0,M.jsx)(Y,{}),"create"===e&&(0,M.jsx)(d.A,{})]})}function F(){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(o.mg,{children:[(0,M.jsx)("title",{children:" Dashboard : Create a new checklist"}),(0,M.jsx)("meta",{name:"description",content:"meta"})]}),(0,M.jsx)(B,{})]})}},92974:(e,n,i)=>{i.d(n,{A:()=>W});var o=i(80899),l=i(46987),s=i(65043),t=i(18403),r=i(24858),a=i(70837),d=i(12110),c=i(74600),u=i(38246),p=i(77224),x=i(94496),m=i(94814),h=i(39336),g=i(81e3),v=i(49633),j=i(14256),y=i(17392),_=i(48407),b=i(67132),f=i(31673),w=i(75139),A=i(60778),k=i(7625),C=i(35151),q=i(59699),P=i(70579);function W(e){var n,i,j,y,W,D;let{currentRow:M}=e;const z=(0,b.rd)(),{enqueueSnackbar:I}=(0,l.dh)(),{user:R}=(0,w.Z)(),{t:T}=(0,A.WD)(),{currentLang:Y}=(0,A.jc)(),B="ar"===Y.value,F=o.Ik().shape({title:o.Yj().nullable().required("title is required"),description:o.Yj(),unit_service:o.Yj().nullable(),department:o.Yj().nullable(),work_group:o.Yj().nullable(),general:o.lc(),questions:o.YO().of(o.Ik({question:o.Yj().required(T("required field")),answer_way:o.Yj().required(T("required field")),category:o.Yj(),options:o.YO().nullable()}))}),{workGroupsData:L}=(0,k.VnY)(null===R||void 0===R||null===(n=R.employee)||void 0===n||null===(i=n.employee_engagements)||void 0===i||null===(j=i[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===j?void 0:j._id),O=(0,s.useMemo)((()=>({title:(null===M||void 0===M?void 0:M.title)||"",unit_service:(null===M||void 0===M?void 0:M.unit_service)||null,department:(null===M||void 0===M?void 0:M.department)||null,work_group:(null===M||void 0===M?void 0:M.work_group)||null,general:(null===M||void 0===M?void 0:M.general)||!1,description:(null===M||void 0===M?void 0:M.description)||"",questions:(null===M||void 0===M?void 0:M.questions)||[{question:"",answer_way:"Text",category:"",options:[""]}]})),[M]),E=(0,r.mN)({resolver:(0,t.t)(F),defaultValues:O}),{reset:$,handleSubmit:N,control:V,watch:X,setValue:Z,formState:{isSubmitting:J}}=E,G=X(),{fields:H,append:K,remove:Q,move:U}=(0,r.jz)({control:V,name:"questions"});(0,s.useEffect)((()=>{var e,n,i,o;$({title:(null===M||void 0===M?void 0:M.title)||"",unit_service:(null===M||void 0===M?void 0:M.unit_service)||(null===R||void 0===R||null===(e=R.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(i=n[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===i||null===(o=i.unit_service)||void 0===o?void 0:o._id),department:(null===M||void 0===M?void 0:M.department)||null,work_group:(null===M||void 0===M?void 0:M.work_group)||null,general:(null===M||void 0===M?void 0:M.general)||!1,description:(null===M||void 0===M?void 0:M.description)||"",questions:(null===M||void 0===M?void 0:M.questions)||[{question:"",answer_way:"Text",category:"",options:[""]}]})}),[M,$,null===R||void 0===R?void 0:R.employee]);const ee=N((async e=>{try{if(M&&M.user_creation===R._id)await f.Ay.patch(f.vZ.checklist.one(M._id),e),I(T("updated successfuly"));else{var n,i,o;delete e._id;const l={...e,questions:e.questions.map((e=>({question:null===e||void 0===e?void 0:e.question,answer_way:null===e||void 0===e?void 0:e.answer_way,options:null===e||void 0===e?void 0:e.options}))),employee:null===R||void 0===R||null===(n=R.employee)||void 0===n||null===(i=n.employee_engagements)||void 0===i||null===(o=i[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===o?void 0:o._id};await f.Ay.post(f.vZ.checklist.all,l),I(T("created successfuly"))}$(),z.push(_.f.employee.checklist.root)}catch(l){I(l.message,{variant:"error"}),console.error(l)}}));return(0,P.jsx)(p.A,{maxWidth:"xl",children:(0,P.jsxs)(q.Ay,{methods:E,children:[(0,P.jsx)(d.A,{children:(0,P.jsxs)(c.A,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:1,p:3},alignItems:"center",children:[(0,P.jsxs)(c.A,{spacing:2,sx:{width:1},alignItems:"center",justifyContent:"flex-start",children:[(0,P.jsx)(q.o3,{name:"title",label:T("title"),sx:{width:{md:.8,xs:1}}}),(0,P.jsx)(q.o3,{size:"small",name:"description",label:T("description"),sx:{width:{md:.7,xs:1}}})]}),(0,P.jsxs)(c.A,{sx:{width:{md:.5,xs:1},border:"0.5px dotted black",padding:2},justifyContent:"flex-end",children:[(0,P.jsxs)(x.A,{variant:"caption",mb:2,children:[T("availability and privacy"),":"]}),(0,P.jsx)(q.SF,{name:"general",label:T("available for all hakeemna community"),onChange:()=>Z("general",!G.general)}),(0,P.jsx)(q.SF,{name:"unit_service",label:T("available for your unit of service employees"),onChange:()=>{var e,n,i,o;return Z("unit_service",G.unit_service?null:null===R||void 0===R||null===(e=R.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(i=n[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===i||null===(o=i.unit_service)||void 0===o?void 0:o._id)}}),(null===R||void 0===R||null===(y=R.employee)||void 0===y||null===(W=y.employee_engagements)||void 0===W||null===(D=W[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===D?void 0:D.department)&&(0,P.jsx)(q.SF,{name:"department",label:T("available for your department employees"),onChange:()=>{var e,n,i,o;return Z("department",G.department?null:null===R||void 0===R||null===(e=R.employee)||void 0===e||null===(n=e.employee_engagements)||void 0===n||null===(i=n[null===R||void 0===R?void 0:R.employee.selected_engagement])||void 0===i||null===(o=i.department)||void 0===o?void 0:o._id)}}),(0,P.jsxs)(q.tX,{size:"small",name:"work_group",label:T("available for work group"),sx:{width:{md:1,xs:1},mt:2},children:[(0,P.jsx)(m.A,{sx:{textTransform:"capitalize"},value:null,children:T("all")}),(0,P.jsx)(h.A,{}),L.map(((e,n)=>(0,P.jsx)(m.A,{value:e._id,children:B?e.name_arabic:e.name_english},n)))]})]})]})}),(0,P.jsxs)(g.A,{sx:{p:3},children:[(0,P.jsxs)(x.A,{variant:"h6",sx:{color:"text.disabled",mb:3},children:[T("questions"),":"]}),(0,P.jsx)(a.JY,{onDragEnd:e=>{e.destination&&U(e.source.index,e.destination.index)},children:(0,P.jsx)(a.gL,{droppableId:"droppable-questions",children:e=>(0,P.jsxs)(c.A,{spacing:4,...e.droppableProps,ref:e.innerRef,children:[H.map(((e,n)=>(0,P.jsx)(a.sx,{draggableId:e.id,index:n,children:e=>(0,P.jsx)(d.A,{sx:{p:3},ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,children:(0,P.jsx)(c.A,{alignItems:"flex-end",spacing:1.5,children:(0,P.jsxs)(c.A,{spacing:2,sx:{width:1},children:[(0,P.jsxs)(c.A,{direction:{xs:"column",md:"row"},justifyContent:"space-between",spacing:2,sx:{width:1},children:[(0,P.jsx)(q.o3,{size:"small",name:`questions[${n}].question`,label:T("question"),InputLabelProps:{shrink:!0},sx:{width:1}}),(0,P.jsx)(q.tX,{name:`questions[${n}].answer_way`,size:"small",label:T("answer way"),InputLabelProps:{shrink:!0},sx:{width:{md:.5,xs:1}},children:["Text","Yes No","Options"].map((e=>(0,P.jsx)(m.A,{value:e,children:T(e)},e)))}),(0,P.jsx)(q.o3,{size:"small",name:`questions[${n}].category`,label:T("category"),InputLabelProps:{shrink:!0},sx:{width:{md:.5,xs:1}}}),(0,P.jsx)(v.A,{size:"small",color:"error",onClick:()=>(e=>{Q(e)})(n),children:(0,P.jsx)(C.A,{icon:"solar:trash-bin-trash-bold"})})]}),"Options"===G.questions[n].answer_way&&(0,P.jsx)(c.A,{justifyContent:"flex-end",alignItems:"start",spacing:1,sx:{width:.8},children:(0,P.jsx)(S,{index:n})})]})})})},e.id))),e.placeholder]})})}),(0,P.jsx)(h.A,{sx:{my:3,borderStyle:"dashed"}}),(0,P.jsx)(c.A,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,P.jsx)(v.A,{size:"small",color:"primary",startIcon:(0,P.jsx)(C.A,{icon:"mingcute:add-line"}),onClick:()=>{K({question:"",answer_way:"Text",options:[""]})},sx:{flexShrink:0},children:T("add item")})})]}),(0,P.jsx)(c.A,{justifyContent:"flex-end",direction:"row",spacing:2,sx:{mt:1},children:(0,P.jsx)(u.A,{variant:"contained",loading:J,onClick:ee,children:M&&M.user_creation===R._id?T("update"):T("add")})})]})})}function S(e){let{index:n}=e;const{control:i}=(0,r.xW)(),{t:o}=(0,A.WD)(),{fields:l,append:s,remove:t}=(0,r.jz)({control:i,name:`questions[${n}].options`});return(0,P.jsxs)(P.Fragment,{children:[l.map(((e,i)=>(0,P.jsxs)(c.A,{direction:"row",alignItems:"center",children:[(0,P.jsx)(j.A,{disabled:!0}),(0,P.jsx)(q.o3,{size:"small",variant:"standard",name:`questions[${n}].options[${i}]`}),(0,P.jsx)(c.A,{direction:"row",children:(0,P.jsx)(y.A,{size:"small",color:"error",onClick:()=>(e=>{t(e)})(i),children:(0,P.jsx)(C.A,{icon:"ic:round-close"})})})]},e.id))),(0,P.jsxs)(v.A,{color:"primary",size:"small",sx:{fontSize:12},onClick:()=>{s(" ")},children:[(0,P.jsx)(C.A,{icon:"ph:plus-bold"}),o("add option")]})]})}}}]);
//# sourceMappingURL=57150.cb5e9c37.chunk.js.map
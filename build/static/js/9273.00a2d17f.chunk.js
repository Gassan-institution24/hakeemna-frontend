"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[9273],{89273:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Me});var r=o(6907),n=o(19208),i=o(66630),s=o(72791),a=o(53767),l=o(10266),c=o(24308),d=o(38072),p=o(84802),u=o(66664),h=o(25279),m=o(57621),x=o(9585),v=o(61889),g=o(48550),Z=o(82626),f=o(20068),y=o(49900),j=o(80184);const w=["very urgent","urgent","normal"];function b(e){var t,o,r;let{ticket:n,refetch:l}=e;const{enqueueSnackbar:c}=(0,p.Ds)(),{ticketCategoriesData:d}=(0,i.lek)(),{usersData:h}=(0,i.w4s)({role:"superadmin"}),[b,C]=(0,s.useState)(n.priority),[T,R]=(0,s.useState)(n.category._id),[S,k]=(0,s.useState)(null===(t=n.assigned_to)||void 0===t?void 0:t._id);return(0,j.jsxs)(m.Z,{children:[(0,j.jsx)(x.Z,{title:"Ticket Info"}),(0,j.jsx)(a.Z,{direction:"row",sx:{p:3},children:(0,j.jsxs)(v.ZP,{sx:{p:4},container:!0,spacing:3,rowGap:2,children:[[{label:"user",value:null===n||void 0===n||null===(o=n.user_creation)||void 0===o?void 0:o.email},{label:"role",value:null===n||void 0===n||null===(r=n.user_creation)||void 0===r?void 0:r.role},{label:"category",value:(0,j.jsx)(g.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:T,onChange:e=>{try{u.ZP.patch(u.Hv.tickets.one(n._id),{category:e.target.value}),R(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:d.map(((e,t)=>(0,j.jsx)(Z.Z,{value:e._id,children:e.name_english},t)))})},{label:"priority",value:(0,j.jsx)(g.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:b,onChange:e=>{try{u.ZP.patch(u.Hv.tickets.one(n._id),{priority:e.target.value}),C(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:w.map(((e,t)=>(0,j.jsx)(Z.Z,{value:e,children:e},t)))})},{label:"URL",value:(0,j.jsxs)(f.Z,{title:n.URL.length>20&&n.URL,children:[" ",n.URL.length>20?"".concat(n.URL.slice(0,20),".."):n.URL]})},{label:"assigned to",value:(0,j.jsx)(g.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:S,onChange:e=>{try{u.ZP.patch(u.Hv.tickets.one(n._id),{assigned_to:e.target.value}),k(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:h.map(((e,t)=>(0,j.jsx)(Z.Z,{value:e._id,children:e.email},t)))})}].map(((e,t)=>(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(v.ZP,{xs:12,md:6,children:(0,j.jsx)(y.Z,{primary:e.label,secondary:e.value,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5,mr:2},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}})})}))),(0,j.jsx)(v.ZP,{xs:12,children:(0,j.jsx)(y.Z,{primary:"details",secondary:n.details,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}})})]})})]})}var C=o(99116),T=o(8976),R=o(38622),S=o(20751),k=o(71351);function M(e){var t;let{ticket:o}=e;const{user:r}=(0,T.E)(),{conversation:n,refetch:i}=(0,R.hE)(o.chat),l=n?null===(t=n.participants)||void 0===t?void 0:t.filter((e=>e._id!==r._id)):[];return(0,s.useEffect)((()=>{C.Z.on("message",(e=>{e===o.chat&&i()}))}),[]),(0,j.jsx)(m.Z,{sx:{width:1,height:600,overflow:"hidden"},children:(0,j.jsxs)(a.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,j.jsx)(a.Z,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:"Chat"}),(0,j.jsx)(a.Z,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:e=>"solid 1px ".concat(e.palette.divider)},children:(0,j.jsxs)(a.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,j.jsx)(S.Z,{messages:null===n||void 0===n?void 0:n.messages,participants:l}),(0,j.jsx)(k.Z,{selectedConversationId:o.chat,refetch:i})]})})]})})}var P=o(13838),N=o(13400),_=o(4567),A=o(4419),H=o(9145),I=o(84954),D=o(40268),L=o(24845);function O(e){let{status:t,backLink:o,ticket:r,statusOptions:n,onChangeStatus:i}=e;const s=(0,L.S)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(a.Z,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[(0,j.jsxs)(a.Z,{spacing:1,direction:"row",alignItems:"flex-start",children:[(0,j.jsx)(N.Z,{component:A.r,href:o,children:(0,j.jsx)(D.Z,{icon:"eva:arrow-ios-back-fill"})}),(0,j.jsxs)(a.Z,{spacing:.5,children:[(0,j.jsxs)(a.Z,{spacing:1,direction:"row",alignItems:"center",children:[(0,j.jsxs)(_.Z,{variant:"h4",children:[" ",null===r||void 0===r?void 0:r.subject," "]}),(0,j.jsx)(I.Z,{variant:"soft",color:("pending"===t?"warning":"waiting"===t&&"secondary")||"processing"===t&&"info"||"completed"===t&&"success"||"closed"===t&&"error"||"default",children:t})]}),(0,j.jsx)(_.Z,{variant:"body2",sx:{color:"text.disabled"},children:(0,H.zM)(r.created_at)})]})]}),(0,j.jsx)(a.Z,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,j.jsx)(P.Z,{color:"inherit",variant:"outlined",endIcon:(0,j.jsx)(D.Z,{icon:"eva:arrow-ios-downward-fill"}),onClick:s.onOpen,sx:{textTransform:"capitalize"},children:t})})]}),(0,j.jsx)(L.Z,{open:s.open,onClose:s.onClose,arrow:"top-right",sx:{width:140},children:null===n||void 0===n?void 0:n.map((e=>(0,j.jsx)(Z.Z,{selected:e===t,onClick:()=>{s.onClose(),i(e)},children:e},e)))})]})}var U=o(16029),z=o(87462),G=o(63366);function E(e){var t,o,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(o=E(e[t]))&&(r&&(r+=" "),r+=o);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}const q=function(){for(var e,t,o=0,r="";o<arguments.length;)(e=arguments[o++])&&(t=E(e))&&(r&&(r+=" "),r+=t);return r};var F=o(20838),W=o(66934),B=o(31402);const K=s.createContext({});var $=o(64657),J=o(59703);function Q(e){return(0,$.ZP)("MuiTimeline",e)}(0,J.Z)("MuiTimeline",["root","positionLeft","positionRight","positionAlternate","positionAlternateReverse"]);var V=o(14036);function X(e){return"alternate-reverse"===e?"positionAlternateReverse":"position".concat((0,V.Z)(e))}const Y=["position","className"],ee=(0,W.ZP)("ul",{name:"MuiTimeline",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.position&&t[X(o.position)]]}})({display:"flex",flexDirection:"column",padding:"6px 16px",flexGrow:1}),te=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimeline"}),{position:r="right",className:n}=o,i=(0,G.Z)(o,Y),a=(0,z.Z)({},o,{position:r}),l=(e=>{const{position:t,classes:o}=e,r={root:["root",t&&X(t)]};return(0,F.Z)(r,Q,o)})(a),c=s.useMemo((()=>({position:r})),[r]);return(0,j.jsx)(K.Provider,{value:c,children:(0,j.jsx)(ee,(0,z.Z)({className:q(l.root,n),ownerState:a,ref:t},i))})}));function oe(e){return(0,$.ZP)("MuiTimelineDot",e)}(0,J.Z)("MuiTimelineDot",["root","filled","outlined","filledGrey","outlinedGrey","filledPrimary","outlinedPrimary","filledSecondary","outlinedSecondary"]);const re=["className","color","variant"],ne=(0,W.ZP)("span",{name:"MuiTimelineDot",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t["inherit"!==o.color&&"".concat(o.variant).concat((0,V.Z)(o.color))],t[o.variant]]}})((e=>{let{ownerState:t,theme:o}=e;return(0,z.Z)({display:"flex",alignSelf:"baseline",borderStyle:"solid",borderWidth:2,padding:4,borderRadius:"50%",boxShadow:(o.vars||o).shadows[1],margin:"11.5px 0"},"filled"===t.variant&&(0,z.Z)({borderColor:"transparent"},"inherit"!==t.color&&(0,z.Z)({},"grey"===t.color?{color:(o.vars||o).palette.grey[50],backgroundColor:(o.vars||o).palette.grey[400]}:{color:(o.vars||o).palette[t.color].contrastText,backgroundColor:(o.vars||o).palette[t.color].main})),"outlined"===t.variant&&(0,z.Z)({boxShadow:"none",backgroundColor:"transparent"},"inherit"!==t.color&&(0,z.Z)({},"grey"===t.color?{borderColor:(o.vars||o).palette.grey[400]}:{borderColor:(o.vars||o).palette[t.color].main})))})),ie=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimelineDot"}),{className:r,color:n="grey",variant:i="filled"}=o,s=(0,G.Z)(o,re),a=(0,z.Z)({},o,{color:n,variant:i}),l=(e=>{const{color:t,variant:o,classes:r}=e,n={root:["root",o,"inherit"!==t&&"".concat(o).concat((0,V.Z)(t))]};return(0,F.Z)(n,oe,r)})(a);return(0,j.jsx)(ne,(0,z.Z)({className:q(l.root,r),ownerState:a,ref:t},s))}));function se(e){return(0,$.ZP)("MuiTimelineContent",e)}const ae=(0,J.Z)("MuiTimelineContent",["root","positionLeft","positionRight","positionAlternate","positionAlternateReverse"]),le=["className"],ce=(0,W.ZP)(_.Z,{name:"MuiTimelineContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[X(o.position)]]}})((e=>{let{ownerState:t}=e;return(0,z.Z)({flex:1,padding:"6px 16px",textAlign:"left"},"left"===t.position&&{textAlign:"right"})})),de=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimelineContent"}),{className:r}=o,n=(0,G.Z)(o,le),{position:i}=s.useContext(K),a=(0,z.Z)({},o,{position:i||"right"}),l=(e=>{const{position:t,classes:o}=e,r={root:["root",X(t)]};return(0,F.Z)(r,se,o)})(a);return(0,j.jsx)(ce,(0,z.Z)({component:"div",className:q(l.root,r),ownerState:a,ref:t},n))}));function pe(e){return(0,$.ZP)("MuiTimelineSeparator",e)}(0,J.Z)("MuiTimelineSeparator",["root"]);const ue=["className"],he=(0,W.ZP)("div",{name:"MuiTimelineSeparator",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"flex",flexDirection:"column",flex:0,alignItems:"center"}),me=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimelineSeparator"}),{className:r}=o,n=(0,G.Z)(o,ue),i=o,s=(e=>{const{classes:t}=e;return(0,F.Z)({root:["root"]},pe,t)})(i);return(0,j.jsx)(he,(0,z.Z)({className:q(s.root,r),ownerState:i,ref:t},n))}));function xe(e){return(0,$.ZP)("MuiTimelineConnector",e)}(0,J.Z)("MuiTimelineConnector",["root"]);const ve=["className"],ge=(0,W.ZP)("span",{name:"MuiTimelineConnector",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{width:2,backgroundColor:(t.vars||t).palette.grey[400],flexGrow:1}})),Ze=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimelineConnector"}),{className:r}=o,n=(0,G.Z)(o,ve),i=o,s=(e=>{const{classes:t}=e;return(0,F.Z)({root:["root"]},xe,t)})(i);return(0,j.jsx)(ge,(0,z.Z)({className:q(s.root,r),ownerState:i,ref:t},n))}));function fe(e){return(0,$.ZP)("MuiTimelineItem",e)}const ye=(0,J.Z)("MuiTimelineItem",["root","positionLeft","positionRight","positionAlternate","positionAlternateReverse","missingOppositeContent"]);var je=o(13701);const we=(0,J.Z)("MuiTimelineOppositeContent",["root","positionLeft","positionRight","positionAlternate","positionAlternateReverse"]),be=["position","className"],Ce=(0,W.ZP)("li",{name:"MuiTimelineItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[X(o.position)]]}})((e=>{let{ownerState:t}=e;return(0,z.Z)({listStyle:"none",display:"flex",position:"relative",minHeight:70},"left"===t.position&&{flexDirection:"row-reverse"},("alternate"===t.position||"alternate-reverse"===t.position)&&{["&:nth-of-type(".concat("alternate"===t.position?"even":"odd",")")]:{flexDirection:"row-reverse",["& .".concat(ae.root)]:{textAlign:"right"},["& .".concat(we.root)]:{textAlign:"left"}}},!t.hasOppositeContent&&{"&:before":{content:'""',flex:1,padding:"6px 16px"}})})),Te=s.forwardRef((function(e,t){const o=(0,B.Z)({props:e,name:"MuiTimelineItem"}),{position:r,className:n}=o,i=(0,G.Z)(o,be),{position:a}=s.useContext(K);let l=!1;s.Children.forEach(o.children,(e=>{(0,je.Z)(e,["TimelineOppositeContent"])&&(l=!0)}));const c=(0,z.Z)({},o,{position:r||a||"right",hasOppositeContent:l}),d=(e=>{const{position:t,classes:o,hasOppositeContent:r}=e,n={root:["root",X(t),!r&&"missingOppositeContent"]};return(0,F.Z)(n,fe,o)})(c),p=s.useMemo((()=>({position:c.position})),[c.position]);return(0,j.jsx)(K.Provider,{value:p,children:(0,j.jsx)(Ce,(0,z.Z)({className:q(d.root,n),ownerState:c,ref:t},i))})}));var Re=o(10261);function Se(e){let{history:t}=e;const o=(0,j.jsx)(te,{sx:{p:0,m:0,["& .".concat(ye.root,":before")]:{flex:0,padding:0}},children:null===t||void 0===t?void 0:t.map(((e,o)=>{var r;const n=0===o,i=o===t.length-1;return(0,j.jsxs)(Te,{children:[(0,j.jsxs)(me,{children:[(0,j.jsx)(ie,{color:n?"primary":"grey"}),i?null:(0,j.jsx)(Ze,{})]}),(0,j.jsxs)(de,{children:[(0,j.jsx)(_.Z,{variant:"subtitle2",children:e.note}),(0,j.jsxs)(a.Z,{direction:"row",gap:5,children:[(0,j.jsx)(U.Z,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:(0,H.zM)(e.date)}),(0,j.jsx)(U.Z,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:null===(r=e.user)||void 0===r?void 0:r.email})]})]})]},e.note)}))});return(0,j.jsxs)(m.Z,{children:[(0,j.jsx)(x.Z,{title:"History"}),(0,j.jsx)(Re.Z,{spacing:3,alignItems:{md:"flex-start"},direction:{xs:"column-reverse",md:"row"},sx:{p:3,mt:2,height:"400px"},children:o})]})}function ke(e){let{ticket:t,refetch:o}=e;const r=(0,h.K$)(),{enqueueSnackbar:n}=(0,p.Ds)(),[i,m]=(0,s.useState)(t.status),x=(0,s.useCallback)((e=>{try{u.ZP.patch(u.Hv.tickets.one(t._id),{status:e}),m(e),n("changed successfully!"),o()}catch(r){n(r.message),o()}}),[t._id,n,o]);return(0,j.jsxs)(l.Z,{maxWidth:!r.themeStretch&&"lg",children:[(0,j.jsx)(O,{backLink:d.H.superadmin.communication.root,ticket:t,status:i,refetch:o,onChangeStatus:x,statusOptions:["pending","processing","waiting","completed","closed"]}),(0,j.jsxs)(c.Z,{container:!0,spacing:3,children:[(0,j.jsx)(c.Z,{xs:12,md:7,children:(0,j.jsxs)(a.Z,{spacing:3,direction:{xs:"column-reverse",md:"column"},children:[(0,j.jsx)(b,{ticket:t,refetch:o}),(0,j.jsx)(Se,{history:t.history})]})}),(0,j.jsx)(c.Z,{xs:12,md:5,children:(0,j.jsx)(M,{ticket:t})})]})]})}function Me(){const{id:e}=(0,n.UO)(),{data:t,refetch:o}=(0,i.NC4)(e);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.ql,{children:[(0,j.jsx)("title",{children:" Ticket info "}),(0,j.jsx)("meta",{name:"description",content:"meta"})]}),t&&(0,j.jsx)(ke,{ticket:t,refetch:o})]})}},9585:(e,t,o)=>{o.d(t,{Z:()=>j});var r=o(63366),n=o(87462),i=o(72791),s=o(59278),a=o(20838),l=o(4567),c=o(31402),d=o(66934),p=o(59703),u=o(64657);function h(e){return(0,u.ZP)("MuiCardHeader",e)}const m=(0,p.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var x=o(80184);const v=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],g=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,n.Z)({["& .".concat(m.title)]:t.title,["& .".concat(m.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),Z=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),f=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),y=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),j=i.forwardRef((function(e,t){const o=(0,c.Z)({props:e,name:"MuiCardHeader"}),{action:i,avatar:d,className:p,component:u="div",disableTypography:m=!1,subheader:j,subheaderTypographyProps:w,title:b,titleTypographyProps:C}=o,T=(0,r.Z)(o,v),R=(0,n.Z)({},o,{component:u,disableTypography:m}),S=(e=>{const{classes:t}=e;return(0,a.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},h,t)})(R);let k=b;null==k||k.type===l.Z||m||(k=(0,x.jsx)(l.Z,(0,n.Z)({variant:d?"body2":"h5",className:S.title,component:"span",display:"block"},C,{children:k})));let M=j;return null==M||M.type===l.Z||m||(M=(0,x.jsx)(l.Z,(0,n.Z)({variant:d?"body2":"body1",className:S.subheader,color:"text.secondary",component:"span",display:"block"},w,{children:M}))),(0,x.jsxs)(g,(0,n.Z)({className:(0,s.Z)(S.root,p),as:u,ref:t,ownerState:R},T,{children:[d&&(0,x.jsx)(Z,{className:S.avatar,ownerState:R,children:d}),(0,x.jsxs)(y,{className:S.content,ownerState:R,children:[k,M]}),i&&(0,x.jsx)(f,{className:S.action,ownerState:R,children:i})]}))}))}}]);
//# sourceMappingURL=9273.00a2d17f.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[69],{40069:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Q});var a=s(6907),r=s(19208),n=s(93011),i=s(72791),o=s(53767),l=s(10266),c=s(24308),d=s(38072),h=s(84802),p=s(66664),u=s(65833),x=s(57621),m=s(9585),g=s(61889),v=s(48550),y=s(82626),Z=s(20068),j=s(49900),f=s(13838),b=s(80184);const w=["very urgent","urgent","normal"];function k(e){var t,s,a;let{ticket:r,refetch:l}=e;const{enqueueSnackbar:c}=(0,h.Ds)(),{ticketCategoriesData:d}=(0,n.lek)(),{usersData:u}=(0,n.w4s)({role:"superadmin"}),[k,C]=(0,i.useState)(r.note),[_,P]=(0,i.useState)(r.priority),[S,T]=(0,i.useState)(r.category._id),[H,R]=(0,i.useState)(null===(t=r.assigned_to)||void 0===t?void 0:t._id);return(0,b.jsxs)(x.Z,{children:[(0,b.jsx)(m.Z,{title:"Ticket Info"}),(0,b.jsx)(o.Z,{direction:"row",sx:{p:3},children:(0,b.jsxs)(g.ZP,{sx:{p:4},container:!0,spacing:3,rowGap:2,children:[[{label:"user",value:null===r||void 0===r||null===(s=r.user_creation)||void 0===s?void 0:s.email},{label:"role",value:null===r||void 0===r||null===(a=r.user_creation)||void 0===a?void 0:a.role},{label:"category",value:(0,b.jsx)(v.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:S,onChange:e=>{try{p.ZP.patch(p.Hv.tickets.one(r._id),{category:e.target.value}),T(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:d.map(((e,t)=>(0,b.jsx)(y.Z,{value:e._id,children:e.name_english},t)))})},{label:"priority",value:(0,b.jsx)(v.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:_,onChange:e=>{try{p.ZP.patch(p.Hv.tickets.one(r._id),{priority:e.target.value}),P(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:w.map(((e,t)=>(0,b.jsx)(y.Z,{value:e,children:e},t)))})},{label:"URL",value:(0,b.jsxs)(Z.Z,{title:r.URL.length>20&&r.URL,children:[" ",r.URL.length>20?"".concat(r.URL.slice(0,20),".."):r.URL]})},{label:"assigned to",value:(0,b.jsx)(v.Z,{select:!0,variant:"standard",size:"small",sx:{width:150},value:H,onChange:e=>{try{p.ZP.patch(p.Hv.tickets.one(r._id),{assigned_to:e.target.value}),R(e.target.value),c("changed successfully!"),l()}catch(t){c(t.message),l()}},children:u.map(((e,t)=>(0,b.jsx)(y.Z,{value:e._id,children:e.email},t)))})}].map(((e,t)=>(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g.ZP,{xs:12,md:6,children:(0,b.jsx)(j.Z,{primary:e.label,secondary:e.value,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5,mr:2},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}})})}))),(0,b.jsxs)(g.ZP,{xs:12,children:[(0,b.jsx)(j.Z,{primary:"details",secondary:r.details,primaryTypographyProps:{typography:"body2",color:"text.secondary",mb:.5},secondaryTypographyProps:{typography:"subtitle2",color:"text.primary",component:"span"}}),(0,b.jsxs)(o.Z,{direction:"row",alignItems:"flex-end",children:[(0,b.jsx)(v.Z,{variant:"standard",sx:{width:1,mt:2},label:"Note",value:k,onChange:e=>C(e.target.value)}),k!==r.note&&(0,b.jsx)(f.Z,{onClick:e=>{try{p.ZP.patch(p.Hv.tickets.one(r._id),{note:k}),c("changed successfully!"),l()}catch(t){c(t.message),l()}},sx:{height:30},children:"\u2713"})]})]})]})})]})}var C=s(99116),_=s(8976),P=s(38622),S=s(20751),T=s(71351);function H(e){var t;let{ticket:s}=e;const{user:a}=(0,_.E)(),{conversation:r,refetch:n}=(0,P.hE)(s.chat),l=r?null===(t=r.participants)||void 0===t?void 0:t.filter((e=>e._id!==a._id)):[];return(0,i.useEffect)((()=>{C.Z.on("message",(e=>{e===s.chat&&n()}))}),[]),(0,b.jsx)(x.Z,{sx:{width:1,height:600,overflow:"hidden"},children:(0,b.jsxs)(o.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,b.jsx)(o.Z,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:"Chat"}),(0,b.jsx)(o.Z,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:e=>"solid 1px ".concat(e.palette.divider)},children:(0,b.jsxs)(o.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,b.jsx)(S.Z,{messages:null===r||void 0===r?void 0:r.messages,participants:l}),(0,b.jsx)(T.Z,{selectedConversationId:s.chat,refetch:n})]})})]})})}var R=s(13400),I=s(4567),N=s(4419),M=s(9145),L=s(84954),U=s(40268),z=s(24845);function D(e){let{status:t,backLink:s,ticket:a,statusOptions:r,onChangeStatus:n}=e;const i=(0,z.S)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(o.Z,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},children:[(0,b.jsxs)(o.Z,{spacing:1,direction:"row",alignItems:"flex-start",children:[(0,b.jsx)(R.Z,{component:N.r,href:s,children:(0,b.jsx)(U.Z,{icon:"eva:arrow-ios-back-fill"})}),(0,b.jsxs)(o.Z,{spacing:.5,children:[(0,b.jsxs)(o.Z,{spacing:1,direction:"row",alignItems:"center",children:[(0,b.jsxs)(I.Z,{variant:"h4",children:[" ",null===a||void 0===a?void 0:a.subject," "]}),(0,b.jsx)(L.Z,{variant:"soft",color:("pending"===t?"warning":"waiting"===t&&"secondary")||"processing"===t&&"info"||"completed"===t&&"success"||"closed"===t&&"error"||"default",children:t})]}),(0,b.jsx)(I.Z,{variant:"body2",sx:{color:"text.disabled"},children:(0,M.zM)(a.created_at)})]})]}),(0,b.jsx)(o.Z,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,b.jsx)(f.Z,{color:"inherit",variant:"outlined",endIcon:(0,b.jsx)(U.Z,{icon:"eva:arrow-ios-downward-fill"}),onClick:i.onOpen,sx:{textTransform:"capitalize"},children:t})})]}),(0,b.jsx)(z.Z,{open:i.open,onClose:i.onClose,arrow:"top-right",sx:{width:140},children:null===r||void 0===r?void 0:r.map((e=>(0,b.jsx)(y.Z,{selected:e===t,onClick:()=>{i.onClose(),n(e)},children:e},e)))})]})}var O=s(16029),q=s(36562),E=s(35651),F=s(27454),A=s(28666),G=s(65552),B=s(21658),K=s(46395),W=s(10261);function $(e){let{history:t}=e;const s=(0,b.jsx)(q.Z,{sx:{p:0,m:0,["& .".concat(B.Z.root,":before")]:{flex:0,padding:0}},children:null===t||void 0===t?void 0:t.map(((e,s)=>{var a;const r=0===s,n=s===t.length-1;return(0,b.jsxs)(K.Z,{children:[(0,b.jsxs)(A.Z,{children:[(0,b.jsx)(E.Z,{color:r?"primary":"grey"}),n?null:(0,b.jsx)(G.Z,{})]}),(0,b.jsxs)(F.Z,{children:[(0,b.jsx)(I.Z,{variant:"subtitle2",children:e.note}),(0,b.jsxs)(o.Z,{direction:"row",gap:5,children:[(0,b.jsx)(O.Z,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:(0,M.zM)(e.date)}),(0,b.jsx)(O.Z,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:null===(a=e.user)||void 0===a?void 0:a.email})]})]})]},e.note)}))});return(0,b.jsxs)(x.Z,{children:[(0,b.jsx)(m.Z,{title:"History"}),(0,b.jsx)(W.Z,{spacing:3,alignItems:{md:"flex-start"},direction:{xs:"column-reverse",md:"row"},sx:{p:3,mt:2,height:"400px"},children:s})]})}function J(e){let{ticket:t,refetch:s}=e;const a=(0,u.K$)(),{enqueueSnackbar:r}=(0,h.Ds)(),[n,x]=(0,i.useState)(t.status),m=(0,i.useCallback)((e=>{try{p.ZP.patch(p.Hv.tickets.one(t._id),{status:e}),x(e),r("changed successfully!"),s()}catch(a){r(a.message),s()}}),[t._id,r,s]);return(0,b.jsxs)(l.Z,{maxWidth:!a.themeStretch&&"lg",children:[(0,b.jsx)(D,{backLink:d.H.superadmin.communication.root,ticket:t,status:n,refetch:s,onChangeStatus:m,statusOptions:["pending","processing","waiting","completed","closed"]}),(0,b.jsxs)(c.Z,{container:!0,spacing:3,children:[(0,b.jsx)(c.Z,{xs:12,md:7,children:(0,b.jsxs)(o.Z,{spacing:3,direction:{xs:"column-reverse",md:"column"},children:[(0,b.jsx)(k,{ticket:t,refetch:s}),(0,b.jsx)($,{history:t.history})]})}),(0,b.jsx)(c.Z,{xs:12,md:5,children:(0,b.jsx)(H,{ticket:t})})]})]})}function Q(){const{id:e}=(0,r.UO)(),{data:t,refetch:s}=(0,n.NC4)(e);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(a.ql,{children:[(0,b.jsx)("title",{children:" Ticket info "}),(0,b.jsx)("meta",{name:"description",content:"meta"})]}),t&&(0,b.jsx)(J,{ticket:t,refetch:s})]})}},9585:(e,t,s)=>{s.d(t,{Z:()=>f});var a=s(63366),r=s(87462),n=s(72791),i=s(59278),o=s(20838),l=s(4567),c=s(31402),d=s(66934),h=s(59703),p=s(64657);function u(e){return(0,p.ZP)("MuiCardHeader",e)}const x=(0,h.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var m=s(80184);const g=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],v=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,r.Z)({["& .".concat(x.title)]:t.title,["& .".concat(x.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),y=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),Z=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),j=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),f=n.forwardRef((function(e,t){const s=(0,c.Z)({props:e,name:"MuiCardHeader"}),{action:n,avatar:d,className:h,component:p="div",disableTypography:x=!1,subheader:f,subheaderTypographyProps:b,title:w,titleTypographyProps:k}=s,C=(0,a.Z)(s,g),_=(0,r.Z)({},s,{component:p,disableTypography:x}),P=(e=>{const{classes:t}=e;return(0,o.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},u,t)})(_);let S=w;null==S||S.type===l.Z||x||(S=(0,m.jsx)(l.Z,(0,r.Z)({variant:d?"body2":"h5",className:P.title,component:"span",display:"block"},k,{children:S})));let T=f;return null==T||T.type===l.Z||x||(T=(0,m.jsx)(l.Z,(0,r.Z)({variant:d?"body2":"body1",className:P.subheader,color:"text.secondary",component:"span",display:"block"},b,{children:T}))),(0,m.jsxs)(v,(0,r.Z)({className:(0,i.Z)(P.root,h),as:p,ref:t,ownerState:_},C,{children:[d&&(0,m.jsx)(y,{className:P.avatar,ownerState:_,children:d}),(0,m.jsxs)(j,{className:P.content,ownerState:_,children:[S,T]}),n&&(0,m.jsx)(Z,{className:P.action,ownerState:_,children:n})]}))}))}}]);
//# sourceMappingURL=69.0dfe4bc1.chunk.js.map
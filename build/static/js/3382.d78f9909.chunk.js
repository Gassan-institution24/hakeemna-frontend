"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[3382],{36434:(e,a,n)=>{n.r(a),n.d(a,{default:()=>p});var t=n(6907),i=n(19208),l=n(36093),r=n(27031),s=n(35456),o=n(10266),d=n(25279),m=n(17579),u=n(80184);function c(e){let{departmentData:a}=e;const n=(0,d.K$)();return(0,u.jsx)(o.Z,{maxWidth:!n.themeStretch&&"lg",children:(0,u.jsx)(m.Z,{departmentData:a})})}function p(){const e=(0,i.UO)(),{id:a}=e,{data:n,loading:o}=(0,l.YL)(a);return(0,u.jsxs)(r.Z,{category:"department",subcategory:"management_tables",acl:"create",children:[(0,u.jsxs)(t.ql,{children:[(0,u.jsxs)("title",{children:[n.name_english," : New Work Group "]}),(0,u.jsx)("meta",{name:"description",content:"meta"})]}),o&&(0,u.jsx)(s.a,{}),!o&&(0,u.jsx)(c,{departmentData:n})]})}},17579:(e,a,n)=>{n.d(a,{Z:()=>f});var t=n(8007),i=n(763),l=n(61134),r=n(72791),s=n(44695),o=n(68870),d=n(57621),m=n(85771),u=n(53767),c=n(24308),p=n(12258),g=n(38072),_=n(19208),v=n(66664),h=n(99116),y=n(8976),b=n(76932),x=n(36093),j=n(32869),k=n(26405),Z=n(80184);function f(e){let{departmentData:a,currentTable:n}=e;const f=(0,_.tv)(),{t:w}=(0,b.qM)(),{currentLang:C}=(0,b.nt)(),q="ar"===C.value,{user:S}=(0,y.E)(),{employeesData:V}=(0,x.C$)(a._id),[D,G]=(0,r.useState)([]),{enqueueSnackbar:$}=(0,j.Ds)(),E=t.Ry().shape({name_arabic:t.Z_().required("Name is required"),name_english:t.Z_().required("Name is required"),employees:t.IX().min(1,"Choose at least one option")}),H=(0,r.useMemo)((()=>{var e,t;return{unit_service:(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(t=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===n||void 0===n?void 0:n.name_arabic)||"",name_english:(null===n||void 0===n?void 0:n.name_english)||"",employees:(null===n||void 0===n?void 0:n.employees.map(((e,a)=>e.employee)))||[]}}),[n,a,null===S||void 0===S?void 0:S.employee]),I=(0,l.cI)({mode:"onTouched",resolver:(0,s.X)(E),defaultValues:H}),{reset:O,handleSubmit:T,formState:{isSubmitting:F}}=I,L=T((async e=>{try{n?(await v.ZP.patch(v.Hv.work_groups.one(n._id),e),h.Z.emit("updated",{data:e,user:S,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"updated work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})):(await v.ZP.post(v.Hv.work_groups.all,e),h.Z.emit("created",{data:e,user:S,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"created work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})),O(),$(w(n?"update success!":"create success!")),f.push(g.H.unitservice.departments.workGroups.root(a._id))}catch(t){$(q?t.arabic_message:t.message,{variant:"error"}),console.error(t)}}));return(0,r.useEffect)((()=>{var e,t;O({unit_service:(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(t=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===n||void 0===n?void 0:n.name_arabic)||"",name_english:(null===n||void 0===n?void 0:n.name_english)||"",employees:(null===n||void 0===n?void 0:n.employees.map(((e,a)=>e.employee)))||[]})}),[n]),(0,Z.jsx)(k.ZP,{methods:I,onSubmit:L,children:(0,Z.jsx)(c.Z,{xs:12,maxWidth:"md",children:(0,Z.jsxs)(d.Z,{sx:{p:3},children:[(0,Z.jsxs)(o.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,Z.jsx)(k.au,{lang:"ar",onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%]*$/.test(e.target.value)&&I.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(w("name english")," *")}),(0,Z.jsx)(k.au,{lang:"ar",onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_-]*$/.test(e.target.value)&&I.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(w("name arabic")," *")}),(0,Z.jsx)(k.Fl,{name:"employees",label:"".concat(w("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:V.filter((e=>!D.some((a=>(0,i.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a,n)=>{var t;return(0,r.createElement)("li",{...e,key:n,value:a._id},q?null===(t=a.employee)||void 0===t?void 0:t.name_arabic:a.employee.name_english)},onChange:(e,a)=>{G(a),I.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,n)=>(0,r.createElement)(m.Z,{...a({index:n}),key:n,label:q?e.employee.name_arabic:e.employee.name_english,size:"small",color:"info",variant:"soft"})))})]}),(0,Z.jsx)(u.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,Z.jsx)(p.Z,{type:"submit",tabIndex:-1,variant:"contained",loading:F,children:w(n?"save changes":"create")})})]})})})}}}]);
//# sourceMappingURL=3382.d78f9909.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[68515],{68515:(e,i,n)=>{n.r(i),n.d(i,{default:()=>x});var l=n(29490),a=n(67132),t=n(7625),s=n(68719),o=n(75139),r=n(67555),d=n(77224),m=n(48407),c=n(60778),u=n(83858),p=n(74357),v=n(70579);function h(e){let{employeeData:i}=e;const{t:n}=(0,c.WD)();return(0,v.jsxs)(d.A,{maxWidth:"xl",children:[(0,v.jsx)(u.A,{heading:n("Edit Employee Account"),links:[{name:n("dashboard"),href:m.f.unitservice.root},{name:n("employees"),href:m.f.unitservice.employees.root},{name:n("sdit")}],sx:{mb:{xs:3,md:5}}}),(0,v.jsx)(p.A,{currentTable:i})]})}function x(){var e,i,n,d,m;const c=(0,a.g)(),{id:u}=c,{data:p,loading:x}=(0,t.CMc)(u),{user:g}=(0,o.Z)(),_=null===g||void 0===g||null===(e=g.employee)||void 0===e||null===(i=e.employee_engagements)||void 0===i||null===(n=i[null===g||void 0===g||null===(m=g.employee)||void 0===m?void 0:m.selected_engagement])||void 0===n||null===(d=n.unit_service)||void 0===d?void 0:d.name_english;return(0,v.jsxs)(s.A,{category:"unit_service",subcategory:"employees",acl:"update",children:[(0,v.jsxs)(l.mg,{children:[(0,v.jsxs)("title",{children:[" ",_||"unit of service"," : Edit Employee"]}),(0,v.jsx)("meta",{name:"description",content:"meta"})]}),x&&(0,v.jsx)(r.x,{}),!x&&(0,v.jsx)(h,{employeeData:p})]})}},74357:(e,i,n)=>{n.d(i,{A:()=>$});var l=n(80899),a=n(24858),t=n(94113),s=n(65043),o=n(18403),r=n(81e3),d=n(12110),m=n(74600),c=n(22075),u=n(17392),p=n(38246),v=n(51787),h=n(71861),x=n(94814),g=n(39336),_=n(94496),y=n(48407),b=n(67132),j=n(59229),f=n(5124),A=n(31673),w=n(91562),k=n(75139),S=n(60778),q=n(7625),C=n(35151),Y=n(94857),I=n(59699),T=n(70579);function $(e){var i,n,$,D,E,L,F,O,P;let{currentTable:z}=e;const U=(0,b.rd)(),{t:V}=(0,S.WD)(),{currentLang:W}=(0,S.jc)(),G="ar"===W.value,{user:N}=(0,k.Z)(),{countriesData:Z}=(0,q.oOq)({select:"name_english name_arabic"}),{employeeTypesData:M}=(0,q.RJ6)(),{specialtiesData:R}=(0,q.srd)({select:"name_english name_arabic"}),{departmentsData:X}=(0,q.Lhq)(null===N||void 0===N||null===(i=N.employee)||void 0===i||null===(n=i.employee_engagements)||void 0===n||null===($=n[null===N||void 0===N||null===(E=N.employee)||void 0===E?void 0:E.selected_engagement])||void 0===$||null===(D=$.unit_service)||void 0===D?void 0:D._id),{enqueueSnackbar:B}=(0,Y.dh)(),{handleAddNew:H}=(0,f.I)(),[J,K]=(0,s.useState)(""),Q=l.Ik().shape({department:l.Yj().nullable(),employee_type:l.Yj().required(V("required field")),email:l.Yj().required(V("required field")),name_english:l.Yj().required(V("required field")),name_arabic:l.Yj().required(V("required field")),nationality:l.Yj().required(V("required field")),address:l.Yj(),phone:l.Yj().required(V("required field")).test("is-valid-phone",V("Invalid phone number"),(e=>(0,t.l0)(e))),speciality:l.Yj().nullable(),gender:l.Yj().required(V("required field")),birth_date:l.Yj(),identification_num:l.Yj(),strict_employee:l.lc(),visibility_US_page:l.lc(),visibility_online_appointment:l.lc(),password:l.Yj().min(8,`${V("must be at least")} 8`),confirmPassword:l.Yj().oneOf([l.KR("password"),V("must be exactly as password")],V("Passwords must match")).min(8,`${V("must be at least")} 8`)}),ee=(0,s.useMemo)((()=>{var e,i,n,l,a,t;return{unit_service:(null===z||void 0===z||null===(e=z.unit_service)||void 0===e?void 0:e._id)||(null===N||void 0===N||null===(i=N.employee)||void 0===i||null===(n=i.employee_engagements)||void 0===n||null===(l=n[null===N||void 0===N?void 0:N.employee.selected_engagement])||void 0===l?void 0:l.unit_service._id),department:(null===z||void 0===z||null===(a=z.department)||void 0===a?void 0:a._id)||null,employee_type:(null===z||void 0===z||null===(t=z.employee_type)||void 0===t?void 0:t._id)||"",email:(null===z||void 0===z?void 0:z.email)||"",name_english:(null===z||void 0===z?void 0:z.name_english)||"",name_arabic:(null===z||void 0===z?void 0:z.name_arabic)||"",identification_num:(null===z||void 0===z?void 0:z.identification_num)||"",nationality:(null===z||void 0===z?void 0:z.nationality)||"",address:(null===z||void 0===z?void 0:z.address)||"",phone:(null===z||void 0===z?void 0:z.phone)||"",speciality:(null===z||void 0===z?void 0:z.speciality)||null,gender:(null===z||void 0===z?void 0:z.gender)||"",strict_employee:(null===z||void 0===z?void 0:z.strict_employee)||!1,visibility_US_page:(null===z||void 0===z?void 0:z.visibility_US_page)||!1,visibility_online_appointment:(null===z||void 0===z?void 0:z.visibility_online_appointment)||!1,birth_date:(null===z||void 0===z?void 0:z.birth_date)||"",password:(null===z||void 0===z?void 0:z.password)||"",confirmPassword:(null===z||void 0===z?void 0:z.confirmPassword)||""}}),[z,null===N||void 0===N?void 0:N.employee]),ie=(0,j.C)(),ne=(0,a.mN)({mode:"all",resolver:(0,o.t)(Q),defaultValues:ee}),{watch:le,setValue:ae,reset:te,handleSubmit:se,formState:{isSubmitting:oe,errors:re}}=ne;(0,s.useEffect)((()=>{Object.keys(re).length&&Object.keys(re).forEach(((e,i)=>{var n;return B(`${e}: ${(null===re||void 0===re||null===(n=re[e])||void 0===n?void 0:n.message)||"error"}`,{variant:"error"})}))}),[re,B]);const de=se((async e=>{try{var i,n,l,a;const t=await A.Ay.post(A.vZ.auth.register,{role:"employee",userName:e.name_english,...e});w.A.emit("created",{data:e,user:N,link:y.f.unitservice.employees.root,msg:`created an employee <strong>${e.name_english||""}</strong>`}),te(),U.push(null!==(i=t.data)&&void 0!==i&&null!==(n=i.engagement)&&void 0!==n&&n._id?y.f.unitservice.employees.acl(null===(l=t.data)||void 0===l||null===(a=l.engagement)||void 0===a?void 0:a._id):y.f.unitservice.employees.root),B(V(z?"update success!":"create success!"))}catch(t){console.error(t),B(G&&`${t.arabic_message}`||`${t.message}`,{variant:"error"}),K("string"===typeof t?t:t.message)}})),me=(null===N||void 0===N||null===(L=N.employee)||void 0===L||null===(F=L.employee_engagements)||void 0===F||null===(O=F[null===N||void 0===N?void 0:N.employee.selected_engagement])||void 0===O||null===(P=O.unit_service)||void 0===P?void 0:P.employees_number)||10;return(0,T.jsx)(I.Ay,{methods:ne,onSubmit:de,children:(0,T.jsx)(c.A,{container:!0,spacing:3,children:(0,T.jsx)(c.A,{xs:12,maxWidth:"md",children:(0,T.jsxs)(d.A,{sx:{p:3},children:[!!J&&(0,T.jsx)(h.A,{sx:{mb:3},severity:"error",children:(0,T.jsx)("div",{dangerouslySetInnerHTML:{__html:J}})}),(0,T.jsxs)(r.A,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,T.jsx)(I.o3,{onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%.()]*$/.test(e.target.value)&&ne.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:V("Full name in English"),helperText:V("should include title like : doctor, specialist,...")}),(0,T.jsx)(I.o3,{onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_\-().]*$/.test(e.target.value)&&ne.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:V("Full name in Arabic"),helperText:V("should include title like : doctor, specialist,...")}),(0,T.jsx)(I.o3,{name:"identification_num",label:V("National ID number")}),(0,T.jsx)(I.u,{name:"phone",label:V("phone number")}),(0,T.jsx)(I.tX,{name:"nationality",label:V("nationality"),children:Z.map(((e,i)=>(0,T.jsx)(x.A,{lang:"ar",value:e._id,children:G?e.name_arabic:e.name_english},i)))}),me>3&&(0,T.jsxs)(I.tX,{name:"department",label:V("department"),children:[X.map(((e,i)=>(0,T.jsx)(x.A,{lang:"ar",value:e._id,children:G?e.name_arabic:e.name_english},i))),(0,T.jsx)(g.A,{}),(0,T.jsxs)(x.A,{lang:"ar",sx:{display:"flex",justifyContent:"flex-end",gap:1,fontWeight:600},onClick:()=>H(y.f.unitservice.departments.new),children:[(0,T.jsx)(_.A,{variant:"body2",sx:{color:"info.main"},children:V("Add new")}),(0,T.jsx)(C.A,{icon:"material-symbols:new-window-sharp"})]})]}),(0,T.jsx)(I.j2,{name:"employee_type",label:V("employee type"),options:M.map((e=>e._id)),getOptionLabel:e=>{var i;return null===(i=M.find((i=>i._id===e)))||void 0===i?void 0:i[G?"name_arabic":"name_english"]},renderOption:(e,i,n)=>{var l;return(0,s.createElement)("li",{lang:"ar",...e,key:n,value:i},null===(l=M.find((e=>e._id===i)))||void 0===l?void 0:l[G?"name_arabic":"name_english"])}}),(0,T.jsx)(I.j2,{name:"speciality",label:V("speciality"),options:R.map((e=>e._id)),getOptionLabel:e=>{var i;return null===(i=R.find((i=>i._id===e)))||void 0===i?void 0:i[G?"name_arabic":"name_english"]},renderOption:(e,i,n)=>{var l;return(0,s.createElement)("li",{lang:"ar",...e,key:n,value:i},null===(l=R.find((e=>e._id===i)))||void 0===l?void 0:l[G?"name_arabic":"name_english"])}}),(0,T.jsxs)(I.tX,{name:"gender",label:V("gender"),children:[(0,T.jsx)(x.A,{lang:"ar",value:"male",children:V("male")}),(0,T.jsx)(x.A,{lang:"ar",value:"female",children:V("female")})]}),(0,T.jsx)(I.SF,{sx:{px:2},name:"strict_employee",onChange:()=>ae("strict_employee",!le("strict_employee")),label:(0,T.jsx)(_.A,{sx:{fontSize:12},children:V("strict account - only for my unit of service")})}),(0,T.jsx)(I.SF,{sx:{px:2},name:"visibility_US_page",onChange:()=>ae("visibility_US_page",!le("visibility_US_page")),label:(0,T.jsx)(_.A,{sx:{fontSize:12},children:V("visible on online page")})}),(0,T.jsx)(I.SF,{sx:{px:2},name:"visibility_online_appointment",onChange:()=>ae("visibility_online_appointment",!le("visibility_online_appointment")),label:(0,T.jsx)(_.A,{sx:{fontSize:12},children:V("visible in online appointments")})})]}),(0,T.jsxs)(r.A,{rowGap:3,columnGap:2,display:"grid",mt:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,T.jsx)(I.o3,{name:"address",label:V("address")}),(0,T.jsx)(I.o3,{name:"email",label:V("email")}),(0,T.jsx)(I.o3,{name:"password",label:V("password"),type:ie.value?"text":"password",InputProps:{endAdornment:(0,T.jsx)(v.A,{position:"end",children:(0,T.jsx)(u.A,{onClick:ie.onToggle,edge:"end",children:(0,T.jsx)(C.A,{icon:ie.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),(0,T.jsx)(I.o3,{name:"confirmPassword",label:V("confirm password"),type:ie.value?"text":"password",InputProps:{endAdornment:(0,T.jsx)(v.A,{position:"end",children:(0,T.jsx)(u.A,{onClick:ie.onToggle,edge:"end",children:(0,T.jsx)(C.A,{icon:ie.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}})]}),(0,T.jsx)(m.A,{alignItems:"flex-end",sx:{mt:3},children:(0,T.jsx)(p.A,{type:"submit",tabIndex:-1,variant:"contained",loading:oe,children:V(z?"save changes":"create")})})]})})})})}},83858:(e,i,n)=>{n.d(i,{A:()=>l.A});var l=n(91720)},91720:(e,i,n)=>{n.d(i,{A:()=>c});var l=n(81e3),a=n(88446),t=n(74600),s=n(94496),o=n(22698),r=n(65381),d=n(70579);function m(e){let{link:i,activeLast:n,disabled:t}=e;const s={typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex",...t&&!n&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}},o=(0,d.jsxs)(d.Fragment,{children:[i.icon&&(0,d.jsx)(l.A,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:i.icon}),i.name]});return i.href?(0,d.jsx)(a.A,{component:r.W,href:i.href,sx:s,children:o}):(0,d.jsxs)(l.A,{sx:s,children:[" ",o," "]})}function c(e){let{links:i,action:n,heading:r,moreLink:c,activeLast:p,sx:v,...h}=e;const x=i&&i[i.length-1].name;return(0,d.jsxs)(l.A,{sx:{...v},children:[(0,d.jsxs)(t.A,{direction:"row",alignItems:"center",children:[(0,d.jsxs)(l.A,{sx:{flexGrow:1,display:"flex",gap:{md:3},alignItems:{md:"center"},flexDirection:{xs:"column",md:"row"}},children:[r&&(0,d.jsx)(s.A,{textTransform:"capitalize",variant:"h4",gutterBottom:!0,children:r}),i&&!!i.length&&(0,d.jsx)(o.A,{separator:(0,d.jsx)(u,{}),...h,children:null===i||void 0===i?void 0:i.map(((e,i)=>(0,d.jsx)(m,{link:e,activeLast:p,disabled:e.name===x},i)))})]}),n&&(0,d.jsxs)(l.A,{sx:{flexShrink:0,textTransform:"capitalize"},children:[" ",n," "]})]}),!!c&&(0,d.jsx)(l.A,{sx:{mt:2},children:c.map(((e,i)=>(0,d.jsx)(a.A,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},i)))})]})}function u(){return(0,d.jsx)(l.A,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}}}]);
//# sourceMappingURL=68515.4b3e5180.chunk.js.map
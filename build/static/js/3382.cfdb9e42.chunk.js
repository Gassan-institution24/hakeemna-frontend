"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[3382],{36434:(e,a,t)=>{t.r(a),t.d(a,{default:()=>p});var n=t(6907),r=t(19208),s=t(36093),i=t(27031),l=t(35456),o=t(10266),m=t(25279),d=t(17579),c=t(80184);function u(e){let{departmentData:a}=e;const t=(0,m.K$)();return(0,c.jsx)(o.Z,{maxWidth:!t.themeStretch&&"lg",children:(0,c.jsx)(d.Z,{departmentData:a})})}function p(){const e=(0,r.UO)(),{id:a}=e,{data:t,loading:o}=(0,s.YL)(a);return(0,c.jsxs)(i.Z,{category:"department",subcategory:"management_tables",acl:"create",children:[(0,c.jsxs)(n.ql,{children:[(0,c.jsx)("title",{children:" New Work Group "}),(0,c.jsx)("meta",{name:"description",content:"meta"})]}),o&&(0,c.jsx)(l.a,{}),!o&&(0,c.jsx)(u,{departmentData:t})]})}},17579:(e,a,t)=>{t.d(a,{Z:()=>f});var n=t(8007),r=t(763),s=t(72791),i=t(61134),l=t(44695),o=t(68870),m=t(57621),d=t(85771),c=t(36314),u=t(24308),p=t(12258),g=t(38072),_=t(19208),h=t(66664),v=t(99116),y=t(76932),x=t(8976),b=t(36093),j=t(32869),k=t(26405),Z=t(80184);function f(e){let{departmentData:a,currentTable:t}=e;const f=(0,_.tv)(),{t:w}=(0,y.qM)(),{user:C}=(0,x.E)(),{employeesData:q}=(0,b.C$)(a._id),[S,V]=(0,s.useState)([]),{enqueueSnackbar:D}=(0,j.Ds)(),G=n.Ry().shape({name_arabic:n.Z_().required("Name is required"),name_english:n.Z_().required("Name is required"),employees:n.IX().min(1,"Choose at least one option")}),$=(0,s.useMemo)((()=>{var e,n;return{unit_service:(null===C||void 0===C||null===(e=C.employee)||void 0===e||null===(n=e.employee_engagements[null===C||void 0===C?void 0:C.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===t||void 0===t?void 0:t.name_arabic)||"",name_english:(null===t||void 0===t?void 0:t.name_english)||"",employees:(null===t||void 0===t?void 0:t.employees.map((e=>e.employee)))||[]}}),[t,a,null===C||void 0===C?void 0:C.employee]),H=(0,i.cI)({mode:"onTouched",resolver:(0,l.X)(G),defaultValues:$}),{reset:E,handleSubmit:I,formState:{isSubmitting:O}}=H,T=I((async e=>{try{t?(await h.ZP.patch(h.Hv.work_groups.one(t._id),e),v.Z.emit("updated",{data:e,user:C,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"updated work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})):(await h.ZP.post(h.Hv.work_groups.all,e),v.Z.emit("created",{data:e,user:C,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"created work group <strong>".concat(e.name_english||"","</strong> in <strong>").concat(a.name_english,"</strong> department")})),E(),D(w(t?"update success!":"create success!")),f.push(g.H.unitservice.departments.workGroups.root(a._id))}catch(n){v.Z.emit("error",{error:n,user:C,location:window.location.pathname}),D("string"===typeof n?n:n.message,{variant:"error"}),console.error(n)}}));return(0,Z.jsx)(k.ZP,{methods:H,onSubmit:T,children:(0,Z.jsx)(u.Z,{xs:12,maxWidth:"md",children:(0,Z.jsxs)(m.Z,{sx:{p:3},children:[(0,Z.jsxs)(o.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,Z.jsx)(k.au,{lang:"ar",onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%]*$/.test(e.target.value)&&H.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(w("name english")," *")}),(0,Z.jsx)(k.au,{lang:"ar",onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_-]*$/.test(e.target.value)&&H.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(w("name arabic")," *")}),(0,Z.jsx)(k.Fl,{name:"employees",label:"".concat(w("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:q.filter((e=>!S.some((a=>(0,r.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a)=>(0,s.createElement)("li",{...e,key:a._id,value:a._id},a.employee.first_name," ",a.employee.middle_name," ",a.employee.family_name),onChange:(e,a)=>{V(a),H.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,t)=>(0,s.createElement)(d.Z,{...a({index:t}),key:e._id,label:e.employee.first_name,size:"small",color:"info",variant:"soft"})))})]}),(0,Z.jsx)(c.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,Z.jsx)(p.Z,{type:"submit",tabIndex:-1,variant:"contained",loading:O,children:w(t?"save changes":"create")})})]})})})}}}]);
//# sourceMappingURL=3382.cfdb9e42.chunk.js.map
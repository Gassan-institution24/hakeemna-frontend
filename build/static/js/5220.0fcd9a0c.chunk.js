(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[5220],{38563:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var l=n(68870),i=n(50533),a=n(36314),s=n(4567),o=n(93517),r=n(4419),d=n(80184);function c(e){let{link:t,activeLast:n,disabled:a}=e;const s={typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex",...a&&!n&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}},o=(0,d.jsxs)(d.Fragment,{children:[t.icon&&(0,d.jsx)(l.Z,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:t.icon}),t.name]});return t.href?(0,d.jsx)(i.Z,{component:r.r,href:t.href,sx:s,children:o}):(0,d.jsxs)(l.Z,{sx:s,children:[" ",o," "]})}function m(e){let{links:t,action:n,heading:r,moreLink:m,activeLast:u,sx:x,...h}=e;const _=t&&t[t.length-1].name;return(0,d.jsxs)(l.Z,{sx:{...x},children:[(0,d.jsxs)(a.Z,{direction:"row",alignItems:"center",children:[(0,d.jsxs)(l.Z,{sx:{flexGrow:1,display:"flex",gap:3,alignItems:"center"},children:[r&&(0,d.jsx)(s.Z,{variant:"h4",gutterBottom:!0,children:r}),t&&!!t.length&&(0,d.jsx)(o.Z,{separator:(0,d.jsx)(p,{}),...h,children:null===t||void 0===t?void 0:t.map((e=>(0,d.jsx)(c,{link:e,activeLast:u,disabled:e.name===_},e.name||"")))})]}),n&&(0,d.jsxs)(l.Z,{sx:{flexShrink:0},children:[" ",n," "]})]}),!!m&&(0,d.jsx)(l.Z,{sx:{mt:2},children:m.map((e=>(0,d.jsx)(i.Z,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)))})]})}function p(){return(0,d.jsx)(l.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}},45220:(e,t,n)=>{"use strict";n.d(t,{Z:()=>U});var l=n(8007),i=n(72791),a=n(61134),s=n(44695),o=n(57621),r=n(36314),d=n(12258),c=n(89164),m=n(38072),p=n(19208),u=n(8976),x=n(22459),h=n(25279),_=n(38563),v=n(99116),g=n(76932),y=n(89731),f=n(29028),j=n(77008),b=n(32869),w=(n(87151),n(68870)),Z=n(13838),k=n(94721),S=n(13400),C=n(4567),T=n(41985),I=(n(17070),n(40268)),D=n(80184);function z(){const{t:e}=(0,g.qM)(),{control:t,setValue:n,watch:l,resetField:i,getValues:s}=(0,a.Gc)(),{fields:o,append:d,remove:c}=(0,a.Dq)({control:t,name:"holidays"}),m=s();return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,D.jsxs)(w.Z,{sx:{p:3},children:[(0,D.jsx)(C.Z,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:"Holidays:"}),(0,D.jsx)(r.Z,{sx:{mt:3},divider:(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:2,children:o.map(((n,l)=>(0,D.jsx)(r.Z,{alignItems:"flex-start",spacing:1.5,sx:{width:{xs:"100%",md:"auto"}},children:(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:{xs:"100%",md:"auto"}},children:[(0,D.jsx)(f.au,{lang:"ar",size:"small",name:"holidays[".concat(l,"].description"),label:"Description"}),(0,D.jsx)(a.Qr,{name:"holidays[".concat(l,"].date"),control:t,render:t=>{let{field:n,fieldState:{error:i}}=t;return(0,D.jsx)(T.M,{label:e("date"),value:new Date(m.holidays[l].date?m.holidays[l].date:""),onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!i,helperText:null===i||void 0===i?void 0:i.message}}})}}),(0,D.jsx)(S.Z,{sx:{justifySelf:"flex-end",alignSelf:"flex-end",width:35},size:"small",color:"error",onClick:()=>(e=>{c(e)})(l),children:(0,D.jsx)(I.Z,{icon:"solar:trash-bin-trash-bold"})})]})},n.id)))}),(0,D.jsx)(k.Z,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,D.jsx)(r.Z,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,D.jsx)(Z.Z,{size:"small",color:"primary",startIcon:(0,D.jsx)(I.Z,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{d({date:null,description:""})},children:"Add Holiday"})})]})]})}function P(){const{t:e}=(0,g.qM)(),{control:t,setValue:n,watch:l,resetField:i,getValues:s}=(0,a.Gc)(),{fields:o,append:d,remove:c}=(0,a.Dq)({control:t,name:"long_holidays"}),m=s();return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,D.jsxs)(w.Z,{sx:{p:3},children:[(0,D.jsx)(C.Z,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:"Long Holidays:"}),(0,D.jsx)(r.Z,{sx:{mt:3},divider:(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:o.map(((n,l)=>(0,D.jsx)(r.Z,{alignItems:"flex-start",spacing:1.5,sx:{width:{xs:"100%",md:"auto"}},children:(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:{xs:"100%",md:"auto"}},children:[(0,D.jsx)(f.au,{lang:"ar",size:"small",name:"long_holidays[".concat(l,"].description"),label:"Description"}),(0,D.jsx)(a.Qr,{name:"long_holidays[".concat(l,"].start_date"),control:t,render:t=>{let{field:n,fieldState:{error:i}}=t;return(0,D.jsx)(T.M,{label:e("start date"),value:new Date(m.long_holidays[l].start_date?m.long_holidays[l].start_date:""),onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!i,helperText:null===i||void 0===i?void 0:i.message}}})}}),(0,D.jsx)(a.Qr,{name:"long_holidays[".concat(l,"].end_date"),control:t,render:t=>{let{field:n,fieldState:{error:i}}=t;return(0,D.jsx)(T.M,{label:e("end date"),value:new Date(m.long_holidays[l].end_date?m.long_holidays[l].end_date:""),onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!i,helperText:null===i||void 0===i?void 0:i.message}}})}}),(0,D.jsx)(S.Z,{size:"small",color:"error",sx:{justifySelf:"flex-end",alignSelf:"flex-end",width:35},onClick:()=>(e=>{c(e)})(l),children:(0,D.jsx)(I.Z,{icon:"solar:trash-bin-trash-bold"})})]})},n.id)))}),(0,D.jsx)(k.Z,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,D.jsx)(r.Z,{spacing:1,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,D.jsx)(Z.Z,{size:"small",color:"primary",startIcon:(0,D.jsx)(I.Z,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{d({start_date:null,end_date:null,description:""})},children:"Add Long Holiday"})})]})]})}var F=n(58406),W=n(82626),q=n(13034),M=n(62861),A=n(68096),L=n(47071),H=n(86778),R=n(79572),B=n(56125);function Q(e){let{ParentIndex:t,open:n,appointmenttypesData:l,serviceTypesData:i,setAppointmentsNum:s}=e;const{control:o,setValue:d,watch:c,resetField:m,getValues:p}=(0,a.Gc)(),{t:u}=(0,g.qM)(),{currentLang:x}=(0,g.nt)(),h="ar"===x.value,{fields:_,append:v,remove:y}=(0,a.Dq)({control:o,name:"days_details[".concat(t,"].appointments")}),j=p(),b=e=>{const t=null===i||void 0===i?void 0:i.filter((t=>null===e||void 0===e?void 0:e.includes(t._id)));return null===t||void 0===t?void 0:t.map((e=>e.name_english)).join(", ")};return(0,D.jsx)(B.Z,{in:n,sx:{bgcolor:"background.neutral"},children:(0,D.jsxs)(w.Z,{sx:{px:2,pb:0},children:[j.days_details[t].appointments&&j.days_details[t].appointments.length>0&&(0,D.jsx)(C.Z,{variant:"p",sx:{color:"text.disabled",mb:3,fontSize:14},children:"appointments:"}),(0,D.jsx)(r.Z,{sx:{mt:3},divider:(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,alignItems:"flex-end",children:_.map(((e,n)=>(0,D.jsx)(r.Z,{alignItems:"center",flexWrap:"wrap",spacing:1.5,sx:{width:"80%"},children:(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:"100%"},children:[(0,D.jsx)(f.Cc,{size:"small",InputLabelProps:{shrink:!0},name:"days_details[".concat(t,"].appointments[").concat(n,"].appointment_type"),label:u("appointment type"),children:null===l||void 0===l?void 0:l.map((e=>(0,D.jsx)(W.Z,{value:e._id,children:h?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english})))}),(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].appointments[").concat(n,"].start_time"),control:o,render:e=>{let{field:l,fieldState:{error:i}}=e;return(0,D.jsx)(H.d,{minutesStep:"5",label:u("start time"),value:j.days_details[t].appointments[n].start_time?new Date(j.days_details[t].appointments[n].start_time):new Date,onChange:e=>{l.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!i,helperText:null===i||void 0===i?void 0:i.message}}})}}),(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].appointments[").concat(n,"].service_types"),control:o,render:e=>{let{field:l,fieldState:{error:a}}=e;return(0,D.jsxs)(A.Z,{error:!!a,size:"small",sx:{width:"100%",shrink:!0},children:[(0,D.jsx)(M.Z,{children:" Service Types "}),(0,D.jsx)(F.Z,{...l,multiple:!0,id:"multiple-days_details[".concat(t,"].appointments[").concat(n,"].service_types"),label:u("service types"),renderValue:b,children:null===i||void 0===i?void 0:i.map((e=>{var t;const n=null===l||void 0===l||null===(t=l.value)||void 0===t?void 0:t.includes(e._id);return(0,D.jsxs)(W.Z,{value:e._id,children:[(0,D.jsx)(q.Z,{size:"small",disableRipple:!0,checked:n}),h?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english]},e._id)}))}),!!a&&(0,D.jsx)(L.Z,{error:!!a,children:null===a||void 0===a?void 0:a.message})]})}}),(0,D.jsx)(f.jb,{size:"small",InputLabelProps:{shrink:!0},name:"days_details[".concat(t,"].appointments[").concat(n,"].online_available"),label:(0,D.jsx)(C.Z,{sx:{fontSize:12},children:"Online avaliable"})}),(0,D.jsx)(S.Z,{size:"small",color:"error",sx:{justifySelf:{xs:"flex-end"},alignSelf:{xs:"flex-end"},width:35},onClick:()=>(e=>{y(e),s((e=>({...e,[t]:e[t]-1})))})(n),children:(0,D.jsx)(I.Z,{icon:"solar:trash-bin-trash-bold"})})]})},e.id)))}),(0,D.jsx)(k.Z,{sx:{mt:j.days_details[t].appointments&&j.days_details[t].appointments.length>0?3:0,mb:1,borderStyle:"dashed"}}),(0,D.jsx)(r.Z,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,D.jsx)(Z.Z,{size:"small",color:"primary",startIcon:(0,D.jsx)(I.Z,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{const e=j.days_details[t].appointments?j.days_details[t].appointments[j.days_details[t].appointments.length-1]:null,n=new Date(e?e.start_time:j.days_details[t].work_start_time);e&&n.setMinutes(n.getMinutes()+j.appointment_time);const l={appointment_type:null,start_time:null,price:null,online_available:!0,service_types:[],...e,start_time:n};v(l),s((e=>({...e,[t]:e[t]+1})))},children:"Add Detailed Appointment"})})]})})}const V=[{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"}];function N(e){var t,n;let{appointTime:l}=e;const{control:s,setValue:o,watch:d,resetField:c,getValues:m}=(0,a.Gc)(),{fields:p,append:x,remove:h}=(0,a.Dq)({control:s,name:"days_details"}),{user:_}=(0,u.E)(),{t:v}=(0,g.qM)(),{currentLang:y}=(0,g.nt)(),j="ar"===y.value,[b,T]=(0,i.useState)({}),[z,P]=(0,i.useState)({}),{appointmenttypesData:B}=(0,R.o5)(),{serviceTypesData:N}=(0,R.fO)(null===_||void 0===_||null===(t=_.employee)||void 0===t||null===(n=t.employee_engagements[null===_||void 0===_?void 0:_.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id),E=m();function G(e,t){const n=new Date(e),l=new Date(t),i=Math.abs(l-n);return Math.floor(i/6e4)}const X=e=>{const t=null===N||void 0===N?void 0:N.filter((t=>null===e||void 0===e?void 0:e.includes(t._id)));return null===t||void 0===t?void 0:t.map((e=>e.name_english)).join(", ")};function O(e){const t=E.days_details[e];if(t.appointments.length)return t.appointments.length;if(t.break_start_time&&t.break_end_time){return Math.floor(G(t.work_start_time,t.break_start_time)/E.appointment_time)+Math.floor(G(t.break_end_time,t.work_end_time)/E.appointment_time)||0}return Math.floor(G(t.work_start_time,t.work_end_time)/E.appointment_time)||0}return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,D.jsxs)(w.Z,{sx:{p:3},children:[(0,D.jsx)(C.Z,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:"Days Details:"}),(0,D.jsx)(r.Z,{sx:{mt:3},divider:(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:p.map(((e,t)=>(0,D.jsxs)(r.Z,{spacing:1.5,sx:{width:"100%"},children:[(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:"100%",mt:2},children:[(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"column"},spacing:2,sx:{width:"100%",mt:2},children:[(0,D.jsx)(f.Cc,{size:"small",name:"days_details[".concat(t,"].day"),label:"Day",children:V.filter((e=>!E.weekend.includes(e.value)&&!E.days_details.some((n=>{var l;return n.day===e.value&&(null===(l=E.days_details[t])||void 0===l?void 0:l.day)!==e.value})))).map((e=>(0,D.jsx)(W.Z,{value:e.value,children:e.label})))}),(0,D.jsx)(f.au,{lang:"ar",disabled:!0,size:"small",name:"days_details[".concat(t,"].appointment_number"),label:"Appointments Number",InputLabelProps:{shrink:!0},value:z[t]||O(t)})]}),(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"column"},spacing:2,sx:{width:"100%",mt:2},children:[(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].work_start_time"),control:s,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,D.jsx)(H.d,{minutesStep:"5",label:"Work Start Time",value:E.days_details[t].work_start_time?new Date(E.days_details[t].work_start_time):null,onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}}),(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].break_start_time"),control:s,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,D.jsx)(H.d,{minutesStep:"5",label:"Break Start Time",value:E.days_details[t].break_start_time?new Date(E.days_details[t].break_start_time):null,onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}})]}),(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"column"},spacing:2,sx:{width:"100%",mt:2},children:[(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].work_end_time"),control:s,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,D.jsx)(H.d,{minutesStep:"5",label:"Work End Time",value:E.days_details[t].work_end_time?new Date(E.days_details[t].work_end_time):null,onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}}),(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].break_end_time"),control:s,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,D.jsx)(H.d,{minutesStep:"5",label:"Break End Time",value:E.days_details[t].break_end_time?new Date(E.days_details[t].break_end_time):null,onChange:e=>{n.onChange(e)},slotProps:{textField:{size:"small",fullWidth:!0,error:!!l,helperText:null===l||void 0===l?void 0:l.message}}})}})]}),(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"column"},spacing:2,sx:{width:"100%",mt:2},children:[(0,D.jsx)(f.Cc,{size:"small",InputLabelProps:{shrink:!0},name:"days_details[".concat(t,"].appointment_type"),label:v("appointment type"),children:null===B||void 0===B?void 0:B.map((e=>(0,D.jsx)(W.Z,{value:e._id,children:j?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english})))}),(0,D.jsx)(a.Qr,{name:"days_details[".concat(t,"].service_types"),control:s,render:e=>{let{field:n,fieldState:{error:l}}=e;return(0,D.jsxs)(A.Z,{error:!!l,size:"small",sx:{width:"100%",shrink:!0},children:[(0,D.jsx)(M.Z,{children:" Service Types "}),(0,D.jsx)(F.Z,{...n,multiple:!0,id:"multiple-days_details[".concat(t,"].service_types"),label:v("service types"),renderValue:X,children:null===N||void 0===N?void 0:N.map((e=>{var t;const l=null===n||void 0===n||null===(t=n.value)||void 0===t?void 0:t.includes(e._id);return(0,D.jsxs)(W.Z,{value:e._id,children:[(0,D.jsx)(q.Z,{size:"small",disableRipple:!0,checked:l}),j?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english]},e._id)}))}),!!l&&(0,D.jsx)(L.Z,{error:!!l,children:null===l||void 0===l?void 0:l.message})]})}})]}),(0,D.jsxs)(r.Z,{direction:{xs:"column",md:"column"},spacing:.2,sx:{justifySelf:{xs:"flex-end"},alignSelf:{xs:"flex-end"}},children:[(0,D.jsx)(S.Z,{size:"small",color:"error",onClick:()=>(e=>{h(e)})(t),children:(0,D.jsx)(I.Z,{icon:"solar:trash-bin-trash-bold"})}),(0,D.jsx)(S.Z,{size:"small",onClick:()=>async function(e){const t=[];if(!l&&!E.appointment_time)return;const n=e=>{const t=new Date(e);return 60*t.getHours()+t.getMinutes()},i=(e,t)=>{const n=new Date(e);return new Date(n.getTime()-6e4*t)},a=E.days_details[e];let s=G(a.work_start_time,a.work_end_time),r=G(a.work_start_time,a.break_start_time),d=G(a.break_end_time,a.work_end_time);const c=()=>{if(s>=E.appointment_time){const l=i(a.work_end_time,s),o=a.appointments.filter((e=>n(l)===n(e.start_time)))[0];return o?t.push(o):t.push({appointment_type:a.appointment_type||null,start_time:l,price:null,service_types:a.service_types||[]}),s-=E.appointment_time,new Promise((t=>{setTimeout((()=>{t(c(a,e,s))}),0)}))}return Promise.resolve()},m=()=>{if(r>=E.appointment_time){const l=i(a.break_start_time,r),s=a.appointments.filter((e=>n(l)===n(e.start_time)))[0];return s?t.push(s):t.push({appointment_type:a.appointment_type||null,start_time:l,price:null,service_types:a.service_types||[]}),r-=E.appointment_time,new Promise((t=>{setTimeout((()=>{t(m(a,e,r))}),0)}))}return Promise.resolve()},p=()=>{if(d>=E.appointment_time){const l=i(a.work_end_time,d),s=a.appointments.filter((e=>n(l)===n(e.start_time)))[0];return s?t.push(s):t.push({appointment_type:a.appointment_type||null,start_time:l,price:null,service_types:a.service_types||[]}),d-=E.appointment_time,new Promise((t=>{setTimeout((()=>{t(p(a,e,d))}),0)}))}return Promise.resolve()};a.break_start_time&&a.break_end_time?(await m(),await p()):await c(),P({...z,[e]:t.length}),o("days_details[".concat(e,"].appointments"),t)}(t),children:(0,D.jsx)(I.Z,{icon:"zondicons:refresh"})}),(0,D.jsx)(S.Z,{size:"small",onClick:()=>T({...b,[t]:!b[t]}),children:(0,D.jsx)(I.Z,{icon:"tabler:list-details"})})]})]}),(0,D.jsx)(Q,{setAppointmentsNum:P,serviceTypesData:N,appointmenttypesData:B,open:b[t],ParentIndex:t})]},e.id)))}),(0,D.jsx)(k.Z,{sx:{mt:3,mb:1,borderStyle:"dashed"}}),(0,D.jsx)(r.Z,{spacing:3,direction:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},children:(0,D.jsx)(Z.Z,{size:"small",color:"primary",startIcon:(0,D.jsx)(I.Z,{icon:"tdesign:plus"}),sx:{padding:1},onClick:()=>{const e={day:"",work_start_time:null,work_end_time:null,break_start_time:null,break_end_time:null,appointments:[],service_types:[],appointment_type:null,...E.days_details?E.days_details[E.days_details.length-1]:"",day:"",appointments:[]};x(e)},children:"Add New Day"})})]})]})}var E=n(63466),G=n(48550);const X=[{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"Monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"}];function O(e){var t,n,l,i;let{appointmentConfigData:s,setAppointTime:o}=e;const{t:d}=(0,g.qM)(),{currentLang:c}=(0,g.nt)(),m="ar"===c.value,{control:p,watch:x,getValues:h,setValue:_}=(0,a.Gc)(),v=h(),{user:y}=(0,u.E)(),{workGroupsData:j}=(0,R.nj)(null===y||void 0===y||null===(t=y.employee)||void 0===t||null===(n=t.employee_engagements[null===y||void 0===y?void 0:y.employee.selected_engagement])||void 0===n?void 0:n._id),{workShiftsData:b}=(0,R.lL)(null===y||void 0===y||null===(l=y.employee)||void 0===l||null===(i=l.employee_engagements[null===y||void 0===y?void 0:y.employee.selected_engagement])||void 0===i?void 0:i.unit_service._id);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z,{flexItem:!0,sx:{borderStyle:"solid"}}),(0,D.jsxs)(r.Z,{sx:{p:3},children:[(0,D.jsxs)(r.Z,{spacing:2,direction:{xs:"column",sm:"row"},sx:{p:3,width:{xs:"100%",md:"auto"}},children:[(0,D.jsx)(a.Qr,{name:"start_date",control:p,render:e=>{let{field:t,fieldState:{error:n}}=e;return(0,D.jsx)(T.M,{label:d("start date"),value:new Date(v.start_date||""),onChange:e=>{t.onChange(e)},slotProps:{textField:{fullWidth:!0,error:!!n,helperText:null===n||void 0===n?void 0:n.message}}})}}),(0,D.jsx)(a.Qr,{name:"end_date",control:p,render:e=>{let{field:t,fieldState:{error:n}}=e;return(0,D.jsx)(T.M,{label:d("end date"),value:new Date(v.end_date||""),onChange:e=>{t.onChange(e)},slotProps:{textField:{fullWidth:!0,error:!!n,helperText:null===n||void 0===n?void 0:n.message}}})}})]}),(0,D.jsxs)(r.Z,{spacing:2,direction:{xs:"column",sm:"row"},sx:{px:3,pb:3,width:{xs:"100%",md:"auto"}},children:[(0,D.jsx)(f.Cc,{size:"small",name:"work_shift",label:d("work shift"),InputLabelProps:{shrink:!0},PaperPropsSx:{textTransform:"capitalize"},disabled:Boolean(s),children:b.map((e=>(0,D.jsx)(W.Z,{value:e._id,children:m?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},e._id)))}),(0,D.jsx)(f.Cc,{size:"small",name:"work_group",label:d("work group"),InputLabelProps:{shrink:!0},PaperPropsSx:{textTransform:"capitalize"},disabled:Boolean(s),children:j&&(null===j||void 0===j?void 0:j.map((e=>(0,D.jsx)(W.Z,{value:e._id,children:m?null===e||void 0===e?void 0:e.name_arabic:null===e||void 0===e?void 0:e.name_english},e._id))))}),(0,D.jsx)(a.Qr,{name:"appointment_time",control:p,render:e=>{let{field:t,fieldState:{error:n}}=e;return(0,D.jsx)(G.Z,{fullWidth:!0,label:"Appointment Time",type:"number",value:0===t.value?"":t.value,onChange:e=>{t.onChange(Number(e.target.value)),o(e.target.value)},error:!!n,size:"small",InputProps:{endAdornment:(0,D.jsx)(E.Z,{position:"end",children:(0,D.jsx)(w.Z,{sx:{fontSize:"0.8rem"},children:"min"})})}})}}),(0,D.jsx)(f.au,{lang:"ar",size:"small",InputProps:{startAdornment:(0,D.jsx)(E.Z,{position:"start",children:(0,D.jsx)(w.Z,{sx:{fontSize:"0.8rem"},children:"for the next"})}),endAdornment:(0,D.jsx)(E.Z,{position:"end",children:(0,D.jsx)(w.Z,{sx:{fontSize:"0.8rem"},children:"days"})})},name:"config_frequency",label:"Configuration Frequency",type:"number",inputProps:{min:0,max:30,textAlign:"center"},InputLabelProps:{shrink:!0}})]}),(0,D.jsx)(C.Z,{variant:"p",sx:{color:"text.secondary",mb:3,fontWeight:"700",textTransform:"capitalize"},children:"Weekly Days Off:"}),(0,D.jsx)(r.Z,{spacing:2,direction:{xs:"column",sm:"row"},sx:{p:3},children:(0,D.jsx)(f.s2,{size:"small",name:"weekend",options:X,sx:{display:"grid",gridTemplateColumns:{md:"repeat(7, 1fr)",sm:"repeat(4, 1fr)",xs:"repeat(2, 1fr)"}}})})]})]})}function U(e){let{appointmentConfigData:t,refetch:n,loading:w}=e;const Z=(0,p.tv)(),{t:k}=(0,g.qM)(),{user:S}=(0,u.E)(),[C,T]=(0,i.useState)(0),[I,F]=(0,i.useState)([]),{enqueueSnackbar:W}=(0,b.Ds)(),q=((0,h.K$)(),(0,x.k)()),M=(0,x.k)(),A=(0,x.k)(),L=(0,x.k)(),H=l.Ry().shape({weekend:l.IX(),start_date:l.hT().nullable(),end_date:l.hT().nullable(),appointment_time:l.Rx().required("Appointment Time is required").min(5,"Appointment Time must be at least 5").max(180,"Appointment Time must be at most 180"),config_frequency:l.Rx().required("Configuration Frequency is required").min(1,"must be at least 1").max(360,"must be at most 360"),holidays:l.IX(),long_holidays:l.IX(),work_group:l.Z_().required("Work Group is required"),work_shift:l.Z_().required("Work Shift is required"),days_details:l.IX().of(l.Ry().shape({day:l.Z_().required("Day is required"),work_start_time:l.hT(),work_end_time:l.hT().when("work_start_time",((e,t)=>e&&t.min(e,"Work End Time must be after Work Start Time"))),appointments:l.IX(),service_types:l.IX(),appointment_type:l.Z_().nullable()}))}),R=(0,i.useMemo)((()=>{var e,n,l,i;return{unit_service:(null===t||void 0===t?void 0:t.unit_service)||(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(n=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id),department:(null===t||void 0===t?void 0:t.department)||null,start_date:(null===t||void 0===t?void 0:t.start_date)||null,end_date:(null===t||void 0===t?void 0:t.end_date)||null,weekend:(null===t||void 0===t?void 0:t.weekend)||[],appointment_time:(null===t||void 0===t?void 0:t.appointment_time)||null,config_frequency:(null===t||void 0===t?void 0:t.config_frequency)||null,holidays:(null===t||void 0===t?void 0:t.holidays)||[{description:"",date:null}],long_holidays:(null===t||void 0===t?void 0:t.long_holidays)||[{description:"",start_date:null,end_date:null}],work_group:(null===t||void 0===t||null===(l=t.work_group)||void 0===l?void 0:l._id)||null,work_shift:(null===t||void 0===t||null===(i=t.work_shift)||void 0===i?void 0:i._id)||null,days_details:(null===t||void 0===t?void 0:t.days_details)||[{day:"",work_start_time:null,work_end_time:null,break_start_time:null,break_end_time:null,appointments:[],service_types:[],appointment_type:null}]}}),[t,S]),B=(0,a.cI)({resolver:(0,s.X)(H),defaultValues:R}),{reset:Q,handleSubmit:V,formState:{isSubmitting:E}}=B,G=V((async e=>{L.onTrue();const n=new Date,l=new Date(n.getTime()+24*e.config_frequency*60*60*1e3);try{if(t)(!e.start_date&&!e.end_date||new Date(e.end_date)>n&&(new Date(e.start_date)<=n||new Date(e.start_date)<l))&&(F(e),A.onTrue());else{var i,a,s;const t=await y.ZP.post(y.Hv.tables.appointmentconfigs,e);W("Added Successfully!"),v.W.emit("created",{user:S,link:m.H.unitservice.employees.appointmentconfig.root(null===S||void 0===S||null===(i=S.employee)||void 0===i||null===(a=i.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===a?void 0:a._id),msg:"created an appointment configuration <strong>[ ".concat(null===(s=t.data)||void 0===s?void 0:s.code," ]</strong>")}),Z.push(m.H.employee.appointmentconfiguration.root)}L.onFalse(),console.info("DATA",JSON.stringify(e,null,2))}catch(o){v.W.emit("error",{error:o,user:S,location:window.location.href}),W("Failed to Add: ".concat(o),{variant:"error"}),console.error(o),L.onFalse()}}));return(0,i.useEffect)((()=>{var e,n,l,i;t&&B.reset({unit_service:(null===t||void 0===t?void 0:t.unit_service)||(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(n=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id),department:(null===t||void 0===t?void 0:t.department)||null,start_date:(null===t||void 0===t?void 0:t.start_date)||null,end_date:(null===t||void 0===t?void 0:t.end_date)||null,weekend:(null===t||void 0===t?void 0:t.weekend)||[],appointment_time:(null===t||void 0===t?void 0:t.appointment_time)||null,config_frequency:(null===t||void 0===t?void 0:t.config_frequency)||null,holidays:(null===t||void 0===t?void 0:t.holidays)||[{description:"",date:null}],long_holidays:(null===t||void 0===t?void 0:t.long_holidays)||[{description:"",start_date:null,end_date:null}],work_group:(null===(l=t.work_group)||void 0===l?void 0:l._id)||null,work_shift:(null===(i=t.work_shift)||void 0===i?void 0:i._id)||null,days_details:t.days_details||[{day:"",work_start_time:null,work_end_time:null,break_start_time:null,break_end_time:null,appointments:[]}]})}),[t,B,S]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(c.Z,{maxWidth:"lg",children:[(0,D.jsx)(_.Z,{heading:"Configuration Detail",links:[{name:k("dashboard"),href:m.H.employee.root},{name:"Apointments Configuration",href:m.H.employee.appointmentconfiguration.root},{name:"Configuration Detail"}],sx:{mb:{xs:3,md:5}}}),(0,D.jsxs)(f.ZP,{methods:B,children:[!w&&(0,D.jsxs)(o.Z,{children:[(0,D.jsx)(O,{setAppointTime:T,appointmentConfigData:t}),(0,D.jsx)(N,{appointTime:C}),(0,D.jsx)(z,{}),(0,D.jsx)(P,{})]}),(0,D.jsx)(r.Z,{justifyContent:"flex-end",direction:"row",spacing:2,sx:{mt:3},children:(0,D.jsx)(d.Z,{variant:"contained",loading:E||M||q,onClick:G,children:"Save"})})]})]}),(0,D.jsx)(j.Q,{open:A.value,onClose:A.onFalse,title:"UnCancel",content:(0,D.jsxs)(D.Fragment,{children:["Do you want to ",(0,D.jsx)("strong",{children:" change your existance appointments"})," ?"]}),action:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(d.Z,{variant:"contained",loading:M,color:"error",onClick:async()=>{M.onTrue();try{var e,n;await y.ZP.patch("".concat(y.Hv.tables.appointmentconfigs,"/").concat(null===t||void 0===t?void 0:t._id),{...I,ImmediateEdit:!0}),v.W.emit("updated",{user:S,link:m.H.unitservice.employees.appointmentconfig.root(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(n=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===n?void 0:n._id),msg:"updated an appointment configuration <strong>[ ".concat(t.code," ]</strong>")}),W("Updated successfully!"),Z.push(m.H.employee.appointmentconfiguration.root),A.onFalse(),M.onFalse()}catch(l){v.W.emit("error",{error:l,user:S,location:window.location.href}),W("Failed to update: ".concat(l.message),{variant:"error"}),A.onFalse(),M.onFalse()}},children:"Yes, I want to change"}),(0,D.jsx)(d.Z,{loading:q,variant:"contained",color:"success",onClick:async()=>{q.onTrue();try{var e,n;await y.ZP.patch("".concat(y.Hv.tables.appointmentconfigs,"/").concat(null===t||void 0===t?void 0:t._id),{...I,ImmediateEdit:!1}),W("Updated successfully!"),v.W.emit("updated",{user:S,link:m.H.unitservice.employees.appointmentconfig.root(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(n=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===n?void 0:n._id),msg:"updated an appointment configuration <strong>[ ".concat(t.code," ]</strong>")}),A.onFalse(),Z.push(m.H.employee.appointmentconfiguration.root),q.onFalse()}catch(l){v.W.emit("error",{error:l,user:S,location:window.location.href}),W("Failed to update: ".concat(l.message),{variant:"error"}),q.onFalse()}},children:"No, I want to start from uncreated"})]})})]})}},93517:(e,t,n)=>{"use strict";n.d(t,{Z:()=>D});var l=n(87462),i=n(63366),a=n(72791),s=(n(57441),n(59278)),o=n(94419),r=n(43572),d=n(66934),c=n(31402),m=n(4567),p=n(12065),u=n(74223),x=n(80184);const h=(0,u.Z)((0,x.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");var _=n(95080);const v=["slots","slotProps"],g=(0,d.ZP)(_.Z)((e=>{let{theme:t}=e;return(0,l.Z)({display:"flex",marginLeft:"calc(".concat(t.spacing(1)," * 0.5)"),marginRight:"calc(".concat(t.spacing(1)," * 0.5)")},"light"===t.palette.mode?{backgroundColor:t.palette.grey[100],color:t.palette.grey[700]}:{backgroundColor:t.palette.grey[700],color:t.palette.grey[100]},{borderRadius:2,"&:hover, &:focus":(0,l.Z)({},"light"===t.palette.mode?{backgroundColor:t.palette.grey[200]}:{backgroundColor:t.palette.grey[600]}),"&:active":(0,l.Z)({boxShadow:t.shadows[0]},"light"===t.palette.mode?{backgroundColor:(0,p._4)(t.palette.grey[200],.12)}:{backgroundColor:(0,p._4)(t.palette.grey[600],.12)})})})),y=(0,d.ZP)(h)({width:24,height:16});const f=function(e){const{slots:t={},slotProps:n={}}=e,a=(0,i.Z)(e,v),s=e;return(0,x.jsx)("li",{children:(0,x.jsx)(g,(0,l.Z)({focusRipple:!0},a,{ownerState:s,children:(0,x.jsx)(y,(0,l.Z)({as:t.CollapsedIcon,ownerState:s},n.collapsedIcon))}))})};var j=n(75878),b=n(21217);function w(e){return(0,b.Z)("MuiBreadcrumbs",e)}const Z=(0,j.Z)("MuiBreadcrumbs",["root","ol","li","separator"]),k=["children","className","component","slots","slotProps","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"],S=(0,d.ZP)(m.Z,{name:"MuiBreadcrumbs",slot:"Root",overridesResolver:(e,t)=>[{["& .".concat(Z.li)]:t.li},t.root]})({}),C=(0,d.ZP)("ol",{name:"MuiBreadcrumbs",slot:"Ol",overridesResolver:(e,t)=>t.ol})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}),T=(0,d.ZP)("li",{name:"MuiBreadcrumbs",slot:"Separator",overridesResolver:(e,t)=>t.separator})({display:"flex",userSelect:"none",marginLeft:8,marginRight:8});function I(e,t,n,l){return e.reduce(((i,a,s)=>(s<e.length-1?i=i.concat(a,(0,x.jsx)(T,{"aria-hidden":!0,className:t,ownerState:l,children:n},"separator-".concat(s))):i.push(a),i)),[])}const D=a.forwardRef((function(e,t){const n=(0,c.Z)({props:e,name:"MuiBreadcrumbs"}),{children:d,className:m,component:p="nav",slots:u={},slotProps:h={},expandText:_="Show path",itemsAfterCollapse:v=1,itemsBeforeCollapse:g=1,maxItems:y=8,separator:j="/"}=n,b=(0,i.Z)(n,k),[Z,T]=a.useState(!1),D=(0,l.Z)({},n,{component:p,expanded:Z,expandText:_,itemsAfterCollapse:v,itemsBeforeCollapse:g,maxItems:y,separator:j}),z=(e=>{const{classes:t}=e;return(0,o.Z)({root:["root"],li:["li"],ol:["ol"],separator:["separator"]},w,t)})(D),P=(0,r.y)({elementType:u.CollapsedIcon,externalSlotProps:h.collapsedIcon,ownerState:D}),F=a.useRef(null),W=a.Children.toArray(d).filter((e=>a.isValidElement(e))).map(((e,t)=>(0,x.jsx)("li",{className:z.li,children:e},"child-".concat(t))));return(0,x.jsx)(S,(0,l.Z)({ref:t,component:p,color:"text.secondary",className:(0,s.Z)(z.root,m),ownerState:D},b,{children:(0,x.jsx)(C,{className:z.ol,ref:F,ownerState:D,children:I(Z||y&&W.length<=y?W:(e=>g+v>=e.length?e:[...e.slice(0,g),(0,x.jsx)(f,{"aria-label":_,slots:{CollapsedIcon:u.CollapsedIcon},slotProps:{collapsedIcon:P},onClick:()=>{T(!0);const e=F.current.querySelector("a[href],button,[tabindex]");e&&e.focus()}},"ellipsis"),...e.slice(e.length-v,e.length)])(W),z.separator,j,D)})}))}))},58645:e=>{e.exports=function(e,t){for(var n,l=-1,i=e.length;++l<i;){var a=t(e[l]);void 0!==a&&(n=void 0===n?a:n+a)}return n}},87151:(e,t,n)=>{var l=n(58645),i=n(2100);e.exports=function(e){return e&&e.length?l(e,i):0}}}]);
//# sourceMappingURL=5220.0fcd9a0c.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[9545],{49545:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ae});var s=n(6907),o=n(27031),a=n(72791),r=n(61474),i=n(2101),l=n(20068),c=n(12065),d=n(13400),h=n(57621),u=n(79836),p=n(13838),x=n(89164),g=n(53382),m=n(39281),v=n(4419),j=n(38072),w=n(19208),Z=n(76932),f=n(8976),b=n(22459),C=n(61146),_=n(34045),y=n(64802),k=n(99116),P=n(84954),R=n(40268),S=n(10261),D=n(77008),F=n(25279),W=n(73379),A=n(38062),I=n(89731),H=n(6385),T=n(79572),B=n(51642),q=n(6965),E=n(68870),O=n(82626),L=n(9195),z=n(13034),M=n(68745),Q=n(30250),U=n(24845),G=n(80184);function K(e){let{row:t,selected:n,onEditRow:s,onSelectRow:a,onActivate:r,onInactivate:i,onShow:l,showActivities:c,showAppointmentConfig:h,showAppointments:u,showEmployees:p,showQualityControl:x,showRooms:g,showWorkGroups:m}=e;const{code:v,sequence_number:j,name_english:w,name_arabic:f,status:b,created_at:C,user_creation:_,ip_address_user_creation:y,updated_at:k,user_modification:S,ip_address_user_modification:D,modifications_nums:F}=t,{t:W}=(0,Z.qM)(),{currentLang:A}=(0,Z.nt)(),I="ar"===A.value,H=(0,U.S)(),T=(0,U.S)(),B=(0,G.jsxs)(L.Z,{hover:!0,selected:n,children:[(0,G.jsx)(M.Z,{lang:"ar",padding:"checkbox",children:(0,G.jsx)(z.Z,{checked:n,onClick:a})}),(0,G.jsx)(M.Z,{sx:{cursor:"pointer",color:"#3F54EB"},onClick:l,lang:"ar",align:"center",children:v}),(0,G.jsx)(M.Z,{sx:{cursor:"pointer",color:"#3F54EB"},onClick:l,lang:"ar",align:"center",children:j}),(0,G.jsx)(M.Z,{sx:{cursor:"pointer",color:"#3F54EB"},onClick:l,lang:"ar",align:"center",children:I?f:w}),(0,G.jsx)(M.Z,{lang:"ar",align:"center",children:(0,G.jsx)(P.Z,{lang:"ar",variant:"soft",color:("active"===b?"success":"inactive"===b&&"error")||"default",children:W(b)})}),(0,G.jsx)(M.Z,{lang:"ar",align:"right",sx:{px:1,whiteSpace:"nowrap"},children:(0,G.jsx)(d.Z,{color:H.open?"inherit":"default",onClick:H.onOpen,children:(0,G.jsx)(R.Z,{icon:"eva:more-vertical-fill"})})})]});return(0,G.jsxs)(G.Fragment,{children:[B,(0,G.jsxs)(U.Z,{open:H.open,onClose:H.onClose,arrow:"right-top",sx:{width:140},children:["active"===b?(0,o.Z)({category:"unit_service",subcategory:"departments",acl:"delete"})&&(0,G.jsxs)(O.Z,{onClick:()=>{i()},sx:{color:"error.main"},children:[(0,G.jsx)(R.Z,{icon:"ic:baseline-pause"}),W("inactivate")]}):(0,o.Z)({category:"unit_service",subcategory:"departments",acl:"update"})&&(0,G.jsxs)(O.Z,{onClick:()=>{r()},sx:{color:"success.main"},children:[(0,G.jsx)(R.Z,{icon:"bi:play-fill"}),W("activate")]}),(0,o.Z)({category:"unit_service",subcategory:"departments",acl:"update"})&&(0,G.jsxs)(O.Z,{onClick:()=>{s(),H.onClose()},children:[(0,G.jsx)(R.Z,{icon:"fluent:edit-32-filled"}),W("edit")]}),(0,G.jsxs)(O.Z,{onClick:T.onOpen,children:[(0,G.jsx)(R.Z,{icon:"carbon:data-quality-definition"}),W("DDL")]})]}),(0,G.jsxs)(U.Z,{open:T.open,onClose:T.onClose,arrow:"right-top",sx:{padding:2,fontSize:"14px"},children:[(0,G.jsxs)(E.Z,{sx:{fontWeight:600},children:[W("creation time"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,Q.zM)(C)}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("creator"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===_||void 0===_?void 0:_.email}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("creator IP"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:y}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("editing time"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:(0,Q.zM)(k)}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("editor"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray"},children:null===S||void 0===S?void 0:S.email}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("editor IP"),":"]}),(0,G.jsx)(E.Z,{sx:{pb:1,borderBottom:"1px solid gray",fontWeight:"400"},children:D}),(0,G.jsxs)(E.Z,{sx:{pt:1,fontWeight:600},children:[W("modifications no"),": ",F]})]})]})}var N=n(36314),$=n(48550),J=n(63466);function V(e){let{filters:t,onFilters:n,onPrint:s,onDownload:o,canReset:r,onResetFilters:i}=e;const l=(0,U.S)(),{t:c}=(0,Z.qM)(),h=(0,a.useCallback)((e=>{n("name",e.target.value)}),[n]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(N.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,G.jsxs)(N.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[(0,G.jsx)($.Z,{fullWidth:!0,value:t.name,onChange:h,placeholder:c("Search name or number..."),InputProps:{startAdornment:(0,G.jsx)(J.Z,{position:"start",children:(0,G.jsx)(R.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),(0,G.jsx)(d.Z,{onClick:l.onOpen,children:(0,G.jsx)(R.Z,{icon:"eva:more-vertical-fill"})})]}),r&&(0,G.jsx)(p.Z,{color:"error",sx:{flexShrink:0},onClick:i,startIcon:(0,G.jsx)(R.Z,{icon:"solar:trash-bin-trash-bold"}),children:c("clear")})]}),(0,G.jsxs)(U.Z,{open:l.open,onClose:l.onClose,arrow:"right-top",sx:{width:140},children:[(0,G.jsxs)(O.Z,{onClick:()=>{s(),l.onClose()},children:[(0,G.jsx)(R.Z,{icon:"solar:printer-minimalistic-bold"}),c("print")]}),(0,G.jsxs)(O.Z,{onClick:()=>{o(),l.onClose()},children:[(0,G.jsx)(R.Z,{icon:"solar:import-bold"}),"Import"]})]})]})}var X=n(85771),Y=n(27938),ee=n(2540);function te(e){let{filters:t,onFilters:n,onResetFilters:s,results:o,...a}=e;const{t:r}=(0,Z.qM)(),i=(0,ee.l2)(t.startDate,t.endDate);return(0,G.jsxs)(N.Z,{spacing:1.5,...a,children:[(0,G.jsxs)(E.Z,{sx:{typography:"body2"},children:[(0,G.jsx)("strong",{children:o}),(0,G.jsx)(E.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:r("results found")})]}),(0,G.jsxs)(N.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:["all"!==t.status&&(0,G.jsx)(ne,{label:r("status:"),children:(0,G.jsx)(X.Z,{size:"small",label:r(t.status),onDelete:()=>{n("status","all")}})}),t.startDate&&t.endDate&&(0,G.jsx)(ne,{label:r("date:"),children:(0,G.jsx)(X.Z,{size:"small",label:i,onDelete:()=>{n("startDate",null),n("endDate",null)}})}),(0,G.jsx)(p.Z,{color:"error",onClick:s,startIcon:(0,G.jsx)(R.Z,{icon:"solar:trash-bin-trash-bold"}),children:r("clear")})]})]})}function ne(e){let{label:t,children:n,sx:s,...o}=e;return(0,G.jsxs)(N.Z,{component:Y.Z,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...s},...o,children:[(0,G.jsx)(E.Z,{component:"span",sx:{typography:"subtitle2"},children:t}),(0,G.jsx)(N.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:n})]})}const se={name:"",status:"all"};function oe(){var e,t;const{t:n}=(0,Z.qM)(),{currentLang:s}=(0,Z.nt)(),E=[{id:"code",label:n("code")},{id:"sequence",label:n("sequence")},{id:"name_english",label:n("name")},{id:"status",label:n("status")},{id:"",width:88}],{STATUS_OPTIONS:O}=(0,B.D)(),L=(0,A.x6)({defaultOrderBy:"code"}),{user:z}=(0,f.E)(),M=(0,a.useRef)(),Q=(0,F.K$)(),U=(0,b.k)(),N=(0,b.k)(),$=(0,w.tv)(),{departmentsData:J,loading:X,refetch:Y}=(0,T.T8)(null===z||void 0===z||null===(e=z.employee)||void 0===e||null===(t=e.employee_engagements[null===z||void 0===z?void 0:z.employee.selected_engagement])||void 0===t?void 0:t.unit_service._id),[ee,ne]=(0,a.useState)(se),oe=!(!ee.startDate||!ee.endDate)&&ee.startDate.getTime()>ee.endDate.getTime(),ae=function(e){var t;let{inputData:n,comparator:s,filters:o,dateError:a}=e;const{status:r,name:i}=o,l=null===(t=n)||void 0===t?void 0:t.map(((e,t)=>[e,t]));l.sort(((e,t)=>{const n=s(e[0],t[0]);return 0!==n?n:e[1]-t[1]})),n=l.map((e=>e[0])),i&&(n=n.filter((e=>{var t,n;return(null===e||void 0===e?void 0:e.name_arabic)&&-1!==(null===e||void 0===e||null===(t=e.name_arabic)||void 0===t?void 0:t.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e?void 0:e.name_english)&&-1!==(null===e||void 0===e||null===(n=e.name_english)||void 0===n?void 0:n.toLowerCase().indexOf(i.toLowerCase()))||(null===e||void 0===e?void 0:e._id)===i||JSON.stringify(e.code)===i})));"all"!==r&&(n=n.filter((e=>e.status===r)));return n}({inputData:J,comparator:(0,A.sQ)(L.order,L.orderBy),filters:ee,dateError:oe}),re=ae.slice(L.page*L.rowsPerPage,L.page*L.rowsPerPage+L.rowsPerPage),ie=L.dense?52:72,le=!(null===ee||void 0===ee||!ee.name)||"all"!==ee.status,ce=!ae.length&&le||!ae.length,de=(0,C.useReactToPrint)({content:()=>M.current}),he=(0,a.useCallback)((async e=>{try{await(0,H.Z)({method:"PATCH",path:"".concat(I.Hv.tables.department(e._id),"/updatestatus"),data:{status:"active"}}),k.W.emit("updated",{user:z,link:j.H.unitservice.departments.info(e._id),msg:"activating department <strong>".concat(e.name_english,"</strong>")})}catch(t){k.W.emit("error",{error:t,user:z,location:window.location.href}),console.error(t)}Y(),L.onUpdatePageDeleteRow(re.length)}),[re.length,L,Y,z]),ue=(0,a.useCallback)((async e=>{try{await(0,H.Z)({method:"PATCH",path:"".concat(I.Hv.tables.department(e._id),"/updatestatus"),data:{status:"inactive"}}),k.W.emit("updated",{user:z,link:j.H.unitservice.departments.info(e._id),msg:"inactivating department <strong>".concat(e.name_english,"</strong>")})}catch(t){k.W.emit("error",{error:t,user:z,location:window.location.href}),console.error(t)}Y(),L.onUpdatePageDeleteRow(re.length)}),[re.length,L,Y,z]),pe=(0,a.useCallback)((async()=>{try{await(0,H.Z)({method:"PATCH",path:"".concat(I.Hv.tables.departments,"/updatestatus"),data:{status:"active",ids:L.selected}}),k.W.emit("updated",{user:z,link:j.H.unitservice.departments.root,msg:"activating many departments"})}catch(e){k.W.emit("error",{error:e,user:z,location:window.location.href}),console.error(e)}Y(),L.onUpdatePageDeleteRows({totalRows:J.length,totalRowsInPage:re.length,totalRowsFiltered:ae.length})}),[ae.length,re.length,L,J,Y,z]),xe=(0,a.useCallback)((async()=>{try{await(0,H.Z)({method:"PATCH",path:"".concat(I.Hv.tables.departments,"/updatestatus"),data:{status:"inactive",ids:L.selected}}),k.W.emit("updated",{user:z,link:j.H.unitservice.departments.root,msg:"inactivating many departments"})}catch(e){k.W.emit("error",{error:e,user:z,location:window.location.href}),console.error(e)}Y(),L.onUpdatePageDeleteRows({totalRows:J.length,totalRowsInPage:re.length,totalRowsFiltered:ae.length})}),[ae.length,re.length,L,J,Y,z]),ge=(0,a.useCallback)(((e,t)=>{L.onResetPage(),ne((n=>({...n,[e]:t})))}),[L]),me=(0,a.useCallback)((e=>{$.push(j.H.unitservice.departments.edit(e))}),[$]),ve=(0,a.useCallback)((e=>{$.push(j.H.unitservice.departments.info(e))}),[$]),je=(0,a.useCallback)((()=>{ne(se)}),[]),we=(0,a.useCallback)(((e,t)=>{ge("status",t)}),[ge]);return X?(0,G.jsx)(q.a,{}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(x.Z,{maxWidth:!Q.themeStretch&&"lg",children:[(0,G.jsx)(W.Z,{heading:n("departments"),links:[{name:n("dashboard"),href:j.H.unitservice.root},{name:n("departments")}],action:(0,o.Z)({category:"unit_service",subcategory:"departments",acl:"create"})&&(0,G.jsx)(p.Z,{component:v.r,href:j.H.unitservice.departments.new,variant:"contained",startIcon:(0,G.jsx)(R.Z,{icon:"mingcute:add-line"}),children:n("new department")}),sx:{mb:{xs:3,md:5}}}),(0,G.jsxs)(h.Z,{children:[(0,G.jsx)(i.Z,{value:ee.status,onChange:we,sx:{px:2.5,boxShadow:e=>"inset 0 -2px 0 0 ".concat((0,c.Fq)(e.palette.grey[500],.08))},children:O.map((e=>(0,G.jsx)(r.Z,{iconPosition:"end",value:e.value,label:e.label,icon:(0,G.jsxs)(P.Z,{lang:"ar",variant:"all"===e.value||e.value===ee.status?"filled":"soft",color:("active"===e.value?"success":"inactive"===e.value&&"error")||"default",children:["all"===e.value&&J.length,"active"===e.value&&J.filter((e=>"active"===e.status)).length,"inactive"===e.value&&J.filter((e=>"inactive"===e.status)).length]})},e.value)))}),(0,G.jsx)(V,{onPrint:de,filters:ee,onFilters:ge,onDownload:()=>{const e=ae.reduce(((e,t)=>{var n,s;return e.push({code:t.code,name:t.name_english,category:null===(n=t.category)||void 0===n?void 0:n.name_english,symptoms:null===(s=t.symptoms)||void 0===s?void 0:s.map((e=>null===e||void 0===e?void 0:e.name_english))}),e}),[]),t=_.P6.book_new(),n=_.P6.json_to_sheet(e);_.P6.book_append_sheet(t,n,"Sheet 1");const s=_.cW(t,{bookType:"xlsx",type:"array"}),o=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,y.saveAs)(o,"unitservicesTable.xlsx")},canReset:le,onResetFilters:je}),le&&(0,G.jsx)(te,{filters:ee,onFilters:ge,onResetFilters:je,results:ae.length,sx:{p:2.5,pt:0}}),(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(A.Z4,{dense:L.dense,numSelected:L.selected.length,rowCount:ae.length,onSelectAllRows:e=>L.onSelectAllRows(e,ae.map((e=>e._id))),action:(0,G.jsx)(G.Fragment,{children:ae.filter((e=>L.selected.includes(e._id))).some((e=>"inactive"===e.status))?(0,G.jsx)(l.Z,{title:"Activate all",children:(0,G.jsx)(d.Z,{color:"primary",onClick:U.onTrue,children:(0,G.jsx)(R.Z,{icon:"codicon:run-all"})})}):(0,G.jsx)(l.Z,{title:"Inactivate all",children:(0,G.jsx)(d.Z,{color:"error",onClick:N.onTrue,children:(0,G.jsx)(R.Z,{icon:"iconoir:pause-solid"})})})}),color:ae.filter((e=>L.selected.includes(e._id))).some((e=>"inactive"===e.status))?"primary":"error"}),(0,G.jsx)(S.Z,{children:(0,G.jsxs)(u.Z,{ref:M,size:L.dense?"small":"medium",children:[(0,G.jsx)(A.K,{order:L.order,orderBy:L.orderBy,headLabel:E,rowCount:ae.length,numSelected:L.selected.length,onSort:L.onSort,onSelectAllRows:e=>L.onSelectAllRows(e,ae.map((e=>e._id)))}),(0,G.jsxs)(g.Z,{children:[ae.slice(L.page*L.rowsPerPage,L.page*L.rowsPerPage+L.rowsPerPage).map((e=>(0,G.jsx)(K,{row:e,filters:ee,setFilters:ne,selected:L.selected.includes(e._id),onSelectRow:()=>L.onSelectRow(e._id),onActivate:()=>he(e),onShow:()=>ve(e._id),onInactivate:()=>ue(e),onEditRow:()=>me(e._id)},e._id))),(0,G.jsx)(A.$W,{height:ie,emptyRows:(0,A.fQ)(L.page,L.rowsPerPage,J.length)}),(0,G.jsx)(A.et,{notFound:ce})]})]})})]}),(0,G.jsx)(A.S_,{count:ae.length,page:L.page,rowsPerPage:L.rowsPerPage,onPageChange:L.onChangePage,onRowsPerPageChange:L.onChangeRowsPerPage,dense:L.dense,onChangeDense:L.onChangeDense})]})]}),(0,G.jsx)(D.Q,{open:N.value,onClose:N.onFalse,title:"Inactivate",content:(0,G.jsxs)(G.Fragment,{children:["Are you sure want to Inactivate ",(0,G.jsxs)("strong",{children:[" ",L.selected.length," "]})," items?"]}),action:(0,G.jsx)(p.Z,{variant:"contained",color:"error",onClick:()=>{xe(),N.onFalse()},children:"Inactivate"})}),(0,G.jsx)(D.Q,{open:U.value,onClose:U.onFalse,title:"Activate",content:(0,G.jsxs)(G.Fragment,{children:["Are you sure want to Activate ",(0,G.jsxs)("strong",{children:[" ",L.selected.length," "]})," items?"]}),action:(0,G.jsx)(p.Z,{variant:"contained",color:"primary",onClick:()=>{pe(),U.onFalse()},children:"Activate"})})]})}function ae(){return(0,G.jsx)(G.Fragment,{children:(0,G.jsxs)(o.Z,{hasContent:!0,category:"unit_service",subcategory:"departments",acl:"read",children:[(0,G.jsx)(s.ql,{children:(0,G.jsx)("title",{children:" Departments "})}),(0,G.jsx)(oe,{})]})})}}}]);
//# sourceMappingURL=9545.1598c60d.chunk.js.map
"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2277],{85010:(e,a,t)=>{t.r(a),t.d(a,{default:()=>_});var n=t(6907),r=t(19208),i=t(27031),o=t(66833),s=t(35456),l=t(89164),d=t(76932),m=t(25279),u=t(17579),c=t(80184);function p(e){let{WorkGroupData:a,departmentData:t}=e;const n=(0,m.K$)(),{t:r}=(0,d.qM)(),{currentLang:i}=(0,d.nt)();i.value;return(0,c.jsx)(l.Z,{maxWidth:!n.themeStretch&&"lg",children:a&&t&&(0,c.jsx)(u.Z,{departmentData:t,currentTable:a})})}function _(){const e=(0,r.UO)(),{id:a,acid:t}=e,l=(0,o.YL)(a).data,{data:d,loading:m}=(0,o.tB)(t),u=null===d||void 0===d?void 0:d.name_english;return(0,c.jsxs)(i.Z,{hasContent:!0,category:"department",subcategory:"work_groups",acl:"update",children:[(0,c.jsx)(n.ql,{children:(0,c.jsxs)("title",{children:[" Edit ",u||""," Work Group "]})}),m&&(0,c.jsx)(s.a,{}),!m&&(0,c.jsx)(p,{WorkGroupData:d,departmentData:l})]})}},17579:(e,a,t)=>{t.d(a,{Z:()=>C});var n=t(55294),r=t(8007),i=t(763),o=t(72791),s=t(61134),l=t(44695),d=t(68870),m=t(57621),u=t(85771),c=t(36314),p=t(24308),_=t(12258),g=t(38072),h=t(19208),v=t(89731),y=t(6385),b=t(99116),x=t(8976),f=t(66833),k=t(76932),Z=t(32869),j=t(26405),w=t(80184);function C(e){let{departmentData:a,currentTable:t}=e;const C=(0,h.tv)(),{t:q}=(0,k.qM)(),{currentLang:D}=(0,k.nt)(),{user:S}=(D.value,(0,x.E)()),{employeesData:G}=(0,f.nv)(a._id),[E,T]=(0,o.useState)([]),{enqueueSnackbar:V}=(0,Z.Ds)(),H=r.Ry().shape({name_arabic:r.Z_().required("Name is required"),name_english:r.Z_().required("Name is required"),employees:r.IX().min(1,"Choose at least one option")}),I=(0,o.useMemo)((()=>{var e,n;return{unit_service:(null===S||void 0===S||null===(e=S.employee)||void 0===e||null===(n=e.employee_engagements[null===S||void 0===S?void 0:S.employee.selected_engagement])||void 0===n?void 0:n.unit_service._id)||a.unit_service._id,department:a._id,name_arabic:(null===t||void 0===t?void 0:t.name_arabic)||"",name_english:(null===t||void 0===t?void 0:t.name_english)||"",employees:(null===t||void 0===t?void 0:t.employees)||[]}}),[t,a,null===S||void 0===S?void 0:S.employee]),O=(0,s.cI)({mode:"onTouched",resolver:(0,l.X)(H),defaultValues:I}),{reset:P,handleSubmit:W,formState:{isSubmitting:$}}=O,L=W((async e=>{try{const r=await n.Z.get("https://geolocation-db.com/json/");t?(await(0,y.Z)({method:"PATCH",path:v.Hv.tables.workgroup(t._id),data:{modifications_nums:(t.modifications_nums||0)+1,ip_address_user_modification:r.data.IPv4,user_modification:S._id,...e}}),b.Z.emit("updated",{data:e,user:S,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"updated work group <strong>".concat(e.name_english,"</strong> in <strong>").concat(a.name_english,"</strong> department")})):(await(0,y.Z)({method:"POST",path:v.Hv.tables.workgroups,data:{ip_address_user_creation:r.data.IPv4,user_creation:S._id,...e}}),b.Z.emit("created",{data:e,user:S,link:g.H.unitservice.departments.workGroups.root(a._id),msg:"created work group <strong>".concat(e.name_english,"</strong> in <strong>").concat(a.name_english,"</strong> department")})),P(),V(q(t?"update success!":"create success!")),C.push(g.H.unitservice.departments.workGroups.root(a._id))}catch(r){b.Z.emit("error",{error:r,user:S,location:window.location.pathname}),V("string"===typeof r?r:r.message,{variant:"error"}),console.error(r)}}));return(0,w.jsx)(j.ZP,{methods:O,onSubmit:L,children:(0,w.jsx)(p.Z,{xs:12,maxWidth:"md",children:(0,w.jsxs)(m.Z,{sx:{p:3},children:[(0,w.jsxs)(d.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)"},children:[(0,w.jsx)(j.au,{lang:"ar",onChange:e=>{/^[a-zA-Z0-9\s,@#$!*_\-&^%]*$/.test(e.target.value)&&O.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_english",label:"".concat(q("name english")," *")}),(0,w.jsx)(j.au,{lang:"ar",onChange:e=>{/^[\u0600-\u06FF0-9\s!@#$%^&*_-]*$/.test(e.target.value)&&O.setValue(e.target.name,e.target.value,{shouldValidate:!0})},name:"name_arabic",label:"".concat(q("name arabic")," *")}),(0,w.jsx)(j.Fl,{name:"employees",label:"".concat(q("employees")," *"),multiple:!0,disableCloseOnSelect:!0,options:G.filter((e=>!E.some((a=>(0,i.isEqual)(e,a))))),getOptionLabel:e=>e._id,renderOption:(e,a)=>(0,o.createElement)("li",{...e,key:a._id,value:a._id},a.employee.first_name," ",a.employee.middle_name," ",a.employee.family_name),onChange:(e,a)=>{T(a),O.setValue("employees",a,{shouldValidate:!0})},renderTags:(e,a)=>e.map(((e,t)=>(0,o.createElement)(u.Z,{...a({index:t}),key:e._id,label:e.employee.first_name,size:"small",color:"info",variant:"soft"})))})]}),(0,w.jsx)(c.Z,{alignItems:"flex-end",sx:{mt:3},children:(0,w.jsx)(_.Z,{type:"submit",tabIndex:-1,variant:"contained",loading:$,children:q(t?"save changes":"create")})})]})})})}},6385:(e,a,t)=>{t.d(a,{Z:()=>o});var n=t(55294),r=t(88329),i=t(33805);async function o(e){let{setData:a,setError:t,method:o,path:s,data:l}=e;const d="".concat(i.E0).concat(s),m=r.Z.get("user_token"),u=await(0,n.Z)({method:o,url:d,headers:{authorization:"Bearer ".concat(m)},data:l});return a&&a(u.data),t&&t(u.data),u}}}]);
//# sourceMappingURL=2277.eebd4c9e.chunk.js.map